Command line
python /home/felixjwong/miniconda3/envs/chemprop/bin/chemprop_train --data_path final_tox_hepg2/hepg2_tox_full.csv --dataset_type classification --config_path final_tox_hepg2/opt.json --save_dir final_tox_hepg2/train/checkpoints18 --ensemble_size 1 --features_generator rdkit_2d_normalized --no_features_scaling --seed 18
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'final_tox_hepg2/opt.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'final_tox_hepg2/hepg2_tox_full.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'ensemble_size': 1,
 'epochs': 30,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'final_tox_hepg2/train/checkpoints18',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 18,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['\ufeffSMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['TOXICITY'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 18
Class sizes
TOXICITY 0: 91.50%, 1: 8.50%
Total size = 39,312 | train size = 31,449 | val size = 3,931 | test size = 3,932
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35, inplace=False)
    (4): Linear(in_features=1600, out_features=1600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35, inplace=False)
    (7): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 11,014,401
Epoch 0
Loss = 3.3248e-01, PNorm = 82.6354, GNorm = 0.7128, lr_0 = 1.0788e-04
Loss = 2.9696e-01, PNorm = 82.6420, GNorm = 0.7983, lr_0 = 1.1505e-04
Loss = 3.2645e-01, PNorm = 82.6493, GNorm = 1.1133, lr_0 = 1.2221e-04
Loss = 2.6760e-01, PNorm = 82.6558, GNorm = 0.7138, lr_0 = 1.2938e-04
Loss = 3.3119e-01, PNorm = 82.6622, GNorm = 1.3297, lr_0 = 1.3654e-04
Loss = 2.9562e-01, PNorm = 82.6698, GNorm = 0.9138, lr_0 = 1.4371e-04
Loss = 2.6619e-01, PNorm = 82.6785, GNorm = 0.7658, lr_0 = 1.5088e-04
Loss = 2.4180e-01, PNorm = 82.6865, GNorm = 1.1342, lr_0 = 1.5804e-04
Loss = 2.3766e-01, PNorm = 82.6953, GNorm = 0.7021, lr_0 = 1.6521e-04
Loss = 3.5839e-01, PNorm = 82.7023, GNorm = 1.0684, lr_0 = 1.7237e-04
Loss = 2.8777e-01, PNorm = 82.7142, GNorm = 1.2057, lr_0 = 1.7954e-04
Loss = 2.9738e-01, PNorm = 82.7241, GNorm = 1.1423, lr_0 = 1.8670e-04
Loss = 3.1668e-01, PNorm = 82.7334, GNorm = 1.0592, lr_0 = 1.9387e-04
Loss = 2.4078e-01, PNorm = 82.7450, GNorm = 0.9154, lr_0 = 2.0104e-04
Loss = 2.5597e-01, PNorm = 82.7530, GNorm = 0.6861, lr_0 = 2.0820e-04
Loss = 3.1217e-01, PNorm = 82.7610, GNorm = 1.2182, lr_0 = 2.1537e-04
Loss = 3.4993e-01, PNorm = 82.7719, GNorm = 0.7014, lr_0 = 2.2253e-04
Loss = 3.0846e-01, PNorm = 82.7809, GNorm = 0.6846, lr_0 = 2.2970e-04
Loss = 3.2346e-01, PNorm = 82.7932, GNorm = 1.2121, lr_0 = 2.3686e-04
Loss = 2.6531e-01, PNorm = 82.8023, GNorm = 0.5546, lr_0 = 2.4403e-04
Loss = 2.6390e-01, PNorm = 82.8148, GNorm = 0.6260, lr_0 = 2.5119e-04
Loss = 2.8423e-01, PNorm = 82.8259, GNorm = 0.6810, lr_0 = 2.5836e-04
Loss = 2.7010e-01, PNorm = 82.8376, GNorm = 1.2826, lr_0 = 2.6553e-04
Loss = 2.3210e-01, PNorm = 82.8507, GNorm = 0.7611, lr_0 = 2.7269e-04
Loss = 2.8535e-01, PNorm = 82.8617, GNorm = 0.7593, lr_0 = 2.7986e-04
Loss = 2.6430e-01, PNorm = 82.8753, GNorm = 0.7122, lr_0 = 2.8702e-04
Loss = 2.5239e-01, PNorm = 82.8902, GNorm = 0.5378, lr_0 = 2.9419e-04
Loss = 2.5534e-01, PNorm = 82.9044, GNorm = 0.6791, lr_0 = 3.0135e-04
Loss = 2.6111e-01, PNorm = 82.9217, GNorm = 0.9022, lr_0 = 3.0852e-04
Loss = 2.4025e-01, PNorm = 82.9339, GNorm = 0.6647, lr_0 = 3.1568e-04
Loss = 2.5565e-01, PNorm = 82.9507, GNorm = 0.8334, lr_0 = 3.2285e-04
Loss = 3.0036e-01, PNorm = 82.9695, GNorm = 0.9613, lr_0 = 3.3002e-04
Loss = 2.5863e-01, PNorm = 82.9853, GNorm = 0.8158, lr_0 = 3.3718e-04
Loss = 2.5937e-01, PNorm = 83.0006, GNorm = 0.6371, lr_0 = 3.4435e-04
Loss = 2.8393e-01, PNorm = 83.0184, GNorm = 0.7052, lr_0 = 3.5151e-04
Loss = 2.9010e-01, PNorm = 83.0300, GNorm = 0.6737, lr_0 = 3.5868e-04
Loss = 2.7420e-01, PNorm = 83.0464, GNorm = 0.7064, lr_0 = 3.6584e-04
Loss = 2.4809e-01, PNorm = 83.0636, GNorm = 0.4901, lr_0 = 3.7301e-04
Loss = 2.5287e-01, PNorm = 83.0763, GNorm = 0.8462, lr_0 = 3.8018e-04
Loss = 2.6446e-01, PNorm = 83.0931, GNorm = 1.0945, lr_0 = 3.8734e-04
Loss = 2.3811e-01, PNorm = 83.1084, GNorm = 0.7268, lr_0 = 3.9451e-04
Loss = 2.9591e-01, PNorm = 83.1246, GNorm = 0.5366, lr_0 = 4.0167e-04
Loss = 2.8605e-01, PNorm = 83.1487, GNorm = 0.5078, lr_0 = 4.0884e-04
Loss = 2.8710e-01, PNorm = 83.1731, GNorm = 0.7799, lr_0 = 4.1600e-04
Loss = 2.3598e-01, PNorm = 83.2058, GNorm = 0.5688, lr_0 = 4.2317e-04
Loss = 2.9241e-01, PNorm = 83.2261, GNorm = 0.5642, lr_0 = 4.3033e-04
Loss = 2.4540e-01, PNorm = 83.2502, GNorm = 0.3619, lr_0 = 4.3750e-04
Loss = 2.7642e-01, PNorm = 83.2706, GNorm = 0.5465, lr_0 = 4.4467e-04
Loss = 2.6004e-01, PNorm = 83.3023, GNorm = 0.9149, lr_0 = 4.5183e-04
Loss = 2.6348e-01, PNorm = 83.3310, GNorm = 0.5316, lr_0 = 4.5900e-04
Loss = 3.1467e-01, PNorm = 83.3501, GNorm = 0.5230, lr_0 = 4.6616e-04
Loss = 3.4488e-01, PNorm = 83.3767, GNorm = 0.6509, lr_0 = 4.7333e-04
Loss = 2.1576e-01, PNorm = 83.3986, GNorm = 0.8578, lr_0 = 4.8049e-04
Loss = 3.2125e-01, PNorm = 83.4191, GNorm = 0.4980, lr_0 = 4.8766e-04
Loss = 2.4721e-01, PNorm = 83.4452, GNorm = 0.5999, lr_0 = 4.9482e-04
Loss = 3.0696e-01, PNorm = 83.4620, GNorm = 0.7310, lr_0 = 5.0199e-04
Loss = 2.9006e-01, PNorm = 83.4834, GNorm = 0.3940, lr_0 = 5.0916e-04
Loss = 2.6777e-01, PNorm = 83.5008, GNorm = 0.5071, lr_0 = 5.1632e-04
Loss = 2.2413e-01, PNorm = 83.5264, GNorm = 0.3616, lr_0 = 5.2349e-04
Loss = 2.3882e-01, PNorm = 83.5420, GNorm = 0.5966, lr_0 = 5.3065e-04
Loss = 2.6385e-01, PNorm = 83.5748, GNorm = 0.4151, lr_0 = 5.3782e-04
Loss = 2.2298e-01, PNorm = 83.6025, GNorm = 0.4164, lr_0 = 5.4498e-04
Validation auc = 0.776428
Epoch 1
Loss = 2.8121e-01, PNorm = 83.6352, GNorm = 0.4665, lr_0 = 5.5287e-04
Loss = 2.0468e-01, PNorm = 83.6846, GNorm = 0.4072, lr_0 = 5.6003e-04
Loss = 2.4521e-01, PNorm = 83.7248, GNorm = 0.5204, lr_0 = 5.6720e-04
Loss = 2.7875e-01, PNorm = 83.7696, GNorm = 0.9882, lr_0 = 5.7436e-04
Loss = 2.5549e-01, PNorm = 83.8206, GNorm = 0.4040, lr_0 = 5.8153e-04
Loss = 2.6353e-01, PNorm = 83.8602, GNorm = 0.4679, lr_0 = 5.8869e-04
Loss = 2.3414e-01, PNorm = 83.8889, GNorm = 0.6365, lr_0 = 5.9586e-04
Loss = 2.7755e-01, PNorm = 83.9167, GNorm = 0.4832, lr_0 = 6.0303e-04
Loss = 2.4692e-01, PNorm = 83.9491, GNorm = 0.4638, lr_0 = 6.1019e-04
Loss = 2.9298e-01, PNorm = 83.9830, GNorm = 0.4359, lr_0 = 6.1736e-04
Loss = 2.9579e-01, PNorm = 84.0381, GNorm = 0.8667, lr_0 = 6.2452e-04
Loss = 2.2302e-01, PNorm = 84.0843, GNorm = 0.6749, lr_0 = 6.3169e-04
Loss = 2.7014e-01, PNorm = 84.1356, GNorm = 0.4946, lr_0 = 6.3885e-04
Loss = 2.4924e-01, PNorm = 84.1978, GNorm = 0.8913, lr_0 = 6.4602e-04
Loss = 2.4568e-01, PNorm = 84.2589, GNorm = 0.4997, lr_0 = 6.5318e-04
Loss = 2.4769e-01, PNorm = 84.3177, GNorm = 0.5757, lr_0 = 6.6035e-04
Loss = 2.5201e-01, PNorm = 84.3938, GNorm = 0.8307, lr_0 = 6.6752e-04
Loss = 2.9244e-01, PNorm = 84.4710, GNorm = 0.7481, lr_0 = 6.7468e-04
Loss = 2.6122e-01, PNorm = 84.5586, GNorm = 0.7364, lr_0 = 6.8185e-04
Loss = 2.5841e-01, PNorm = 84.6450, GNorm = 0.4117, lr_0 = 6.8901e-04
Loss = 2.1801e-01, PNorm = 84.7303, GNorm = 0.3725, lr_0 = 6.9618e-04
Loss = 2.8429e-01, PNorm = 84.8204, GNorm = 0.4215, lr_0 = 7.0334e-04
Loss = 2.7562e-01, PNorm = 84.9115, GNorm = 0.4244, lr_0 = 7.1051e-04
Loss = 3.2572e-01, PNorm = 84.9923, GNorm = 0.9813, lr_0 = 7.1768e-04
Loss = 2.8377e-01, PNorm = 85.0814, GNorm = 0.4627, lr_0 = 7.2484e-04
Loss = 2.2811e-01, PNorm = 85.1670, GNorm = 0.3231, lr_0 = 7.3201e-04
Loss = 2.7988e-01, PNorm = 85.2401, GNorm = 0.5906, lr_0 = 7.3917e-04
Loss = 2.8360e-01, PNorm = 85.3398, GNorm = 0.4957, lr_0 = 7.4634e-04
Loss = 2.4177e-01, PNorm = 85.4259, GNorm = 0.7703, lr_0 = 7.5350e-04
Loss = 2.4257e-01, PNorm = 85.5228, GNorm = 0.3622, lr_0 = 7.6067e-04
Loss = 2.5607e-01, PNorm = 85.6419, GNorm = 1.4835, lr_0 = 7.6783e-04
Loss = 1.9271e-01, PNorm = 85.7655, GNorm = 0.4030, lr_0 = 7.7500e-04
Loss = 2.3519e-01, PNorm = 85.8625, GNorm = 0.4608, lr_0 = 7.8217e-04
Loss = 2.7268e-01, PNorm = 85.9667, GNorm = 0.4372, lr_0 = 7.8933e-04
Loss = 2.8112e-01, PNorm = 86.0499, GNorm = 0.5646, lr_0 = 7.9650e-04
Loss = 3.1121e-01, PNorm = 86.1444, GNorm = 1.2504, lr_0 = 8.0366e-04
Loss = 2.8378e-01, PNorm = 86.2585, GNorm = 1.3636, lr_0 = 8.1083e-04
Loss = 2.5837e-01, PNorm = 86.3509, GNorm = 0.6401, lr_0 = 8.1799e-04
Loss = 2.8738e-01, PNorm = 86.4477, GNorm = 0.5410, lr_0 = 8.2516e-04
Loss = 2.7103e-01, PNorm = 86.5382, GNorm = 0.4645, lr_0 = 8.3232e-04
Loss = 2.6469e-01, PNorm = 86.6092, GNorm = 0.4664, lr_0 = 8.3949e-04
Loss = 2.4920e-01, PNorm = 86.7079, GNorm = 0.5795, lr_0 = 8.4666e-04
Loss = 2.8251e-01, PNorm = 86.7818, GNorm = 0.4074, lr_0 = 8.5382e-04
Loss = 2.6856e-01, PNorm = 86.8752, GNorm = 0.4927, lr_0 = 8.6099e-04
Loss = 2.1258e-01, PNorm = 86.9368, GNorm = 0.4028, lr_0 = 8.6815e-04
Loss = 3.1499e-01, PNorm = 87.0122, GNorm = 0.6188, lr_0 = 8.7532e-04
Loss = 2.7385e-01, PNorm = 87.0860, GNorm = 0.7050, lr_0 = 8.8248e-04
Loss = 2.7528e-01, PNorm = 87.1642, GNorm = 0.5869, lr_0 = 8.8965e-04
Loss = 2.6049e-01, PNorm = 87.2576, GNorm = 0.4577, lr_0 = 8.9682e-04
Loss = 2.8883e-01, PNorm = 87.3451, GNorm = 0.6550, lr_0 = 9.0398e-04
Loss = 3.0923e-01, PNorm = 87.4622, GNorm = 0.5584, lr_0 = 9.1115e-04
Loss = 3.0728e-01, PNorm = 87.6209, GNorm = 0.8323, lr_0 = 9.1831e-04
Loss = 2.6196e-01, PNorm = 87.7620, GNorm = 0.4452, lr_0 = 9.2548e-04
Loss = 2.8673e-01, PNorm = 87.8336, GNorm = 0.3798, lr_0 = 9.3264e-04
Loss = 2.7270e-01, PNorm = 87.9109, GNorm = 0.3921, lr_0 = 9.3981e-04
Loss = 2.5125e-01, PNorm = 87.9801, GNorm = 0.3467, lr_0 = 9.4697e-04
Loss = 2.3848e-01, PNorm = 88.0688, GNorm = 0.7438, lr_0 = 9.5414e-04
Loss = 2.6984e-01, PNorm = 88.1526, GNorm = 0.4042, lr_0 = 9.6131e-04
Loss = 2.5053e-01, PNorm = 88.2769, GNorm = 0.3919, lr_0 = 9.6847e-04
Loss = 2.6559e-01, PNorm = 88.4031, GNorm = 0.3989, lr_0 = 9.7564e-04
Loss = 2.5033e-01, PNorm = 88.5130, GNorm = 1.0345, lr_0 = 9.8280e-04
Loss = 2.3891e-01, PNorm = 88.6028, GNorm = 0.9726, lr_0 = 9.8997e-04
Loss = 2.8992e-01, PNorm = 88.6929, GNorm = 0.4556, lr_0 = 9.9713e-04
Validation auc = 0.786804
Epoch 2
Loss = 3.3360e-01, PNorm = 88.8000, GNorm = 2.5765, lr_0 = 9.9921e-04
Loss = 2.4823e-01, PNorm = 88.9475, GNorm = 1.2498, lr_0 = 9.9791e-04

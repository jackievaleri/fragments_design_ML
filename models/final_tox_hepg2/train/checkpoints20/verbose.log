Command line
python /home/felixjwong/miniconda3/envs/chemprop/bin/chemprop_train --data_path final_tox_hepg2/hepg2_tox_full.csv --dataset_type classification --config_path final_tox_hepg2/opt.json --save_dir final_tox_hepg2/train/checkpoints20 --ensemble_size 1 --features_generator rdkit_2d_normalized --no_features_scaling --seed 20
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'final_tox_hepg2/opt.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'final_tox_hepg2/hepg2_tox_full.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'ensemble_size': 1,
 'epochs': 30,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'final_tox_hepg2/train/checkpoints20',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 20,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['\ufeffSMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['TOXICITY'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 20
Class sizes
TOXICITY 0: 91.50%, 1: 8.50%
Total size = 39,312 | train size = 31,449 | val size = 3,931 | test size = 3,932
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35, inplace=False)
    (4): Linear(in_features=1600, out_features=1600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35, inplace=False)
    (7): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 11,014,401
Epoch 0
Loss = 4.0524e-01, PNorm = 82.6343, GNorm = 0.9160, lr_0 = 1.0788e-04
Loss = 2.8842e-01, PNorm = 82.6427, GNorm = 0.7660, lr_0 = 1.1505e-04
Loss = 3.2124e-01, PNorm = 82.6486, GNorm = 0.9659, lr_0 = 1.2221e-04
Loss = 3.0076e-01, PNorm = 82.6553, GNorm = 0.6636, lr_0 = 1.2938e-04
Loss = 2.8685e-01, PNorm = 82.6611, GNorm = 0.6557, lr_0 = 1.3654e-04
Loss = 2.9173e-01, PNorm = 82.6676, GNorm = 0.7154, lr_0 = 1.4371e-04
Loss = 3.1932e-01, PNorm = 82.6758, GNorm = 2.2746, lr_0 = 1.5088e-04
Loss = 2.8165e-01, PNorm = 82.6824, GNorm = 0.7798, lr_0 = 1.5804e-04
Loss = 3.0005e-01, PNorm = 82.6922, GNorm = 1.3868, lr_0 = 1.6521e-04
Loss = 2.7215e-01, PNorm = 82.6996, GNorm = 0.8025, lr_0 = 1.7237e-04
Loss = 2.7718e-01, PNorm = 82.7097, GNorm = 0.7126, lr_0 = 1.7954e-04
Loss = 2.4226e-01, PNorm = 82.7197, GNorm = 0.6561, lr_0 = 1.8670e-04
Loss = 3.0402e-01, PNorm = 82.7275, GNorm = 0.9090, lr_0 = 1.9387e-04
Loss = 2.5258e-01, PNorm = 82.7391, GNorm = 1.0265, lr_0 = 2.0104e-04
Loss = 2.9866e-01, PNorm = 82.7486, GNorm = 1.0296, lr_0 = 2.0820e-04
Loss = 2.6383e-01, PNorm = 82.7591, GNorm = 0.9537, lr_0 = 2.1537e-04
Loss = 2.8962e-01, PNorm = 82.7705, GNorm = 1.1833, lr_0 = 2.2253e-04
Loss = 2.4938e-01, PNorm = 82.7829, GNorm = 0.9266, lr_0 = 2.2970e-04
Loss = 2.7631e-01, PNorm = 82.7958, GNorm = 0.5827, lr_0 = 2.3686e-04
Loss = 2.6406e-01, PNorm = 82.8048, GNorm = 0.8560, lr_0 = 2.4403e-04
Loss = 3.0843e-01, PNorm = 82.8200, GNorm = 0.7352, lr_0 = 2.5119e-04
Loss = 2.8260e-01, PNorm = 82.8338, GNorm = 0.7584, lr_0 = 2.5836e-04
Loss = 2.3993e-01, PNorm = 82.8496, GNorm = 0.5796, lr_0 = 2.6553e-04
Loss = 2.3564e-01, PNorm = 82.8648, GNorm = 0.6222, lr_0 = 2.7269e-04
Loss = 3.4781e-01, PNorm = 82.8760, GNorm = 0.7508, lr_0 = 2.7986e-04
Loss = 2.9424e-01, PNorm = 82.8941, GNorm = 0.6929, lr_0 = 2.8702e-04
Loss = 2.5427e-01, PNorm = 82.9094, GNorm = 1.0208, lr_0 = 2.9419e-04
Loss = 2.2136e-01, PNorm = 82.9290, GNorm = 0.8247, lr_0 = 3.0135e-04
Loss = 2.4438e-01, PNorm = 82.9378, GNorm = 0.6651, lr_0 = 3.0852e-04
Loss = 3.4176e-01, PNorm = 82.9517, GNorm = 0.7525, lr_0 = 3.1568e-04
Loss = 2.5002e-01, PNorm = 82.9696, GNorm = 0.8090, lr_0 = 3.2285e-04
Loss = 2.3707e-01, PNorm = 82.9830, GNorm = 0.6575, lr_0 = 3.3002e-04
Loss = 2.4902e-01, PNorm = 83.0013, GNorm = 0.6413, lr_0 = 3.3718e-04
Loss = 2.7882e-01, PNorm = 83.0194, GNorm = 1.5258, lr_0 = 3.4435e-04
Loss = 2.5077e-01, PNorm = 83.0349, GNorm = 0.8566, lr_0 = 3.5151e-04
Loss = 2.5498e-01, PNorm = 83.0563, GNorm = 0.6586, lr_0 = 3.5868e-04
Loss = 2.4724e-01, PNorm = 83.0762, GNorm = 0.7597, lr_0 = 3.6584e-04
Loss = 2.4617e-01, PNorm = 83.0933, GNorm = 0.7039, lr_0 = 3.7301e-04
Loss = 3.5137e-01, PNorm = 83.1141, GNorm = 1.1325, lr_0 = 3.8018e-04
Loss = 2.5344e-01, PNorm = 83.1355, GNorm = 0.6189, lr_0 = 3.8734e-04
Loss = 3.0800e-01, PNorm = 83.1592, GNorm = 0.5176, lr_0 = 3.9451e-04
Loss = 2.2218e-01, PNorm = 83.1784, GNorm = 1.5173, lr_0 = 4.0167e-04
Loss = 2.7363e-01, PNorm = 83.2001, GNorm = 0.9603, lr_0 = 4.0884e-04
Loss = 2.4981e-01, PNorm = 83.2179, GNorm = 0.5026, lr_0 = 4.1600e-04
Loss = 2.8143e-01, PNorm = 83.2350, GNorm = 0.5484, lr_0 = 4.2317e-04
Loss = 2.5567e-01, PNorm = 83.2554, GNorm = 0.6695, lr_0 = 4.3033e-04
Loss = 2.7107e-01, PNorm = 83.2758, GNorm = 0.5766, lr_0 = 4.3750e-04
Loss = 2.8971e-01, PNorm = 83.2963, GNorm = 1.1549, lr_0 = 4.4467e-04
Loss = 2.4382e-01, PNorm = 83.3139, GNorm = 0.4499, lr_0 = 4.5183e-04
Loss = 3.5416e-01, PNorm = 83.3261, GNorm = 0.6239, lr_0 = 4.5900e-04
Loss = 2.2720e-01, PNorm = 83.3512, GNorm = 0.3088, lr_0 = 4.6616e-04
Loss = 2.5354e-01, PNorm = 83.3619, GNorm = 0.4855, lr_0 = 4.7333e-04
Loss = 2.2799e-01, PNorm = 83.3823, GNorm = 0.5041, lr_0 = 4.8049e-04
Loss = 2.3468e-01, PNorm = 83.3988, GNorm = 0.6191, lr_0 = 4.8766e-04
Loss = 2.6401e-01, PNorm = 83.4128, GNorm = 0.6149, lr_0 = 4.9482e-04
Loss = 2.3345e-01, PNorm = 83.4365, GNorm = 0.7326, lr_0 = 5.0199e-04
Loss = 3.7491e-01, PNorm = 83.4500, GNorm = 1.1700, lr_0 = 5.0916e-04
Loss = 2.0349e-01, PNorm = 83.4881, GNorm = 0.4827, lr_0 = 5.1632e-04
Loss = 3.5149e-01, PNorm = 83.4943, GNorm = 0.4441, lr_0 = 5.2349e-04
Loss = 2.5810e-01, PNorm = 83.5223, GNorm = 0.3470, lr_0 = 5.3065e-04
Loss = 2.9533e-01, PNorm = 83.5312, GNorm = 0.5599, lr_0 = 5.3782e-04
Loss = 2.8986e-01, PNorm = 83.5460, GNorm = 0.4511, lr_0 = 5.4498e-04
Validation auc = 0.781290
Epoch 1
Loss = 2.5439e-01, PNorm = 83.5693, GNorm = 0.6279, lr_0 = 5.5287e-04
Loss = 2.5224e-01, PNorm = 83.5894, GNorm = 0.4581, lr_0 = 5.6003e-04
Loss = 2.6750e-01, PNorm = 83.6130, GNorm = 1.7233, lr_0 = 5.6720e-04
Loss = 2.4976e-01, PNorm = 83.6345, GNorm = 0.4494, lr_0 = 5.7436e-04
Loss = 2.6930e-01, PNorm = 83.6622, GNorm = 0.7211, lr_0 = 5.8153e-04
Loss = 2.3660e-01, PNorm = 83.6993, GNorm = 0.5051, lr_0 = 5.8869e-04
Loss = 2.0631e-01, PNorm = 83.7276, GNorm = 0.4415, lr_0 = 5.9586e-04
Loss = 3.0108e-01, PNorm = 83.7627, GNorm = 0.5713, lr_0 = 6.0303e-04
Loss = 2.9921e-01, PNorm = 83.7915, GNorm = 0.5621, lr_0 = 6.1019e-04
Loss = 3.0574e-01, PNorm = 83.8258, GNorm = 0.7286, lr_0 = 6.1736e-04
Loss = 2.5206e-01, PNorm = 83.8625, GNorm = 1.2766, lr_0 = 6.2452e-04
Loss = 2.9093e-01, PNorm = 83.9046, GNorm = 0.5106, lr_0 = 6.3169e-04
Loss = 2.3718e-01, PNorm = 83.9399, GNorm = 0.4292, lr_0 = 6.3885e-04
Loss = 2.5055e-01, PNorm = 83.9762, GNorm = 0.4213, lr_0 = 6.4602e-04
Loss = 2.9631e-01, PNorm = 84.0004, GNorm = 0.4643, lr_0 = 6.5318e-04
Loss = 2.4560e-01, PNorm = 84.0346, GNorm = 0.3146, lr_0 = 6.6035e-04
Loss = 2.5437e-01, PNorm = 84.0624, GNorm = 0.4688, lr_0 = 6.6752e-04
Loss = 2.4635e-01, PNorm = 84.1270, GNorm = 1.0707, lr_0 = 6.7468e-04
Loss = 2.7526e-01, PNorm = 84.1884, GNorm = 0.3642, lr_0 = 6.8185e-04
Loss = 2.6749e-01, PNorm = 84.2587, GNorm = 0.5032, lr_0 = 6.8901e-04
Loss = 2.6219e-01, PNorm = 84.3105, GNorm = 1.3021, lr_0 = 6.9618e-04
Loss = 2.9160e-01, PNorm = 84.3497, GNorm = 0.7867, lr_0 = 7.0334e-04
Loss = 2.8490e-01, PNorm = 84.3911, GNorm = 0.3474, lr_0 = 7.1051e-04
Loss = 2.8199e-01, PNorm = 84.4474, GNorm = 1.9299, lr_0 = 7.1768e-04
Loss = 2.7019e-01, PNorm = 84.5016, GNorm = 0.7294, lr_0 = 7.2484e-04
Loss = 2.5481e-01, PNorm = 84.5541, GNorm = 0.3642, lr_0 = 7.3201e-04
Loss = 3.0303e-01, PNorm = 84.5938, GNorm = 0.6700, lr_0 = 7.3917e-04
Loss = 2.3487e-01, PNorm = 84.6460, GNorm = 0.4366, lr_0 = 7.4634e-04
Loss = 2.6744e-01, PNorm = 84.6874, GNorm = 0.7318, lr_0 = 7.5350e-04
Loss = 3.0420e-01, PNorm = 84.7427, GNorm = 0.4764, lr_0 = 7.6067e-04
Loss = 2.7218e-01, PNorm = 84.8357, GNorm = 0.5368, lr_0 = 7.6783e-04
Loss = 2.8992e-01, PNorm = 84.9564, GNorm = 0.5983, lr_0 = 7.7500e-04
Loss = 3.0353e-01, PNorm = 85.0785, GNorm = 0.4091, lr_0 = 7.8217e-04
Loss = 2.4682e-01, PNorm = 85.1702, GNorm = 0.4884, lr_0 = 7.8933e-04
Loss = 2.8423e-01, PNorm = 85.2532, GNorm = 0.8044, lr_0 = 7.9650e-04
Loss = 2.7581e-01, PNorm = 85.3079, GNorm = 0.4138, lr_0 = 8.0366e-04
Loss = 2.2346e-01, PNorm = 85.3747, GNorm = 0.3310, lr_0 = 8.1083e-04
Loss = 2.4394e-01, PNorm = 85.4287, GNorm = 0.4156, lr_0 = 8.1799e-04
Loss = 2.9938e-01, PNorm = 85.4729, GNorm = 0.6033, lr_0 = 8.2516e-04
Loss = 2.2340e-01, PNorm = 85.5432, GNorm = 0.4766, lr_0 = 8.3232e-04
Loss = 2.7940e-01, PNorm = 85.6292, GNorm = 0.5571, lr_0 = 8.3949e-04
Loss = 2.6687e-01, PNorm = 85.7162, GNorm = 0.6323, lr_0 = 8.4666e-04
Loss = 2.6774e-01, PNorm = 85.7935, GNorm = 0.8133, lr_0 = 8.5382e-04
Loss = 1.9846e-01, PNorm = 85.8770, GNorm = 1.2671, lr_0 = 8.6099e-04
Loss = 2.9791e-01, PNorm = 85.9665, GNorm = 0.5865, lr_0 = 8.6815e-04
Loss = 2.5667e-01, PNorm = 86.0547, GNorm = 0.3645, lr_0 = 8.7532e-04
Loss = 2.9426e-01, PNorm = 86.1201, GNorm = 0.6113, lr_0 = 8.8248e-04
Loss = 2.3160e-01, PNorm = 86.1711, GNorm = 0.3822, lr_0 = 8.8965e-04
Loss = 2.1830e-01, PNorm = 86.2176, GNorm = 0.7306, lr_0 = 8.9682e-04
Loss = 3.3061e-01, PNorm = 86.2590, GNorm = 1.0242, lr_0 = 9.0398e-04
Loss = 2.1998e-01, PNorm = 86.3126, GNorm = 0.4152, lr_0 = 9.1115e-04
Loss = 2.6565e-01, PNorm = 86.3632, GNorm = 0.5834, lr_0 = 9.1831e-04
Loss = 2.2454e-01, PNorm = 86.4536, GNorm = 0.4833, lr_0 = 9.2548e-04
Loss = 2.4552e-01, PNorm = 86.5193, GNorm = 0.6610, lr_0 = 9.3264e-04
Loss = 2.8469e-01, PNorm = 86.5771, GNorm = 0.4644, lr_0 = 9.3981e-04
Loss = 2.6208e-01, PNorm = 86.6698, GNorm = 0.6828, lr_0 = 9.4697e-04
Loss = 2.4149e-01, PNorm = 86.7834, GNorm = 0.4914, lr_0 = 9.5414e-04
Loss = 2.7486e-01, PNorm = 86.9149, GNorm = 1.1311, lr_0 = 9.6131e-04
Loss = 2.2134e-01, PNorm = 87.0653, GNorm = 0.5573, lr_0 = 9.6847e-04
Loss = 2.9061e-01, PNorm = 87.1946, GNorm = 0.5088, lr_0 = 9.7564e-04
Loss = 2.9554e-01, PNorm = 87.3091, GNorm = 0.3794, lr_0 = 9.8280e-04
Loss = 2.4649e-01, PNorm = 87.4010, GNorm = 0.7533, lr_0 = 9.8997e-04
Loss = 2.1584e-01, PNorm = 87.4911, GNorm = 0.4292, lr_0 = 9.9713e-04
Validation auc = 0.801889
Epoch 2
Loss = 2.6985e-01, PNorm = 87.5483, GNorm = 0.4099, lr_0 = 9.9921e-04
Loss = 2.5239e-01, PNorm = 87.6566, GNorm = 0.2974, lr_0 = 9.9791e-04
Loss = 2.7975e-01, PNorm = 87.7406, GNorm = 0.4409, lr_0 = 9.9660e-04
Loss = 3.0321e-01, PNorm = 87.8134, GNorm = 0.7838, lr_0 = 9.9530e-04
Loss = 2.3131e-01, PNorm = 87.9100, GNorm = 0.4144, lr_0 = 9.9399e-04
Loss = 2.7025e-01, PNorm = 87.9966, GNorm = 0.6102, lr_0 = 9.9269e-04
Loss = 2.5443e-01, PNorm = 88.0750, GNorm = 0.4151, lr_0 = 9.9139e-04
Loss = 2.1036e-01, PNorm = 88.1543, GNorm = 0.4034, lr_0 = 9.9010e-04
Loss = 2.7655e-01, PNorm = 88.2333, GNorm = 0.4875, lr_0 = 9.8880e-04
Loss = 2.3726e-01, PNorm = 88.3098, GNorm = 0.6840, lr_0 = 9.8751e-04
Loss = 2.7384e-01, PNorm = 88.3996, GNorm = 0.7248, lr_0 = 9.8622e-04
Loss = 2.4889e-01, PNorm = 88.4708, GNorm = 0.4564, lr_0 = 9.8492e-04
Loss = 2.2679e-01, PNorm = 88.5418, GNorm = 0.4455, lr_0 = 9.8364e-04
Loss = 2.2918e-01, PNorm = 88.6250, GNorm = 0.6923, lr_0 = 9.8235e-04
Loss = 2.2232e-01, PNorm = 88.7286, GNorm = 0.6056, lr_0 = 9.8106e-04
Loss = 2.7382e-01, PNorm = 88.8493, GNorm = 0.7909, lr_0 = 9.7978e-04
Loss = 2.4617e-01, PNorm = 89.0179, GNorm = 0.6206, lr_0 = 9.7850e-04
Loss = 2.6434e-01, PNorm = 89.2038, GNorm = 0.6236, lr_0 = 9.7722e-04

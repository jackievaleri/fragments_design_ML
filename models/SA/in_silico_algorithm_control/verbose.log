Command line
python /home/jackievaleri8/.conda/envs/chemprop/bin/chemprop_train --data_path ../data/in_silico_algorithm_control/sa_2300_screen.csv --features_generator rdkit_2d_normalized --save_dir ../models/in_silico_algorithm_control/ --dataset_type classification --no_features_scaling --num_folds 30 --ensemble_size 1 --split_sizes 0.8 0.1 0.1 --smiles_column smiles --split_type scaffold_balanced --target_column class --metric prc-auc --extra_metrics auc --dropout 0.05 --hidden_size 900 --ffn_num_layers 1 --depth 5
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/in_silico_algorithm_control/sa_2300_screen.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.05,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': ['auc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 30,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': '../models/in_silico_algorithm_control/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': ['class'],
 'task_names': ['class'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 1,115 | train scaffolds = 847 | val scaffolds = 130 | test scaffolds = 138
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.9821e-01, PNorm = 46.0425, GNorm = 1.7453, lr_0 = 2.3378e-04
Loss = 2.5607e-01, PNorm = 46.0613, GNorm = 0.6639, lr_0 = 3.5541e-04
Loss = 2.1713e-01, PNorm = 46.0802, GNorm = 0.2464, lr_0 = 4.7703e-04
Validation prc-auc = 0.127462
Validation auc = 0.704676
Epoch 1
Loss = 2.3137e-01, PNorm = 46.1155, GNorm = 0.2404, lr_0 = 6.1081e-04
Loss = 1.8191e-01, PNorm = 46.1479, GNorm = 0.5353, lr_0 = 7.3243e-04
Loss = 2.3483e-01, PNorm = 46.1806, GNorm = 0.5190, lr_0 = 8.5405e-04
Loss = 2.4040e-01, PNorm = 46.2262, GNorm = 1.1684, lr_0 = 9.7568e-04
Validation prc-auc = 0.466290
Validation auc = 0.893338
Epoch 2
Loss = 1.6635e-01, PNorm = 46.2794, GNorm = 0.1761, lr_0 = 9.8238e-04
Loss = 1.8699e-01, PNorm = 46.3387, GNorm = 0.3059, lr_0 = 9.6078e-04
Loss = 2.0680e-01, PNorm = 46.4053, GNorm = 0.6761, lr_0 = 9.3966e-04
Loss = 2.1433e-01, PNorm = 46.4998, GNorm = 0.2601, lr_0 = 9.1901e-04
Validation prc-auc = 0.526592
Validation auc = 0.900064
Epoch 3
Loss = 1.9338e-01, PNorm = 46.5687, GNorm = 0.4576, lr_0 = 8.9881e-04
Loss = 1.9790e-01, PNorm = 46.6451, GNorm = 0.9403, lr_0 = 8.7905e-04
Loss = 1.8399e-01, PNorm = 46.7264, GNorm = 0.4211, lr_0 = 8.5973e-04
Loss = 1.5271e-01, PNorm = 46.8231, GNorm = 1.4079, lr_0 = 8.4083e-04
Validation prc-auc = 0.590220
Validation auc = 0.942345
Epoch 4
Loss = 2.2880e-01, PNorm = 46.9109, GNorm = 1.1902, lr_0 = 8.2235e-04
Loss = 1.6589e-01, PNorm = 47.0207, GNorm = 0.2257, lr_0 = 8.0428e-04
Loss = 1.9452e-01, PNorm = 47.0930, GNorm = 0.2959, lr_0 = 7.8660e-04
Validation prc-auc = 0.466223
Validation auc = 0.879885
Epoch 5
Loss = 1.6462e-01, PNorm = 47.1451, GNorm = 0.2621, lr_0 = 7.6931e-04
Loss = 1.9201e-01, PNorm = 47.2006, GNorm = 0.3015, lr_0 = 7.5240e-04
Loss = 1.6581e-01, PNorm = 47.2622, GNorm = 0.4466, lr_0 = 7.3586e-04
Loss = 1.8005e-01, PNorm = 47.3496, GNorm = 0.9735, lr_0 = 7.1969e-04
Validation prc-auc = 0.444319
Validation auc = 0.844971
Epoch 6
Loss = 2.2488e-01, PNorm = 47.4109, GNorm = 0.6397, lr_0 = 7.0387e-04
Loss = 2.0778e-01, PNorm = 47.4635, GNorm = 0.4222, lr_0 = 6.8840e-04
Loss = 1.7968e-01, PNorm = 47.5354, GNorm = 0.2844, lr_0 = 6.7326e-04
Loss = 1.5356e-01, PNorm = 47.6168, GNorm = 0.4704, lr_0 = 6.5847e-04
Validation prc-auc = 0.591826
Validation auc = 0.896861
Epoch 7
Loss = 2.0737e-01, PNorm = 47.6762, GNorm = 0.5524, lr_0 = 6.4399e-04
Loss = 1.5838e-01, PNorm = 47.7229, GNorm = 0.2654, lr_0 = 6.2984e-04
Loss = 1.5616e-01, PNorm = 47.7974, GNorm = 0.6689, lr_0 = 6.1599e-04
Loss = 1.4092e-01, PNorm = 47.8864, GNorm = 0.2743, lr_0 = 6.0245e-04
Validation prc-auc = 0.716475
Validation auc = 0.907751
Epoch 8
Loss = 1.3222e-01, PNorm = 47.9074, GNorm = 0.3156, lr_0 = 5.8921e-04
Loss = 1.8009e-01, PNorm = 47.9637, GNorm = 0.6947, lr_0 = 5.7626e-04
Loss = 1.5102e-01, PNorm = 48.0116, GNorm = 0.7447, lr_0 = 5.6359e-04
Loss = 1.5991e-01, PNorm = 48.0732, GNorm = 0.2781, lr_0 = 5.5120e-04
Validation prc-auc = 0.711291
Validation auc = 0.918642
Epoch 9
Loss = 1.5193e-01, PNorm = 48.1332, GNorm = 0.2294, lr_0 = 5.3909e-04
Loss = 1.3950e-01, PNorm = 48.1830, GNorm = 0.3460, lr_0 = 5.2724e-04
Loss = 1.2507e-01, PNorm = 48.2403, GNorm = 0.1763, lr_0 = 5.1565e-04
Validation prc-auc = 0.663509
Validation auc = 0.872518
Epoch 10
Loss = 1.6592e-01, PNorm = 48.2736, GNorm = 0.6664, lr_0 = 5.0432e-04
Loss = 1.6441e-01, PNorm = 48.3447, GNorm = 0.1752, lr_0 = 4.9323e-04
Loss = 1.2309e-01, PNorm = 48.4088, GNorm = 0.2674, lr_0 = 4.8239e-04
Loss = 1.3264e-01, PNorm = 48.4582, GNorm = 0.1740, lr_0 = 4.7179e-04
Validation prc-auc = 0.508744
Validation auc = 0.810698
Epoch 11
Loss = 1.8241e-01, PNorm = 48.4854, GNorm = 0.3713, lr_0 = 4.6142e-04
Loss = 1.4611e-01, PNorm = 48.5395, GNorm = 0.4319, lr_0 = 4.5127e-04
Loss = 1.3935e-01, PNorm = 48.6011, GNorm = 0.4920, lr_0 = 4.4135e-04
Loss = 1.1905e-01, PNorm = 48.6604, GNorm = 0.1990, lr_0 = 4.3165e-04
Validation prc-auc = 0.574870
Validation auc = 0.852659
Epoch 12
Loss = 2.0563e-01, PNorm = 48.6901, GNorm = 1.0165, lr_0 = 4.2217e-04
Loss = 1.6539e-01, PNorm = 48.7363, GNorm = 0.5939, lr_0 = 4.1289e-04
Loss = 1.3149e-01, PNorm = 48.7949, GNorm = 0.2982, lr_0 = 4.0381e-04
Loss = 1.2703e-01, PNorm = 48.8523, GNorm = 0.3615, lr_0 = 3.9493e-04
Validation prc-auc = 0.708062
Validation auc = 0.939142
Epoch 13
Loss = 1.2613e-01, PNorm = 48.8960, GNorm = 0.4791, lr_0 = 3.8625e-04
Loss = 1.4645e-01, PNorm = 48.9313, GNorm = 0.2906, lr_0 = 3.7776e-04
Loss = 1.4558e-01, PNorm = 48.9844, GNorm = 0.8453, lr_0 = 3.6946e-04
Loss = 1.0172e-01, PNorm = 49.0330, GNorm = 0.4304, lr_0 = 3.6134e-04
Validation prc-auc = 0.621803
Validation auc = 0.899103
Epoch 14
Loss = 1.3689e-01, PNorm = 49.0680, GNorm = 0.3152, lr_0 = 3.5340e-04
Loss = 1.2104e-01, PNorm = 49.1143, GNorm = 0.2086, lr_0 = 3.4563e-04
Loss = 1.0920e-01, PNorm = 49.1583, GNorm = 0.2428, lr_0 = 3.3803e-04
Validation prc-auc = 0.643544
Validation auc = 0.936899
Epoch 15
Loss = 1.0163e-01, PNorm = 49.1905, GNorm = 0.7634, lr_0 = 3.3060e-04
Loss = 1.4983e-01, PNorm = 49.2289, GNorm = 0.4710, lr_0 = 3.2333e-04
Loss = 9.9134e-02, PNorm = 49.2743, GNorm = 0.7509, lr_0 = 3.1623e-04
Loss = 1.2472e-01, PNorm = 49.3180, GNorm = 0.4848, lr_0 = 3.0928e-04
Validation prc-auc = 0.578389
Validation auc = 0.897181
Epoch 16
Loss = 1.7181e-01, PNorm = 49.3608, GNorm = 0.5711, lr_0 = 3.0248e-04
Loss = 1.0169e-01, PNorm = 49.4055, GNorm = 0.3819, lr_0 = 2.9583e-04
Loss = 1.0330e-01, PNorm = 49.4473, GNorm = 1.0322, lr_0 = 2.8933e-04
Loss = 9.5725e-02, PNorm = 49.5018, GNorm = 0.2042, lr_0 = 2.8297e-04
Validation prc-auc = 0.582699
Validation auc = 0.884049
Epoch 17
Loss = 1.1346e-01, PNorm = 49.5253, GNorm = 0.4734, lr_0 = 2.7675e-04
Loss = 1.4516e-01, PNorm = 49.5753, GNorm = 0.6340, lr_0 = 2.7067e-04
Loss = 8.9409e-02, PNorm = 49.6056, GNorm = 0.4851, lr_0 = 2.6472e-04
Loss = 8.7886e-02, PNorm = 49.6345, GNorm = 0.3580, lr_0 = 2.5890e-04
Validation prc-auc = 0.609368
Validation auc = 0.926329
Epoch 18
Loss = 6.2901e-02, PNorm = 49.6641, GNorm = 0.7444, lr_0 = 2.5321e-04
Loss = 1.0941e-01, PNorm = 49.6821, GNorm = 0.4476, lr_0 = 2.4764e-04
Loss = 9.4521e-02, PNorm = 49.7190, GNorm = 0.3849, lr_0 = 2.4220e-04
Loss = 1.1641e-01, PNorm = 49.7507, GNorm = 0.4803, lr_0 = 2.3687e-04
Validation prc-auc = 0.608479
Validation auc = 0.910314
Epoch 19
Loss = 8.7717e-02, PNorm = 49.7775, GNorm = 0.2968, lr_0 = 2.3167e-04
Loss = 1.0014e-01, PNorm = 49.8059, GNorm = 0.5827, lr_0 = 2.2658e-04
Loss = 8.8055e-02, PNorm = 49.8410, GNorm = 0.3594, lr_0 = 2.2159e-04
Validation prc-auc = 0.523970
Validation auc = 0.818065
Epoch 20
Loss = 6.4439e-02, PNorm = 49.8692, GNorm = 0.5626, lr_0 = 2.1672e-04
Loss = 7.9320e-02, PNorm = 49.8986, GNorm = 0.7831, lr_0 = 2.1196e-04
Loss = 7.9638e-02, PNorm = 49.9212, GNorm = 0.4390, lr_0 = 2.0730e-04
Loss = 9.2998e-02, PNorm = 49.9524, GNorm = 0.4146, lr_0 = 2.0274e-04
Validation prc-auc = 0.582179
Validation auc = 0.900064
Epoch 21
Loss = 5.0041e-02, PNorm = 49.9763, GNorm = 0.4863, lr_0 = 1.9829e-04
Loss = 6.2415e-02, PNorm = 50.0021, GNorm = 0.7792, lr_0 = 1.9393e-04
Loss = 8.5353e-02, PNorm = 50.0188, GNorm = 0.5301, lr_0 = 1.8967e-04
Loss = 8.9458e-02, PNorm = 50.0525, GNorm = 0.5719, lr_0 = 1.8550e-04
Validation prc-auc = 0.555663
Validation auc = 0.842088
Epoch 22
Loss = 8.7670e-02, PNorm = 50.0738, GNorm = 0.6636, lr_0 = 1.8142e-04
Loss = 6.1267e-02, PNorm = 50.0991, GNorm = 0.3937, lr_0 = 1.7743e-04
Loss = 6.2497e-02, PNorm = 50.1178, GNorm = 0.6052, lr_0 = 1.7353e-04
Loss = 9.6272e-02, PNorm = 50.1453, GNorm = 0.5205, lr_0 = 1.6972e-04
Validation prc-auc = 0.531601
Validation auc = 0.802370
Epoch 23
Loss = 5.0085e-02, PNorm = 50.1625, GNorm = 0.2688, lr_0 = 1.6599e-04
Loss = 5.9435e-02, PNorm = 50.1802, GNorm = 0.4458, lr_0 = 1.6234e-04
Loss = 5.9706e-02, PNorm = 50.1992, GNorm = 0.4757, lr_0 = 1.5877e-04
Loss = 9.3180e-02, PNorm = 50.2175, GNorm = 0.6859, lr_0 = 1.5528e-04
Validation prc-auc = 0.584956
Validation auc = 0.881166
Epoch 24
Loss = 4.6063e-02, PNorm = 50.2478, GNorm = 0.4156, lr_0 = 1.5187e-04
Loss = 7.3191e-02, PNorm = 50.2650, GNorm = 1.0678, lr_0 = 1.4853e-04
Loss = 7.9735e-02, PNorm = 50.2756, GNorm = 0.8236, lr_0 = 1.4527e-04
Validation prc-auc = 0.551461
Validation auc = 0.872197
Epoch 25
Loss = 3.2570e-02, PNorm = 50.2923, GNorm = 0.4958, lr_0 = 1.4207e-04
Loss = 5.3843e-02, PNorm = 50.3117, GNorm = 0.4310, lr_0 = 1.3895e-04
Loss = 5.7861e-02, PNorm = 50.3255, GNorm = 0.3512, lr_0 = 1.3590e-04
Loss = 7.1707e-02, PNorm = 50.3413, GNorm = 0.4661, lr_0 = 1.3291e-04
Validation prc-auc = 0.551227
Validation auc = 0.843690
Epoch 26
Loss = 4.2799e-02, PNorm = 50.3609, GNorm = 0.5352, lr_0 = 1.2999e-04
Loss = 4.7297e-02, PNorm = 50.3691, GNorm = 0.8090, lr_0 = 1.2713e-04
Loss = 7.6225e-02, PNorm = 50.3884, GNorm = 1.5170, lr_0 = 1.2434e-04
Loss = 6.0864e-02, PNorm = 50.4029, GNorm = 0.3354, lr_0 = 1.2160e-04
Validation prc-auc = 0.547747
Validation auc = 0.832799
Epoch 27
Loss = 2.8482e-02, PNorm = 50.4189, GNorm = 0.6318, lr_0 = 1.1893e-04
Loss = 3.3522e-02, PNorm = 50.4272, GNorm = 0.5863, lr_0 = 1.1632e-04
Loss = 7.9024e-02, PNorm = 50.4366, GNorm = 0.5267, lr_0 = 1.1376e-04
Loss = 5.2748e-02, PNorm = 50.4567, GNorm = 0.3563, lr_0 = 1.1126e-04
Validation prc-auc = 0.505148
Validation auc = 0.859385
Epoch 28
Loss = 6.1690e-02, PNorm = 50.4665, GNorm = 0.4666, lr_0 = 1.0881e-04
Loss = 4.7655e-02, PNorm = 50.4836, GNorm = 1.1085, lr_0 = 1.0642e-04
Loss = 6.5928e-02, PNorm = 50.4943, GNorm = 0.5349, lr_0 = 1.0408e-04
Loss = 3.3487e-02, PNorm = 50.5049, GNorm = 0.3101, lr_0 = 1.0179e-04
Validation prc-auc = 0.556578
Validation auc = 0.851377
Epoch 29
Loss = 2.8132e-02, PNorm = 50.5147, GNorm = 0.2840, lr_0 = 1.0000e-04
Loss = 3.7964e-02, PNorm = 50.5229, GNorm = 0.4108, lr_0 = 1.0000e-04
Loss = 5.3959e-02, PNorm = 50.5350, GNorm = 0.3013, lr_0 = 1.0000e-04
Validation prc-auc = 0.508125
Validation auc = 0.819667
Model 0 best validation prc-auc = 0.716475 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.545332
Model 0 test auc = 0.843658
Ensemble test prc-auc = 0.545332
Ensemble test auc = 0.843658
Fold 1
Splitting data with seed 1
Total scaffolds = 1,115 | train scaffolds = 877 | val scaffolds = 114 | test scaffolds = 124
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.8494e-01, PNorm = 46.0444, GNorm = 2.3974, lr_0 = 2.3378e-04
Loss = 2.5121e-01, PNorm = 46.0625, GNorm = 0.2320, lr_0 = 3.5541e-04
Loss = 2.3703e-01, PNorm = 46.0850, GNorm = 0.4280, lr_0 = 4.7703e-04
Validation prc-auc = 0.261184
Validation auc = 0.855349
Epoch 1
Loss = 1.7816e-01, PNorm = 46.1170, GNorm = 0.3900, lr_0 = 6.1081e-04
Loss = 2.0626e-01, PNorm = 46.1510, GNorm = 0.2520, lr_0 = 7.3243e-04
Loss = 2.3834e-01, PNorm = 46.1865, GNorm = 0.9194, lr_0 = 8.5405e-04
Loss = 2.3405e-01, PNorm = 46.2385, GNorm = 0.8314, lr_0 = 9.7568e-04
Validation prc-auc = 0.168379
Validation auc = 0.713974
Epoch 2
Loss = 2.1890e-01, PNorm = 46.3086, GNorm = 0.2500, lr_0 = 9.8238e-04
Loss = 1.9832e-01, PNorm = 46.3937, GNorm = 1.1461, lr_0 = 9.6078e-04
Loss = 2.2554e-01, PNorm = 46.4700, GNorm = 0.5118, lr_0 = 9.3966e-04
Loss = 1.8275e-01, PNorm = 46.5559, GNorm = 0.1487, lr_0 = 9.1901e-04
Validation prc-auc = 0.292507
Validation auc = 0.767467
Epoch 3
Loss = 1.8767e-01, PNorm = 46.6205, GNorm = 0.5411, lr_0 = 8.9881e-04
Loss = 1.5480e-01, PNorm = 46.6883, GNorm = 0.2449, lr_0 = 8.7905e-04
Loss = 2.0636e-01, PNorm = 46.7582, GNorm = 2.6915, lr_0 = 8.5973e-04
Loss = 1.8794e-01, PNorm = 46.8140, GNorm = 0.3937, lr_0 = 8.4083e-04
Validation prc-auc = 0.330319
Validation auc = 0.823690
Epoch 4
Loss = 1.9439e-01, PNorm = 46.8985, GNorm = 0.5039, lr_0 = 8.2235e-04
Loss = 1.6864e-01, PNorm = 46.9804, GNorm = 0.1582, lr_0 = 8.0428e-04
Loss = 1.6146e-01, PNorm = 47.0522, GNorm = 0.7705, lr_0 = 7.8660e-04
Validation prc-auc = 0.473410
Validation auc = 0.853712
Epoch 5
Loss = 2.7607e-01, PNorm = 47.1159, GNorm = 0.6215, lr_0 = 7.6931e-04
Loss = 1.5880e-01, PNorm = 47.1953, GNorm = 0.1661, lr_0 = 7.5240e-04
Loss = 1.9263e-01, PNorm = 47.2522, GNorm = 0.2549, lr_0 = 7.3586e-04
Loss = 1.8683e-01, PNorm = 47.3503, GNorm = 0.2606, lr_0 = 7.1969e-04
Validation prc-auc = 0.350999
Validation auc = 0.755459
Epoch 6
Loss = 1.2274e-01, PNorm = 47.4107, GNorm = 0.4895, lr_0 = 7.0387e-04
Loss = 1.4493e-01, PNorm = 47.4802, GNorm = 1.0245, lr_0 = 6.8840e-04
Loss = 1.7760e-01, PNorm = 47.5356, GNorm = 0.6635, lr_0 = 6.7326e-04
Loss = 1.6463e-01, PNorm = 47.6086, GNorm = 0.3232, lr_0 = 6.5847e-04
Validation prc-auc = 0.395465
Validation auc = 0.812227
Epoch 7
Loss = 2.2902e-01, PNorm = 47.6671, GNorm = 0.5413, lr_0 = 6.4399e-04
Loss = 2.0069e-01, PNorm = 47.7295, GNorm = 0.2589, lr_0 = 6.2984e-04
Loss = 1.7300e-01, PNorm = 47.7991, GNorm = 0.5843, lr_0 = 6.1599e-04
Loss = 1.1921e-01, PNorm = 47.8677, GNorm = 1.2054, lr_0 = 6.0245e-04
Validation prc-auc = 0.342066
Validation auc = 0.776747
Epoch 8
Loss = 1.4527e-01, PNorm = 47.9143, GNorm = 0.4833, lr_0 = 5.8921e-04
Loss = 1.7657e-01, PNorm = 47.9504, GNorm = 0.3242, lr_0 = 5.7626e-04
Loss = 1.7645e-01, PNorm = 47.9818, GNorm = 0.2727, lr_0 = 5.6359e-04
Loss = 1.1086e-01, PNorm = 48.0246, GNorm = 0.2316, lr_0 = 5.5120e-04
Validation prc-auc = 0.351122
Validation auc = 0.757642
Epoch 9
Loss = 1.6344e-01, PNorm = 48.0786, GNorm = 0.7120, lr_0 = 5.3909e-04
Loss = 1.5584e-01, PNorm = 48.1169, GNorm = 0.3574, lr_0 = 5.2724e-04
Loss = 1.4856e-01, PNorm = 48.1533, GNorm = 0.3238, lr_0 = 5.1565e-04
Validation prc-auc = 0.380582
Validation auc = 0.796397
Epoch 10
Loss = 1.9147e-01, PNorm = 48.2031, GNorm = 0.3972, lr_0 = 5.0432e-04
Loss = 1.5218e-01, PNorm = 48.2431, GNorm = 0.5320, lr_0 = 4.9323e-04
Loss = 1.3914e-01, PNorm = 48.2877, GNorm = 0.5065, lr_0 = 4.8239e-04
Loss = 1.2140e-01, PNorm = 48.3277, GNorm = 0.9534, lr_0 = 4.7179e-04
Validation prc-auc = 0.395393
Validation auc = 0.778930
Epoch 11
Loss = 9.7367e-02, PNorm = 48.3560, GNorm = 0.4490, lr_0 = 4.6142e-04
Loss = 1.1546e-01, PNorm = 48.4042, GNorm = 0.5904, lr_0 = 4.5127e-04
Loss = 1.9161e-01, PNorm = 48.4410, GNorm = 0.5354, lr_0 = 4.4135e-04
Loss = 1.3000e-01, PNorm = 48.4949, GNorm = 0.1896, lr_0 = 4.3165e-04
Validation prc-auc = 0.396973
Validation auc = 0.810044
Epoch 12
Loss = 1.1546e-01, PNorm = 48.5381, GNorm = 0.2521, lr_0 = 4.2217e-04
Loss = 1.4582e-01, PNorm = 48.5904, GNorm = 0.9502, lr_0 = 4.1289e-04
Loss = 1.6428e-01, PNorm = 48.6201, GNorm = 0.7329, lr_0 = 4.0381e-04
Loss = 1.2519e-01, PNorm = 48.6729, GNorm = 0.5660, lr_0 = 3.9493e-04
Validation prc-auc = 0.428621
Validation auc = 0.763646
Epoch 13
Loss = 1.0300e-01, PNorm = 48.7041, GNorm = 0.4899, lr_0 = 3.8625e-04
Loss = 1.4661e-01, PNorm = 48.7413, GNorm = 0.6620, lr_0 = 3.7776e-04
Loss = 1.2849e-01, PNorm = 48.7685, GNorm = 0.3199, lr_0 = 3.6946e-04
Loss = 1.2056e-01, PNorm = 48.8139, GNorm = 0.5383, lr_0 = 3.6134e-04
Validation prc-auc = 0.432635
Validation auc = 0.791485
Epoch 14
Loss = 1.2182e-01, PNorm = 48.8467, GNorm = 0.5922, lr_0 = 3.5340e-04
Loss = 1.2938e-01, PNorm = 48.8774, GNorm = 0.5646, lr_0 = 3.4563e-04
Loss = 1.3887e-01, PNorm = 48.9089, GNorm = 0.4659, lr_0 = 3.3803e-04
Validation prc-auc = 0.434353
Validation auc = 0.754913
Epoch 15
Loss = 6.8707e-02, PNorm = 48.9585, GNorm = 0.3918, lr_0 = 3.3060e-04
Loss = 9.9345e-02, PNorm = 48.9947, GNorm = 0.2830, lr_0 = 3.2333e-04
Loss = 1.1000e-01, PNorm = 49.0284, GNorm = 0.4358, lr_0 = 3.1623e-04
Loss = 1.5305e-01, PNorm = 49.0563, GNorm = 0.4338, lr_0 = 3.0928e-04
Validation prc-auc = 0.414475
Validation auc = 0.715611
Epoch 16
Loss = 5.0598e-02, PNorm = 49.0953, GNorm = 0.2017, lr_0 = 3.0248e-04
Loss = 1.3975e-01, PNorm = 49.1058, GNorm = 0.5769, lr_0 = 2.9583e-04
Loss = 1.0168e-01, PNorm = 49.1460, GNorm = 0.2958, lr_0 = 2.8933e-04
Loss = 1.3009e-01, PNorm = 49.1845, GNorm = 0.2281, lr_0 = 2.8297e-04
Validation prc-auc = 0.424390
Validation auc = 0.776201
Epoch 17
Loss = 9.1517e-02, PNorm = 49.2173, GNorm = 0.3178, lr_0 = 2.7675e-04
Loss = 1.4538e-01, PNorm = 49.2463, GNorm = 0.6499, lr_0 = 2.7067e-04
Loss = 1.1962e-01, PNorm = 49.2790, GNorm = 0.2753, lr_0 = 2.6472e-04
Loss = 1.1136e-01, PNorm = 49.3127, GNorm = 0.4521, lr_0 = 2.5890e-04
Validation prc-auc = 0.441512
Validation auc = 0.805677
Epoch 18
Loss = 9.3963e-02, PNorm = 49.3485, GNorm = 0.6525, lr_0 = 2.5321e-04
Loss = 1.0950e-01, PNorm = 49.3795, GNorm = 0.2247, lr_0 = 2.4764e-04
Loss = 1.3043e-01, PNorm = 49.4065, GNorm = 0.2863, lr_0 = 2.4220e-04
Loss = 9.1099e-02, PNorm = 49.4368, GNorm = 0.2807, lr_0 = 2.3687e-04
Validation prc-auc = 0.428005
Validation auc = 0.751638
Epoch 19
Loss = 1.0140e-01, PNorm = 49.4617, GNorm = 1.0575, lr_0 = 2.3167e-04
Loss = 9.3481e-02, PNorm = 49.4932, GNorm = 0.5702, lr_0 = 2.2658e-04
Loss = 9.8643e-02, PNorm = 49.5142, GNorm = 0.3182, lr_0 = 2.2159e-04
Validation prc-auc = 0.435226
Validation auc = 0.706878
Epoch 20
Loss = 1.3263e-01, PNorm = 49.5372, GNorm = 0.4590, lr_0 = 2.1672e-04
Loss = 9.0527e-02, PNorm = 49.5673, GNorm = 0.5179, lr_0 = 2.1196e-04
Loss = 8.4321e-02, PNorm = 49.5840, GNorm = 0.7295, lr_0 = 2.0730e-04
Loss = 1.0914e-01, PNorm = 49.6065, GNorm = 0.8569, lr_0 = 2.0274e-04
Validation prc-auc = 0.417265
Validation auc = 0.692686
Epoch 21
Loss = 8.7105e-02, PNorm = 49.6424, GNorm = 0.3901, lr_0 = 1.9829e-04
Loss = 1.0433e-01, PNorm = 49.6649, GNorm = 1.3539, lr_0 = 1.9393e-04
Loss = 1.0180e-01, PNorm = 49.6991, GNorm = 1.2501, lr_0 = 1.8967e-04
Loss = 9.5599e-02, PNorm = 49.7176, GNorm = 0.3693, lr_0 = 1.8550e-04
Validation prc-auc = 0.438318
Validation auc = 0.730349
Epoch 22
Loss = 8.9408e-02, PNorm = 49.7424, GNorm = 0.2603, lr_0 = 1.8142e-04
Loss = 8.5942e-02, PNorm = 49.7652, GNorm = 0.2735, lr_0 = 1.7743e-04
Loss = 8.2850e-02, PNorm = 49.7824, GNorm = 0.9413, lr_0 = 1.7353e-04
Loss = 9.1592e-02, PNorm = 49.8001, GNorm = 0.8161, lr_0 = 1.6972e-04
Validation prc-auc = 0.446597
Validation auc = 0.784389
Epoch 23
Loss = 9.7325e-02, PNorm = 49.8229, GNorm = 1.0107, lr_0 = 1.6599e-04
Loss = 9.5422e-02, PNorm = 49.8420, GNorm = 0.3300, lr_0 = 1.6234e-04
Loss = 8.8856e-02, PNorm = 49.8647, GNorm = 0.5890, lr_0 = 1.5877e-04
Loss = 7.3195e-02, PNorm = 49.8816, GNorm = 0.4860, lr_0 = 1.5528e-04
Validation prc-auc = 0.451147
Validation auc = 0.763646
Epoch 24
Loss = 9.6845e-02, PNorm = 49.8949, GNorm = 0.3557, lr_0 = 1.5187e-04
Loss = 7.4417e-02, PNorm = 49.9201, GNorm = 0.7705, lr_0 = 1.4853e-04
Loss = 8.1531e-02, PNorm = 49.9344, GNorm = 0.6802, lr_0 = 1.4527e-04
Validation prc-auc = 0.456761
Validation auc = 0.768013
Epoch 25
Loss = 5.3834e-02, PNorm = 49.9501, GNorm = 0.4045, lr_0 = 1.4207e-04
Loss = 7.9990e-02, PNorm = 49.9671, GNorm = 0.6680, lr_0 = 1.3895e-04
Loss = 6.1170e-02, PNorm = 49.9879, GNorm = 0.4562, lr_0 = 1.3590e-04
Loss = 9.7759e-02, PNorm = 49.9954, GNorm = 0.3867, lr_0 = 1.3291e-04
Validation prc-auc = 0.451560
Validation auc = 0.749454
Epoch 26
Loss = 8.9135e-02, PNorm = 50.0155, GNorm = 1.3057, lr_0 = 1.2999e-04
Loss = 6.4661e-02, PNorm = 50.0353, GNorm = 0.7558, lr_0 = 1.2713e-04
Loss = 6.8164e-02, PNorm = 50.0540, GNorm = 0.5704, lr_0 = 1.2434e-04
Loss = 9.0901e-02, PNorm = 50.0667, GNorm = 0.2903, lr_0 = 1.2160e-04
Validation prc-auc = 0.448278
Validation auc = 0.726528
Epoch 27
Loss = 5.3514e-02, PNorm = 50.0815, GNorm = 0.3417, lr_0 = 1.1893e-04
Loss = 7.4228e-02, PNorm = 50.1001, GNorm = 0.7155, lr_0 = 1.1632e-04
Loss = 7.9703e-02, PNorm = 50.1122, GNorm = 0.1487, lr_0 = 1.1376e-04
Loss = 6.6105e-02, PNorm = 50.1240, GNorm = 0.2179, lr_0 = 1.1126e-04
Validation prc-auc = 0.467434
Validation auc = 0.742358
Epoch 28
Loss = 3.8166e-02, PNorm = 50.1369, GNorm = 0.2297, lr_0 = 1.0881e-04
Loss = 7.2602e-02, PNorm = 50.1483, GNorm = 0.4794, lr_0 = 1.0642e-04
Loss = 7.9602e-02, PNorm = 50.1652, GNorm = 0.8173, lr_0 = 1.0408e-04
Loss = 6.6978e-02, PNorm = 50.1718, GNorm = 0.9316, lr_0 = 1.0179e-04
Validation prc-auc = 0.473348
Validation auc = 0.742904
Epoch 29
Loss = 6.4673e-02, PNorm = 50.1860, GNorm = 0.2062, lr_0 = 1.0000e-04
Loss = 5.4022e-02, PNorm = 50.2032, GNorm = 0.5369, lr_0 = 1.0000e-04
Loss = 8.0582e-02, PNorm = 50.2141, GNorm = 0.8883, lr_0 = 1.0000e-04
Validation prc-auc = 0.473624
Validation auc = 0.727074
Model 0 best validation prc-auc = 0.473624 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.447143
Model 0 test auc = 0.800106
Ensemble test prc-auc = 0.447143
Ensemble test auc = 0.800106
Fold 2
Splitting data with seed 2
Total scaffolds = 1,115 | train scaffolds = 862 | val scaffolds = 153 | test scaffolds = 100
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.2532e-01, PNorm = 46.0447, GNorm = 1.7221, lr_0 = 2.3378e-04
Loss = 2.4324e-01, PNorm = 46.0586, GNorm = 0.7605, lr_0 = 3.5541e-04
Loss = 2.3922e-01, PNorm = 46.0768, GNorm = 0.4763, lr_0 = 4.7703e-04
Validation prc-auc = 0.287958
Validation auc = 0.786949
Epoch 1
Loss = 2.0470e-01, PNorm = 46.1078, GNorm = 0.5361, lr_0 = 6.1081e-04
Loss = 2.0788e-01, PNorm = 46.1398, GNorm = 0.2194, lr_0 = 7.3243e-04
Loss = 2.2391e-01, PNorm = 46.1702, GNorm = 0.7802, lr_0 = 8.5405e-04
Loss = 2.1016e-01, PNorm = 46.2227, GNorm = 0.7004, lr_0 = 9.7568e-04
Validation prc-auc = 0.395294
Validation auc = 0.786420
Epoch 2
Loss = 1.7804e-01, PNorm = 46.2796, GNorm = 0.2552, lr_0 = 9.8238e-04
Loss = 1.6433e-01, PNorm = 46.3238, GNorm = 0.2283, lr_0 = 9.6078e-04
Loss = 2.2607e-01, PNorm = 46.3764, GNorm = 1.3817, lr_0 = 9.3966e-04
Loss = 1.9035e-01, PNorm = 46.4401, GNorm = 1.1578, lr_0 = 9.1901e-04
Validation prc-auc = 0.486500
Validation auc = 0.789947
Epoch 3
Loss = 2.0606e-01, PNorm = 46.4884, GNorm = 0.2081, lr_0 = 8.9881e-04
Loss = 1.8834e-01, PNorm = 46.5557, GNorm = 0.6150, lr_0 = 8.7905e-04
Loss = 1.7454e-01, PNorm = 46.6228, GNorm = 0.3126, lr_0 = 8.5973e-04
Loss = 1.9107e-01, PNorm = 46.6806, GNorm = 0.5716, lr_0 = 8.4083e-04
Validation prc-auc = 0.390866
Validation auc = 0.738624
Epoch 4
Loss = 2.2664e-01, PNorm = 46.7415, GNorm = 0.3464, lr_0 = 8.2235e-04
Loss = 1.6640e-01, PNorm = 46.8150, GNorm = 0.3217, lr_0 = 8.0428e-04
Loss = 1.6909e-01, PNorm = 46.8741, GNorm = 0.4695, lr_0 = 7.8660e-04
Validation prc-auc = 0.517733
Validation auc = 0.799295
Epoch 5
Loss = 1.5726e-01, PNorm = 46.9319, GNorm = 0.2664, lr_0 = 7.6931e-04
Loss = 1.6011e-01, PNorm = 47.0026, GNorm = 0.2144, lr_0 = 7.5240e-04
Loss = 1.6210e-01, PNorm = 47.0632, GNorm = 0.5568, lr_0 = 7.3586e-04
Loss = 2.0630e-01, PNorm = 47.1269, GNorm = 0.9785, lr_0 = 7.1969e-04
Validation prc-auc = 0.557560
Validation auc = 0.836508
Epoch 6
Loss = 1.7643e-01, PNorm = 47.1766, GNorm = 0.2227, lr_0 = 7.0387e-04
Loss = 1.7214e-01, PNorm = 47.2160, GNorm = 0.2620, lr_0 = 6.8840e-04
Loss = 1.8322e-01, PNorm = 47.2839, GNorm = 0.3181, lr_0 = 6.7326e-04
Loss = 1.6360e-01, PNorm = 47.3552, GNorm = 0.7029, lr_0 = 6.5847e-04
Validation prc-auc = 0.579184
Validation auc = 0.839506
Epoch 7
Loss = 8.9917e-02, PNorm = 47.4184, GNorm = 0.2131, lr_0 = 6.4399e-04
Loss = 1.5104e-01, PNorm = 47.4575, GNorm = 0.4670, lr_0 = 6.2984e-04
Loss = 1.9104e-01, PNorm = 47.5236, GNorm = 0.2704, lr_0 = 6.1599e-04
Loss = 1.5661e-01, PNorm = 47.6081, GNorm = 0.4758, lr_0 = 6.0245e-04
Validation prc-auc = 0.599596
Validation auc = 0.827866
Epoch 8
Loss = 1.1616e-01, PNorm = 47.6648, GNorm = 0.2111, lr_0 = 5.8921e-04
Loss = 1.8551e-01, PNorm = 47.7237, GNorm = 0.2267, lr_0 = 5.7626e-04
Loss = 1.3610e-01, PNorm = 47.7954, GNorm = 0.1859, lr_0 = 5.6359e-04
Loss = 1.6846e-01, PNorm = 47.8281, GNorm = 0.4251, lr_0 = 5.5120e-04
Validation prc-auc = 0.626659
Validation auc = 0.824691
Epoch 9
Loss = 1.6356e-01, PNorm = 47.8963, GNorm = 0.1600, lr_0 = 5.3909e-04
Loss = 1.3828e-01, PNorm = 47.9420, GNorm = 0.1976, lr_0 = 5.2724e-04
Loss = 1.2001e-01, PNorm = 47.9913, GNorm = 0.3002, lr_0 = 5.1565e-04
Validation prc-auc = 0.625621
Validation auc = 0.835626
Epoch 10
Loss = 8.9202e-02, PNorm = 48.0348, GNorm = 0.2736, lr_0 = 5.0432e-04
Loss = 1.2369e-01, PNorm = 48.0943, GNorm = 0.2942, lr_0 = 4.9323e-04
Loss = 1.6426e-01, PNorm = 48.1332, GNorm = 0.3886, lr_0 = 4.8239e-04
Loss = 1.4895e-01, PNorm = 48.1757, GNorm = 0.3702, lr_0 = 4.7179e-04
Validation prc-auc = 0.637295
Validation auc = 0.836508
Epoch 11
Loss = 9.8406e-02, PNorm = 48.2099, GNorm = 0.2205, lr_0 = 4.6142e-04
Loss = 1.0961e-01, PNorm = 48.2577, GNorm = 0.2502, lr_0 = 4.5127e-04
Loss = 1.3474e-01, PNorm = 48.2959, GNorm = 0.3593, lr_0 = 4.4135e-04
Loss = 1.6163e-01, PNorm = 48.3291, GNorm = 0.6416, lr_0 = 4.3165e-04
Validation prc-auc = 0.631865
Validation auc = 0.828395
Epoch 12
Loss = 1.3894e-01, PNorm = 48.3592, GNorm = 0.5825, lr_0 = 4.2217e-04
Loss = 1.4178e-01, PNorm = 48.3943, GNorm = 0.2264, lr_0 = 4.1289e-04
Loss = 1.2295e-01, PNorm = 48.4580, GNorm = 0.1701, lr_0 = 4.0381e-04
Loss = 1.3684e-01, PNorm = 48.5064, GNorm = 0.3524, lr_0 = 3.9493e-04
Validation prc-auc = 0.643237
Validation auc = 0.847090
Epoch 13
Loss = 1.2583e-01, PNorm = 48.5251, GNorm = 0.4910, lr_0 = 3.8625e-04
Loss = 1.4826e-01, PNorm = 48.5727, GNorm = 0.2912, lr_0 = 3.7776e-04
Loss = 1.4185e-01, PNorm = 48.6192, GNorm = 0.4629, lr_0 = 3.6946e-04
Loss = 1.3455e-01, PNorm = 48.6493, GNorm = 0.3031, lr_0 = 3.6134e-04
Validation prc-auc = 0.648342
Validation auc = 0.859788
Epoch 14
Loss = 1.1836e-01, PNorm = 48.6849, GNorm = 0.4203, lr_0 = 3.5340e-04
Loss = 1.4737e-01, PNorm = 48.7215, GNorm = 0.2313, lr_0 = 3.4563e-04
Loss = 1.3554e-01, PNorm = 48.7515, GNorm = 0.4225, lr_0 = 3.3803e-04
Validation prc-auc = 0.636464
Validation auc = 0.858730
Epoch 15
Loss = 1.1572e-01, PNorm = 48.7861, GNorm = 0.2639, lr_0 = 3.3060e-04
Loss = 1.4884e-01, PNorm = 48.8136, GNorm = 0.2467, lr_0 = 3.2333e-04
Loss = 1.0443e-01, PNorm = 48.8574, GNorm = 0.2120, lr_0 = 3.1623e-04
Loss = 1.1568e-01, PNorm = 48.8886, GNorm = 0.2915, lr_0 = 3.0928e-04
Validation prc-auc = 0.640850
Validation auc = 0.861199
Epoch 16
Loss = 1.2661e-01, PNorm = 48.9159, GNorm = 0.2446, lr_0 = 3.0248e-04
Loss = 1.4088e-01, PNorm = 48.9473, GNorm = 1.0229, lr_0 = 2.9583e-04
Loss = 1.2594e-01, PNorm = 48.9854, GNorm = 0.4869, lr_0 = 2.8933e-04
Loss = 1.0664e-01, PNorm = 49.0251, GNorm = 0.3427, lr_0 = 2.8297e-04
Validation prc-auc = 0.633137
Validation auc = 0.875661
Epoch 17
Loss = 8.2306e-02, PNorm = 49.0621, GNorm = 0.4905, lr_0 = 2.7675e-04
Loss = 1.0601e-01, PNorm = 49.0999, GNorm = 0.3481, lr_0 = 2.7067e-04
Loss = 1.4327e-01, PNorm = 49.1156, GNorm = 0.4266, lr_0 = 2.6472e-04
Loss = 1.2834e-01, PNorm = 49.1553, GNorm = 0.2017, lr_0 = 2.5890e-04
Validation prc-auc = 0.646564
Validation auc = 0.872134
Epoch 18
Loss = 1.1708e-01, PNorm = 49.1831, GNorm = 0.4754, lr_0 = 2.5321e-04
Loss = 9.4547e-02, PNorm = 49.2107, GNorm = 0.3219, lr_0 = 2.4764e-04
Loss = 7.9813e-02, PNorm = 49.2447, GNorm = 0.6185, lr_0 = 2.4220e-04
Loss = 1.4331e-01, PNorm = 49.2642, GNorm = 1.2325, lr_0 = 2.3687e-04
Validation prc-auc = 0.639665
Validation auc = 0.850617
Epoch 19
Loss = 1.0324e-01, PNorm = 49.3060, GNorm = 0.6689, lr_0 = 2.3167e-04
Loss = 1.0176e-01, PNorm = 49.3355, GNorm = 0.3645, lr_0 = 2.2658e-04
Loss = 1.3861e-01, PNorm = 49.3536, GNorm = 0.4098, lr_0 = 2.2159e-04
Validation prc-auc = 0.634287
Validation auc = 0.867196
Epoch 20
Loss = 6.5015e-02, PNorm = 49.3890, GNorm = 0.2801, lr_0 = 2.1672e-04
Loss = 1.0859e-01, PNorm = 49.4066, GNorm = 0.3714, lr_0 = 2.1196e-04
Loss = 9.9946e-02, PNorm = 49.4374, GNorm = 0.3968, lr_0 = 2.0730e-04
Loss = 1.0478e-01, PNorm = 49.4626, GNorm = 0.3041, lr_0 = 2.0274e-04
Validation prc-auc = 0.632972
Validation auc = 0.848148
Epoch 21
Loss = 1.4469e-01, PNorm = 49.4912, GNorm = 0.6909, lr_0 = 1.9829e-04
Loss = 1.1133e-01, PNorm = 49.5234, GNorm = 0.9159, lr_0 = 1.9393e-04
Loss = 9.0105e-02, PNorm = 49.5463, GNorm = 1.0588, lr_0 = 1.8967e-04
Loss = 7.7521e-02, PNorm = 49.5709, GNorm = 0.3186, lr_0 = 1.8550e-04
Validation prc-auc = 0.644182
Validation auc = 0.866138
Epoch 22
Loss = 9.7362e-02, PNorm = 49.5916, GNorm = 0.1956, lr_0 = 1.8142e-04
Loss = 1.0731e-01, PNorm = 49.6109, GNorm = 0.5274, lr_0 = 1.7743e-04
Loss = 9.4185e-02, PNorm = 49.6386, GNorm = 0.4797, lr_0 = 1.7353e-04
Loss = 8.3063e-02, PNorm = 49.6600, GNorm = 0.3549, lr_0 = 1.6972e-04
Validation prc-auc = 0.648367
Validation auc = 0.871252
Epoch 23
Loss = 7.5305e-02, PNorm = 49.6871, GNorm = 0.4939, lr_0 = 1.6599e-04
Loss = 1.1212e-01, PNorm = 49.6966, GNorm = 0.6276, lr_0 = 1.6234e-04
Loss = 7.6064e-02, PNorm = 49.7234, GNorm = 0.3783, lr_0 = 1.5877e-04
Loss = 7.3799e-02, PNorm = 49.7451, GNorm = 0.2034, lr_0 = 1.5528e-04
Validation prc-auc = 0.643813
Validation auc = 0.883422
Epoch 24
Loss = 8.5654e-02, PNorm = 49.7599, GNorm = 0.4160, lr_0 = 1.5187e-04
Loss = 9.1431e-02, PNorm = 49.7843, GNorm = 0.8514, lr_0 = 1.4853e-04
Loss = 8.2957e-02, PNorm = 49.8077, GNorm = 0.7366, lr_0 = 1.4527e-04
Validation prc-auc = 0.636523
Validation auc = 0.852557
Epoch 25
Loss = 1.4507e-01, PNorm = 49.8314, GNorm = 0.9238, lr_0 = 1.4207e-04
Loss = 6.1190e-02, PNorm = 49.8472, GNorm = 0.6783, lr_0 = 1.3895e-04
Loss = 7.5415e-02, PNorm = 49.8727, GNorm = 0.4769, lr_0 = 1.3590e-04
Loss = 9.0791e-02, PNorm = 49.8880, GNorm = 0.6832, lr_0 = 1.3291e-04
Validation prc-auc = 0.669827
Validation auc = 0.873721
Epoch 26
Loss = 5.1153e-02, PNorm = 49.9047, GNorm = 0.4832, lr_0 = 1.2999e-04
Loss = 9.0090e-02, PNorm = 49.9186, GNorm = 0.5404, lr_0 = 1.2713e-04
Loss = 9.4433e-02, PNorm = 49.9455, GNorm = 0.3267, lr_0 = 1.2434e-04
Loss = 5.7065e-02, PNorm = 49.9618, GNorm = 0.2056, lr_0 = 1.2160e-04
Validation prc-auc = 0.657799
Validation auc = 0.889594
Epoch 27
Loss = 5.1340e-02, PNorm = 49.9771, GNorm = 0.4564, lr_0 = 1.1893e-04
Loss = 8.8124e-02, PNorm = 49.9964, GNorm = 0.5874, lr_0 = 1.1632e-04
Loss = 8.5276e-02, PNorm = 50.0064, GNorm = 0.6030, lr_0 = 1.1376e-04
Loss = 7.4958e-02, PNorm = 50.0228, GNorm = 0.3665, lr_0 = 1.1126e-04
Validation prc-auc = 0.657312
Validation auc = 0.869841
Epoch 28
Loss = 5.1284e-02, PNorm = 50.0421, GNorm = 0.4207, lr_0 = 1.0881e-04
Loss = 6.8488e-02, PNorm = 50.0530, GNorm = 0.9183, lr_0 = 1.0642e-04
Loss = 7.7143e-02, PNorm = 50.0633, GNorm = 0.5894, lr_0 = 1.0408e-04
Loss = 7.9373e-02, PNorm = 50.0802, GNorm = 0.5031, lr_0 = 1.0179e-04
Validation prc-auc = 0.636554
Validation auc = 0.861552
Epoch 29
Loss = 7.2740e-02, PNorm = 50.0912, GNorm = 0.3733, lr_0 = 1.0000e-04
Loss = 7.8991e-02, PNorm = 50.1047, GNorm = 0.4473, lr_0 = 1.0000e-04
Loss = 6.4685e-02, PNorm = 50.1176, GNorm = 0.9946, lr_0 = 1.0000e-04
Validation prc-auc = 0.656946
Validation auc = 0.875485
Model 0 best validation prc-auc = 0.669827 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.393380
Model 0 test auc = 0.795723
Ensemble test prc-auc = 0.393380
Ensemble test auc = 0.795723
Fold 3
Splitting data with seed 3
Total scaffolds = 1,115 | train scaffolds = 840 | val scaffolds = 142 | test scaffolds = 133
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.4619e-01, PNorm = 46.0436, GNorm = 1.3222, lr_0 = 2.3378e-04
Loss = 2.2060e-01, PNorm = 46.0604, GNorm = 0.7717, lr_0 = 3.5541e-04
Loss = 2.2749e-01, PNorm = 46.0839, GNorm = 0.3685, lr_0 = 4.7703e-04
Validation prc-auc = 0.141429
Validation auc = 0.592781
Epoch 1
Loss = 1.5777e-01, PNorm = 46.1099, GNorm = 0.8113, lr_0 = 6.1081e-04
Loss = 2.0301e-01, PNorm = 46.1366, GNorm = 0.5371, lr_0 = 7.3243e-04
Loss = 2.3406e-01, PNorm = 46.1817, GNorm = 0.3322, lr_0 = 8.5405e-04
Loss = 1.7582e-01, PNorm = 46.2379, GNorm = 0.1990, lr_0 = 9.7568e-04
Validation prc-auc = 0.270464
Validation auc = 0.697594
Epoch 2
Loss = 2.0149e-01, PNorm = 46.3004, GNorm = 0.8918, lr_0 = 9.8238e-04
Loss = 2.1477e-01, PNorm = 46.3717, GNorm = 0.8251, lr_0 = 9.6078e-04
Loss = 1.6127e-01, PNorm = 46.4296, GNorm = 0.3989, lr_0 = 9.3966e-04
Loss = 2.0913e-01, PNorm = 46.5083, GNorm = 0.4574, lr_0 = 9.1901e-04
Validation prc-auc = 0.399340
Validation auc = 0.741444
Epoch 3
Loss = 2.1256e-01, PNorm = 46.5648, GNorm = 0.9730, lr_0 = 8.9881e-04
Loss = 1.7509e-01, PNorm = 46.6501, GNorm = 0.3619, lr_0 = 8.7905e-04
Loss = 1.6519e-01, PNorm = 46.7487, GNorm = 0.2415, lr_0 = 8.5973e-04
Loss = 1.8957e-01, PNorm = 46.8025, GNorm = 0.2836, lr_0 = 8.4083e-04
Validation prc-auc = 0.416768
Validation auc = 0.733957
Epoch 4
Loss = 1.8641e-01, PNorm = 46.8809, GNorm = 0.4303, lr_0 = 8.2235e-04
Loss = 1.5785e-01, PNorm = 46.9514, GNorm = 0.4595, lr_0 = 8.0428e-04
Loss = 1.5353e-01, PNorm = 47.0019, GNorm = 0.2498, lr_0 = 7.8660e-04
Validation prc-auc = 0.500117
Validation auc = 0.749465
Epoch 5
Loss = 1.3197e-01, PNorm = 47.0872, GNorm = 0.2883, lr_0 = 7.6931e-04
Loss = 1.7668e-01, PNorm = 47.1781, GNorm = 0.7038, lr_0 = 7.5240e-04
Loss = 1.7949e-01, PNorm = 47.2408, GNorm = 0.6318, lr_0 = 7.3586e-04
Loss = 1.3681e-01, PNorm = 47.3156, GNorm = 0.3273, lr_0 = 7.1969e-04
Validation prc-auc = 0.451370
Validation auc = 0.747594
Epoch 6
Loss = 5.7545e-02, PNorm = 47.3880, GNorm = 0.1779, lr_0 = 7.0387e-04
Loss = 1.7086e-01, PNorm = 47.4713, GNorm = 0.3850, lr_0 = 6.8840e-04
Loss = 1.3028e-01, PNorm = 47.5735, GNorm = 0.5377, lr_0 = 6.7326e-04
Loss = 1.8753e-01, PNorm = 47.6354, GNorm = 0.2576, lr_0 = 6.5847e-04
Validation prc-auc = 0.526918
Validation auc = 0.699465
Epoch 7
Loss = 1.2472e-01, PNorm = 47.7049, GNorm = 0.1864, lr_0 = 6.4399e-04
Loss = 1.6685e-01, PNorm = 47.7702, GNorm = 0.4086, lr_0 = 6.2984e-04
Loss = 1.4573e-01, PNorm = 47.8101, GNorm = 0.3363, lr_0 = 6.1599e-04
Loss = 1.4265e-01, PNorm = 47.8962, GNorm = 0.4812, lr_0 = 6.0245e-04
Validation prc-auc = 0.274738
Validation auc = 0.742513
Epoch 8
Loss = 2.0664e-01, PNorm = 47.9516, GNorm = 0.4128, lr_0 = 5.8921e-04
Loss = 1.6764e-01, PNorm = 48.0167, GNorm = 0.2173, lr_0 = 5.7626e-04
Loss = 1.1735e-01, PNorm = 48.0669, GNorm = 0.2600, lr_0 = 5.6359e-04
Loss = 1.1893e-01, PNorm = 48.1253, GNorm = 0.3606, lr_0 = 5.5120e-04
Validation prc-auc = 0.507859
Validation auc = 0.739037
Epoch 9
Loss = 1.2560e-01, PNorm = 48.1748, GNorm = 0.3740, lr_0 = 5.3909e-04
Loss = 1.4499e-01, PNorm = 48.2232, GNorm = 0.5357, lr_0 = 5.2724e-04
Loss = 1.8088e-01, PNorm = 48.2487, GNorm = 0.4220, lr_0 = 5.1565e-04
Validation prc-auc = 0.538647
Validation auc = 0.734759
Epoch 10
Loss = 1.0675e-01, PNorm = 48.3057, GNorm = 0.5173, lr_0 = 5.0432e-04
Loss = 1.1397e-01, PNorm = 48.3496, GNorm = 0.3626, lr_0 = 4.9323e-04
Loss = 9.9096e-02, PNorm = 48.4143, GNorm = 0.4326, lr_0 = 4.8239e-04
Loss = 1.8062e-01, PNorm = 48.4382, GNorm = 0.2685, lr_0 = 4.7179e-04
Validation prc-auc = 0.567651
Validation auc = 0.720856
Epoch 11
Loss = 5.7193e-02, PNorm = 48.4714, GNorm = 0.2060, lr_0 = 4.6142e-04
Loss = 1.1447e-01, PNorm = 48.5095, GNorm = 0.3020, lr_0 = 4.5127e-04
Loss = 1.5179e-01, PNorm = 48.5412, GNorm = 0.4230, lr_0 = 4.4135e-04
Loss = 1.2972e-01, PNorm = 48.5932, GNorm = 0.5863, lr_0 = 4.3165e-04
Validation prc-auc = 0.556387
Validation auc = 0.693850
Epoch 12
Loss = 1.9203e-01, PNorm = 48.6264, GNorm = 0.2040, lr_0 = 4.2217e-04
Loss = 1.0306e-01, PNorm = 48.6699, GNorm = 0.3537, lr_0 = 4.1289e-04
Loss = 1.2155e-01, PNorm = 48.7026, GNorm = 0.6485, lr_0 = 4.0381e-04
Loss = 1.2542e-01, PNorm = 48.7418, GNorm = 0.4853, lr_0 = 3.9493e-04
Validation prc-auc = 0.530024
Validation auc = 0.724064
Epoch 13
Loss = 7.2776e-02, PNorm = 48.7885, GNorm = 0.2445, lr_0 = 3.8625e-04
Loss = 1.3254e-01, PNorm = 48.8181, GNorm = 0.6229, lr_0 = 3.7776e-04
Loss = 1.0795e-01, PNorm = 48.8659, GNorm = 0.9113, lr_0 = 3.6946e-04
Loss = 1.4565e-01, PNorm = 48.8856, GNorm = 1.1533, lr_0 = 3.6134e-04
Validation prc-auc = 0.559882
Validation auc = 0.695722
Epoch 14
Loss = 1.1241e-01, PNorm = 48.9419, GNorm = 0.4839, lr_0 = 3.5340e-04
Loss = 1.3069e-01, PNorm = 48.9751, GNorm = 0.6252, lr_0 = 3.4563e-04
Loss = 1.1841e-01, PNorm = 49.0223, GNorm = 0.2233, lr_0 = 3.3803e-04
Validation prc-auc = 0.526252
Validation auc = 0.705080
Epoch 15
Loss = 1.2328e-01, PNorm = 49.0494, GNorm = 0.4186, lr_0 = 3.3060e-04
Loss = 1.0914e-01, PNorm = 49.0821, GNorm = 0.2158, lr_0 = 3.2333e-04
Loss = 1.3002e-01, PNorm = 49.1284, GNorm = 0.2946, lr_0 = 3.1623e-04
Loss = 1.1411e-01, PNorm = 49.1542, GNorm = 0.5374, lr_0 = 3.0928e-04
Validation prc-auc = 0.552528
Validation auc = 0.666845
Epoch 16
Loss = 5.2040e-02, PNorm = 49.1917, GNorm = 0.3502, lr_0 = 3.0248e-04
Loss = 1.1080e-01, PNorm = 49.2178, GNorm = 0.3715, lr_0 = 2.9583e-04
Loss = 1.1275e-01, PNorm = 49.2589, GNorm = 0.9208, lr_0 = 2.8933e-04
Loss = 1.0023e-01, PNorm = 49.2761, GNorm = 0.6713, lr_0 = 2.8297e-04
Validation prc-auc = 0.551150
Validation auc = 0.689572
Epoch 17
Loss = 9.5368e-02, PNorm = 49.3093, GNorm = 0.3275, lr_0 = 2.7675e-04
Loss = 1.1025e-01, PNorm = 49.3479, GNorm = 0.6652, lr_0 = 2.7067e-04
Loss = 8.9409e-02, PNorm = 49.3833, GNorm = 0.3434, lr_0 = 2.6472e-04
Loss = 1.1914e-01, PNorm = 49.4020, GNorm = 0.4826, lr_0 = 2.5890e-04
Validation prc-auc = 0.533586
Validation auc = 0.677540
Epoch 18
Loss = 8.9673e-02, PNorm = 49.4373, GNorm = 0.5294, lr_0 = 2.5321e-04
Loss = 1.0930e-01, PNorm = 49.4607, GNorm = 0.2518, lr_0 = 2.4764e-04
Loss = 9.5884e-02, PNorm = 49.4930, GNorm = 0.3202, lr_0 = 2.4220e-04
Loss = 1.0965e-01, PNorm = 49.5202, GNorm = 0.5919, lr_0 = 2.3687e-04
Validation prc-auc = 0.532403
Validation auc = 0.685027
Epoch 19
Loss = 8.6178e-02, PNorm = 49.5483, GNorm = 0.3142, lr_0 = 2.3167e-04
Loss = 1.1031e-01, PNorm = 49.5816, GNorm = 0.2680, lr_0 = 2.2658e-04
Loss = 7.1023e-02, PNorm = 49.6125, GNorm = 0.5846, lr_0 = 2.2159e-04
Validation prc-auc = 0.502756
Validation auc = 0.679947
Epoch 20
Loss = 9.5560e-02, PNorm = 49.6352, GNorm = 0.7712, lr_0 = 2.1672e-04
Loss = 9.4565e-02, PNorm = 49.6499, GNorm = 0.4710, lr_0 = 2.1196e-04
Loss = 9.3387e-02, PNorm = 49.6774, GNorm = 0.3971, lr_0 = 2.0730e-04
Loss = 9.0154e-02, PNorm = 49.7149, GNorm = 0.3844, lr_0 = 2.0274e-04
Validation prc-auc = 0.510050
Validation auc = 0.684759
Epoch 21
Loss = 7.6051e-02, PNorm = 49.7351, GNorm = 0.3927, lr_0 = 1.9829e-04
Loss = 1.0577e-01, PNorm = 49.7603, GNorm = 0.6563, lr_0 = 1.9393e-04
Loss = 6.3719e-02, PNorm = 49.7925, GNorm = 0.3518, lr_0 = 1.8967e-04
Loss = 8.0584e-02, PNorm = 49.8180, GNorm = 0.2800, lr_0 = 1.8550e-04
Validation prc-auc = 0.494371
Validation auc = 0.686631
Epoch 22
Loss = 6.4722e-02, PNorm = 49.8378, GNorm = 0.3784, lr_0 = 1.8142e-04
Loss = 1.0635e-01, PNorm = 49.8627, GNorm = 0.8589, lr_0 = 1.7743e-04
Loss = 7.7960e-02, PNorm = 49.8858, GNorm = 0.4390, lr_0 = 1.7353e-04
Loss = 7.7043e-02, PNorm = 49.9159, GNorm = 0.5670, lr_0 = 1.6972e-04
Validation prc-auc = 0.489857
Validation auc = 0.695722
Epoch 23
Loss = 1.0451e-01, PNorm = 49.9279, GNorm = 0.4076, lr_0 = 1.6599e-04
Loss = 9.4850e-02, PNorm = 49.9507, GNorm = 1.4854, lr_0 = 1.6234e-04
Loss = 9.0233e-02, PNorm = 49.9644, GNorm = 1.0243, lr_0 = 1.5877e-04
Loss = 8.8518e-02, PNorm = 49.9838, GNorm = 0.7012, lr_0 = 1.5528e-04
Validation prc-auc = 0.511317
Validation auc = 0.682888
Epoch 24
Loss = 7.9881e-02, PNorm = 50.0038, GNorm = 0.5210, lr_0 = 1.5187e-04
Loss = 8.3056e-02, PNorm = 50.0232, GNorm = 0.7150, lr_0 = 1.4853e-04
Loss = 6.1779e-02, PNorm = 50.0373, GNorm = 0.2061, lr_0 = 1.4527e-04
Validation prc-auc = 0.498670
Validation auc = 0.685829
Epoch 25
Loss = 1.7018e-02, PNorm = 50.0533, GNorm = 0.2278, lr_0 = 1.4207e-04
Loss = 6.1552e-02, PNorm = 50.0692, GNorm = 0.6863, lr_0 = 1.3895e-04
Loss = 5.8111e-02, PNorm = 50.0853, GNorm = 0.5452, lr_0 = 1.3590e-04
Loss = 1.0349e-01, PNorm = 50.0967, GNorm = 0.3622, lr_0 = 1.3291e-04
Validation prc-auc = 0.499758
Validation auc = 0.695187
Epoch 26
Loss = 7.6361e-02, PNorm = 50.1190, GNorm = 0.3806, lr_0 = 1.2999e-04
Loss = 6.4578e-02, PNorm = 50.1290, GNorm = 0.3875, lr_0 = 1.2713e-04
Loss = 6.5117e-02, PNorm = 50.1481, GNorm = 0.4159, lr_0 = 1.2434e-04
Loss = 6.3917e-02, PNorm = 50.1597, GNorm = 0.9210, lr_0 = 1.2160e-04
Validation prc-auc = 0.510154
Validation auc = 0.709626
Epoch 27
Loss = 6.9387e-02, PNorm = 50.1726, GNorm = 0.4894, lr_0 = 1.1893e-04
Loss = 6.4941e-02, PNorm = 50.1938, GNorm = 1.3139, lr_0 = 1.1632e-04
Loss = 6.8663e-02, PNorm = 50.1991, GNorm = 1.1694, lr_0 = 1.1376e-04
Loss = 7.7317e-02, PNorm = 50.2211, GNorm = 0.7016, lr_0 = 1.1126e-04
Validation prc-auc = 0.486708
Validation auc = 0.706684
Epoch 28
Loss = 8.0803e-02, PNorm = 50.2278, GNorm = 0.3568, lr_0 = 1.0881e-04
Loss = 4.8904e-02, PNorm = 50.2410, GNorm = 0.6232, lr_0 = 1.0642e-04
Loss = 6.0313e-02, PNorm = 50.2576, GNorm = 0.3383, lr_0 = 1.0408e-04
Loss = 6.6743e-02, PNorm = 50.2706, GNorm = 0.7689, lr_0 = 1.0179e-04
Validation prc-auc = 0.503984
Validation auc = 0.704813
Epoch 29
Loss = 6.3740e-02, PNorm = 50.2808, GNorm = 0.4509, lr_0 = 1.0000e-04
Loss = 7.2782e-02, PNorm = 50.2903, GNorm = 0.3811, lr_0 = 1.0000e-04
Loss = 4.0831e-02, PNorm = 50.3063, GNorm = 0.4509, lr_0 = 1.0000e-04
Validation prc-auc = 0.480429
Validation auc = 0.706150
Model 0 best validation prc-auc = 0.567651 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.448054
Model 0 test auc = 0.791456
Ensemble test prc-auc = 0.448054
Ensemble test auc = 0.791456
Fold 4
Splitting data with seed 4
Total scaffolds = 1,115 | train scaffolds = 834 | val scaffolds = 149 | test scaffolds = 132
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.1731e-01, PNorm = 46.0445, GNorm = 0.4470, lr_0 = 2.3378e-04
Loss = 2.2620e-01, PNorm = 46.0605, GNorm = 0.6158, lr_0 = 3.5541e-04
Loss = 2.7828e-01, PNorm = 46.0837, GNorm = 0.5548, lr_0 = 4.7703e-04
Validation prc-auc = 0.349992
Validation auc = 0.698663
Epoch 1
Loss = 2.2771e-01, PNorm = 46.1178, GNorm = 0.2416, lr_0 = 6.1081e-04
Loss = 2.1344e-01, PNorm = 46.1500, GNorm = 0.1757, lr_0 = 7.3243e-04
Loss = 1.7965e-01, PNorm = 46.1873, GNorm = 0.6756, lr_0 = 8.5405e-04
Loss = 2.3965e-01, PNorm = 46.2318, GNorm = 0.9479, lr_0 = 9.7568e-04
Validation prc-auc = 0.409371
Validation auc = 0.803209
Epoch 2
Loss = 1.4471e-01, PNorm = 46.3319, GNorm = 0.2760, lr_0 = 9.8238e-04
Loss = 2.5366e-01, PNorm = 46.4100, GNorm = 0.3022, lr_0 = 9.6078e-04
Loss = 1.7452e-01, PNorm = 46.4787, GNorm = 0.3244, lr_0 = 9.3966e-04
Loss = 1.7482e-01, PNorm = 46.5626, GNorm = 1.1008, lr_0 = 9.1901e-04
Validation prc-auc = 0.406502
Validation auc = 0.779144
Epoch 3
Loss = 1.7041e-01, PNorm = 46.6512, GNorm = 0.3923, lr_0 = 8.9881e-04
Loss = 1.7515e-01, PNorm = 46.7276, GNorm = 0.4378, lr_0 = 8.7905e-04
Loss = 1.9748e-01, PNorm = 46.7966, GNorm = 0.2663, lr_0 = 8.5973e-04
Loss = 1.8120e-01, PNorm = 46.8925, GNorm = 0.7428, lr_0 = 8.4083e-04
Validation prc-auc = 0.416019
Validation auc = 0.837968
Epoch 4
Loss = 1.6730e-01, PNorm = 46.9389, GNorm = 0.2754, lr_0 = 8.2235e-04
Loss = 1.8067e-01, PNorm = 47.0108, GNorm = 0.4173, lr_0 = 8.0428e-04
Loss = 1.8131e-01, PNorm = 47.0999, GNorm = 0.4504, lr_0 = 7.8660e-04
Validation prc-auc = 0.513714
Validation auc = 0.812032
Epoch 5
Loss = 9.9685e-02, PNorm = 47.1744, GNorm = 0.2682, lr_0 = 7.6931e-04
Loss = 1.7968e-01, PNorm = 47.2331, GNorm = 0.3341, lr_0 = 7.5240e-04
Loss = 1.6918e-01, PNorm = 47.2860, GNorm = 0.1458, lr_0 = 7.3586e-04
Loss = 1.5611e-01, PNorm = 47.3410, GNorm = 0.1588, lr_0 = 7.1969e-04
Validation prc-auc = 0.479852
Validation auc = 0.801337
Epoch 6
Loss = 1.5147e-01, PNorm = 47.3990, GNorm = 0.3281, lr_0 = 7.0387e-04
Loss = 1.7571e-01, PNorm = 47.4573, GNorm = 0.3118, lr_0 = 6.8840e-04
Loss = 1.8899e-01, PNorm = 47.5319, GNorm = 0.3365, lr_0 = 6.7326e-04
Loss = 1.5204e-01, PNorm = 47.6045, GNorm = 0.2040, lr_0 = 6.5847e-04
Validation prc-auc = 0.496488
Validation auc = 0.793850
Epoch 7
Loss = 1.3824e-01, PNorm = 47.6768, GNorm = 0.5047, lr_0 = 6.4399e-04
Loss = 1.5439e-01, PNorm = 47.7207, GNorm = 0.3589, lr_0 = 6.2984e-04
Loss = 1.3750e-01, PNorm = 47.7914, GNorm = 0.4267, lr_0 = 6.1599e-04
Loss = 1.7144e-01, PNorm = 47.8507, GNorm = 0.2346, lr_0 = 6.0245e-04
Validation prc-auc = 0.570178
Validation auc = 0.786631
Epoch 8
Loss = 1.4824e-01, PNorm = 47.9083, GNorm = 0.3040, lr_0 = 5.8921e-04
Loss = 1.6187e-01, PNorm = 47.9624, GNorm = 0.3401, lr_0 = 5.7626e-04
Loss = 1.4918e-01, PNorm = 48.0193, GNorm = 0.6767, lr_0 = 5.6359e-04
Loss = 1.3619e-01, PNorm = 48.0618, GNorm = 0.4556, lr_0 = 5.5120e-04
Validation prc-auc = 0.539505
Validation auc = 0.813636
Epoch 9
Loss = 1.1821e-01, PNorm = 48.1179, GNorm = 0.1491, lr_0 = 5.3909e-04
Loss = 1.3975e-01, PNorm = 48.1631, GNorm = 0.4903, lr_0 = 5.2724e-04
Loss = 1.3988e-01, PNorm = 48.2221, GNorm = 0.4583, lr_0 = 5.1565e-04
Validation prc-auc = 0.536617
Validation auc = 0.808021
Epoch 10
Loss = 8.6622e-02, PNorm = 48.2832, GNorm = 0.4854, lr_0 = 5.0432e-04
Loss = 1.4107e-01, PNorm = 48.3359, GNorm = 0.6076, lr_0 = 4.9323e-04
Loss = 1.2703e-01, PNorm = 48.3824, GNorm = 0.4818, lr_0 = 4.8239e-04
Loss = 1.3180e-01, PNorm = 48.4242, GNorm = 0.5192, lr_0 = 4.7179e-04
Validation prc-auc = 0.551413
Validation auc = 0.788503
Epoch 11
Loss = 9.8096e-02, PNorm = 48.4720, GNorm = 0.2605, lr_0 = 4.6142e-04
Loss = 1.1720e-01, PNorm = 48.5078, GNorm = 0.3134, lr_0 = 4.5127e-04
Loss = 1.5118e-01, PNorm = 48.5590, GNorm = 0.9186, lr_0 = 4.4135e-04
Loss = 1.2275e-01, PNorm = 48.6081, GNorm = 0.3103, lr_0 = 4.3165e-04
Validation prc-auc = 0.534427
Validation auc = 0.802941
Epoch 12
Loss = 6.8958e-02, PNorm = 48.6626, GNorm = 0.1771, lr_0 = 4.2217e-04
Loss = 1.3941e-01, PNorm = 48.7000, GNorm = 1.3975, lr_0 = 4.1289e-04
Loss = 1.3571e-01, PNorm = 48.7465, GNorm = 0.6746, lr_0 = 4.0381e-04
Loss = 1.2691e-01, PNorm = 48.7961, GNorm = 0.2769, lr_0 = 3.9493e-04
Validation prc-auc = 0.512833
Validation auc = 0.762567
Epoch 13
Loss = 1.1455e-01, PNorm = 48.8407, GNorm = 0.9793, lr_0 = 3.8625e-04
Loss = 1.1553e-01, PNorm = 48.8886, GNorm = 0.4374, lr_0 = 3.7776e-04
Loss = 1.4185e-01, PNorm = 48.9194, GNorm = 0.6386, lr_0 = 3.6946e-04
Loss = 1.0721e-01, PNorm = 48.9778, GNorm = 0.5185, lr_0 = 3.6134e-04
Validation prc-auc = 0.533300
Validation auc = 0.773262
Epoch 14
Loss = 8.8060e-02, PNorm = 49.0093, GNorm = 0.5409, lr_0 = 3.5340e-04
Loss = 1.1456e-01, PNorm = 49.0373, GNorm = 0.5183, lr_0 = 3.4563e-04
Loss = 1.2793e-01, PNorm = 49.0733, GNorm = 0.4287, lr_0 = 3.3803e-04
Validation prc-auc = 0.567801
Validation auc = 0.783690
Epoch 15
Loss = 4.3015e-02, PNorm = 49.1206, GNorm = 0.2094, lr_0 = 3.3060e-04
Loss = 1.0164e-01, PNorm = 49.1436, GNorm = 0.4124, lr_0 = 3.2333e-04
Loss = 1.0548e-01, PNorm = 49.1866, GNorm = 0.4294, lr_0 = 3.1623e-04
Loss = 1.2167e-01, PNorm = 49.2171, GNorm = 0.3321, lr_0 = 3.0928e-04
Validation prc-auc = 0.459195
Validation auc = 0.754813
Epoch 16
Loss = 1.1913e-01, PNorm = 49.2510, GNorm = 0.4103, lr_0 = 3.0248e-04
Loss = 7.4124e-02, PNorm = 49.2823, GNorm = 0.2684, lr_0 = 2.9583e-04
Loss = 1.3173e-01, PNorm = 49.3091, GNorm = 0.7374, lr_0 = 2.8933e-04
Loss = 1.1411e-01, PNorm = 49.3400, GNorm = 0.2696, lr_0 = 2.8297e-04
Validation prc-auc = 0.499834
Validation auc = 0.769519
Epoch 17
Loss = 8.9378e-02, PNorm = 49.3828, GNorm = 0.8101, lr_0 = 2.7675e-04
Loss = 1.0806e-01, PNorm = 49.4047, GNorm = 0.3474, lr_0 = 2.7067e-04
Loss = 1.0144e-01, PNorm = 49.4381, GNorm = 0.1539, lr_0 = 2.6472e-04
Loss = 1.0092e-01, PNorm = 49.4640, GNorm = 0.7314, lr_0 = 2.5890e-04
Validation prc-auc = 0.489936
Validation auc = 0.771123
Epoch 18
Loss = 9.9862e-02, PNorm = 49.4854, GNorm = 0.4690, lr_0 = 2.5321e-04
Loss = 7.8726e-02, PNorm = 49.5304, GNorm = 0.3281, lr_0 = 2.4764e-04
Loss = 1.1252e-01, PNorm = 49.5507, GNorm = 0.3581, lr_0 = 2.4220e-04
Loss = 9.2238e-02, PNorm = 49.5804, GNorm = 0.3944, lr_0 = 2.3687e-04
Validation prc-auc = 0.406221
Validation auc = 0.756417
Epoch 19
Loss = 8.4146e-02, PNorm = 49.6099, GNorm = 0.8355, lr_0 = 2.3167e-04
Loss = 1.1035e-01, PNorm = 49.6389, GNorm = 0.5598, lr_0 = 2.2658e-04
Loss = 9.7403e-02, PNorm = 49.6709, GNorm = 0.5258, lr_0 = 2.2159e-04
Validation prc-auc = 0.458554
Validation auc = 0.750535
Epoch 20
Loss = 8.3442e-02, PNorm = 49.6988, GNorm = 0.2527, lr_0 = 2.1672e-04
Loss = 8.2568e-02, PNorm = 49.7129, GNorm = 0.4479, lr_0 = 2.1196e-04
Loss = 9.7032e-02, PNorm = 49.7417, GNorm = 0.8545, lr_0 = 2.0730e-04
Loss = 7.3276e-02, PNorm = 49.7663, GNorm = 0.4739, lr_0 = 2.0274e-04
Validation prc-auc = 0.476123
Validation auc = 0.789305
Epoch 21
Loss = 7.4122e-02, PNorm = 49.7907, GNorm = 0.7035, lr_0 = 1.9829e-04
Loss = 7.7292e-02, PNorm = 49.8093, GNorm = 1.1022, lr_0 = 1.9393e-04
Loss = 1.0808e-01, PNorm = 49.8366, GNorm = 0.8037, lr_0 = 1.8967e-04
Loss = 5.5721e-02, PNorm = 49.8607, GNorm = 0.3116, lr_0 = 1.8550e-04
Validation prc-auc = 0.508942
Validation auc = 0.776471
Epoch 22
Loss = 1.4203e-01, PNorm = 49.8794, GNorm = 0.7785, lr_0 = 1.8142e-04
Loss = 5.4971e-02, PNorm = 49.9045, GNorm = 0.2255, lr_0 = 1.7743e-04
Loss = 6.0534e-02, PNorm = 49.9258, GNorm = 0.3698, lr_0 = 1.7353e-04
Loss = 7.1463e-02, PNorm = 49.9433, GNorm = 0.2337, lr_0 = 1.6972e-04
Validation prc-auc = 0.444834
Validation auc = 0.767914
Epoch 23
Loss = 4.5114e-02, PNorm = 49.9585, GNorm = 0.5354, lr_0 = 1.6599e-04
Loss = 8.9193e-02, PNorm = 49.9778, GNorm = 0.6460, lr_0 = 1.6234e-04
Loss = 7.6220e-02, PNorm = 50.0002, GNorm = 0.4306, lr_0 = 1.5877e-04
Loss = 6.8950e-02, PNorm = 50.0273, GNorm = 0.8255, lr_0 = 1.5528e-04
Validation prc-auc = 0.476500
Validation auc = 0.754011
Epoch 24
Loss = 7.5252e-02, PNorm = 50.0388, GNorm = 0.2189, lr_0 = 1.5187e-04
Loss = 7.5457e-02, PNorm = 50.0614, GNorm = 0.2610, lr_0 = 1.4853e-04
Loss = 8.1055e-02, PNorm = 50.0792, GNorm = 0.1632, lr_0 = 1.4527e-04
Validation prc-auc = 0.461311
Validation auc = 0.774599
Epoch 25
Loss = 2.7388e-02, PNorm = 50.0939, GNorm = 0.2557, lr_0 = 1.4207e-04
Loss = 5.9704e-02, PNorm = 50.1114, GNorm = 0.3015, lr_0 = 1.3895e-04
Loss = 5.9018e-02, PNorm = 50.1262, GNorm = 1.1728, lr_0 = 1.3590e-04
Loss = 7.9126e-02, PNorm = 50.1380, GNorm = 0.9459, lr_0 = 1.3291e-04
Validation prc-auc = 0.405513
Validation auc = 0.762834
Epoch 26
Loss = 7.4060e-02, PNorm = 50.1507, GNorm = 0.3746, lr_0 = 1.2999e-04
Loss = 7.6386e-02, PNorm = 50.1682, GNorm = 0.1635, lr_0 = 1.2713e-04
Loss = 6.8744e-02, PNorm = 50.1820, GNorm = 0.2730, lr_0 = 1.2434e-04
Loss = 5.7221e-02, PNorm = 50.2045, GNorm = 0.7088, lr_0 = 1.2160e-04
Validation prc-auc = 0.417561
Validation auc = 0.745455
Epoch 27
Loss = 6.4914e-02, PNorm = 50.2114, GNorm = 0.3809, lr_0 = 1.1893e-04
Loss = 6.3047e-02, PNorm = 50.2258, GNorm = 0.8220, lr_0 = 1.1632e-04
Loss = 6.9203e-02, PNorm = 50.2407, GNorm = 0.6817, lr_0 = 1.1376e-04
Loss = 5.1300e-02, PNorm = 50.2488, GNorm = 0.4410, lr_0 = 1.1126e-04
Validation prc-auc = 0.392706
Validation auc = 0.768449
Epoch 28
Loss = 3.7329e-02, PNorm = 50.2646, GNorm = 0.1766, lr_0 = 1.0881e-04
Loss = 6.5413e-02, PNorm = 50.2685, GNorm = 0.7586, lr_0 = 1.0642e-04
Loss = 6.6417e-02, PNorm = 50.2860, GNorm = 0.4935, lr_0 = 1.0408e-04
Loss = 6.0075e-02, PNorm = 50.2977, GNorm = 0.4534, lr_0 = 1.0179e-04
Validation prc-auc = 0.392772
Validation auc = 0.750802
Epoch 29
Loss = 5.9543e-02, PNorm = 50.3082, GNorm = 1.8881, lr_0 = 1.0000e-04
Loss = 6.1467e-02, PNorm = 50.3199, GNorm = 1.9738, lr_0 = 1.0000e-04
Loss = 6.9023e-02, PNorm = 50.3353, GNorm = 0.3401, lr_0 = 1.0000e-04
Validation prc-auc = 0.381117
Validation auc = 0.758824
Model 0 best validation prc-auc = 0.570178 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.487867
Model 0 test auc = 0.866071
Ensemble test prc-auc = 0.487867
Ensemble test auc = 0.866071
Fold 5
Splitting data with seed 5
Total scaffolds = 1,115 | train scaffolds = 839 | val scaffolds = 131 | test scaffolds = 145
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.8571e-01, PNorm = 46.0429, GNorm = 1.2904, lr_0 = 2.3378e-04
Loss = 2.1398e-01, PNorm = 46.0581, GNorm = 0.3106, lr_0 = 3.5541e-04
Loss = 1.9690e-01, PNorm = 46.0838, GNorm = 0.4536, lr_0 = 4.7703e-04
Validation prc-auc = 0.161576
Validation auc = 0.577378
Epoch 1
Loss = 1.6365e-01, PNorm = 46.1065, GNorm = 0.5679, lr_0 = 6.1081e-04
Loss = 1.5662e-01, PNorm = 46.1361, GNorm = 0.2843, lr_0 = 7.3243e-04
Loss = 1.7499e-01, PNorm = 46.1694, GNorm = 0.1551, lr_0 = 8.5405e-04
Loss = 2.2411e-01, PNorm = 46.2140, GNorm = 0.8169, lr_0 = 9.7568e-04
Validation prc-auc = 0.240410
Validation auc = 0.664271
Epoch 2
Loss = 1.2261e-01, PNorm = 46.2859, GNorm = 0.2887, lr_0 = 9.8238e-04
Loss = 2.0449e-01, PNorm = 46.3516, GNorm = 0.9039, lr_0 = 9.6078e-04
Loss = 1.6531e-01, PNorm = 46.4272, GNorm = 0.3837, lr_0 = 9.3966e-04
Loss = 1.7520e-01, PNorm = 46.5125, GNorm = 0.6699, lr_0 = 9.1901e-04
Validation prc-auc = 0.266783
Validation auc = 0.697886
Epoch 3
Loss = 1.5783e-01, PNorm = 46.5702, GNorm = 0.5172, lr_0 = 8.9881e-04
Loss = 1.1394e-01, PNorm = 46.6458, GNorm = 0.1925, lr_0 = 8.7905e-04
Loss = 1.7854e-01, PNorm = 46.7093, GNorm = 1.1323, lr_0 = 8.5973e-04
Loss = 1.9082e-01, PNorm = 46.7758, GNorm = 0.2475, lr_0 = 8.4083e-04
Validation prc-auc = 0.346446
Validation auc = 0.741649
Epoch 4
Loss = 1.6701e-01, PNorm = 46.8561, GNorm = 0.3751, lr_0 = 8.2235e-04
Loss = 1.2462e-01, PNorm = 46.9265, GNorm = 0.2922, lr_0 = 8.0428e-04
Loss = 1.7729e-01, PNorm = 47.0091, GNorm = 0.1703, lr_0 = 7.8660e-04
Validation prc-auc = 0.294674
Validation auc = 0.717759
Epoch 5
Loss = 8.5585e-02, PNorm = 47.0718, GNorm = 0.6723, lr_0 = 7.6931e-04
Loss = 1.3305e-01, PNorm = 47.1429, GNorm = 0.3897, lr_0 = 7.5240e-04
Loss = 1.4873e-01, PNorm = 47.2100, GNorm = 1.0151, lr_0 = 7.3586e-04
Loss = 1.8047e-01, PNorm = 47.2922, GNorm = 0.3702, lr_0 = 7.1969e-04
Validation prc-auc = 0.346855
Validation auc = 0.687738
Epoch 6
Loss = 1.5877e-01, PNorm = 47.4057, GNorm = 1.4190, lr_0 = 7.0387e-04
Loss = 1.8404e-01, PNorm = 47.4457, GNorm = 0.1680, lr_0 = 6.8840e-04
Loss = 1.4654e-01, PNorm = 47.5294, GNorm = 0.2506, lr_0 = 6.7326e-04
Loss = 1.4317e-01, PNorm = 47.6196, GNorm = 0.6742, lr_0 = 6.5847e-04
Validation prc-auc = 0.374566
Validation auc = 0.728330
Epoch 7
Loss = 1.2721e-01, PNorm = 47.6792, GNorm = 0.6710, lr_0 = 6.4399e-04
Loss = 1.2123e-01, PNorm = 47.7486, GNorm = 0.3892, lr_0 = 6.2984e-04
Loss = 1.3000e-01, PNorm = 47.7865, GNorm = 0.3444, lr_0 = 6.1599e-04
Loss = 1.4441e-01, PNorm = 47.8430, GNorm = 0.6218, lr_0 = 6.0245e-04
Validation prc-auc = 0.267776
Validation auc = 0.699154
Epoch 8
Loss = 1.0184e-01, PNorm = 47.9026, GNorm = 0.4058, lr_0 = 5.8921e-04
Loss = 1.2311e-01, PNorm = 47.9577, GNorm = 0.5430, lr_0 = 5.7626e-04
Loss = 1.2200e-01, PNorm = 48.0158, GNorm = 0.4333, lr_0 = 5.6359e-04
Loss = 1.7633e-01, PNorm = 48.0702, GNorm = 1.2542, lr_0 = 5.5120e-04
Validation prc-auc = 0.368377
Validation auc = 0.737844
Epoch 9
Loss = 1.5444e-01, PNorm = 48.1257, GNorm = 0.8659, lr_0 = 5.3909e-04
Loss = 1.1219e-01, PNorm = 48.1816, GNorm = 0.3763, lr_0 = 5.2724e-04
Loss = 1.0008e-01, PNorm = 48.2298, GNorm = 0.3766, lr_0 = 5.1565e-04
Validation prc-auc = 0.389730
Validation auc = 0.724947
Epoch 10
Loss = 1.1203e-01, PNorm = 48.2607, GNorm = 0.4105, lr_0 = 5.0432e-04
Loss = 1.2905e-01, PNorm = 48.3047, GNorm = 0.1972, lr_0 = 4.9323e-04
Loss = 1.1750e-01, PNorm = 48.3593, GNorm = 0.6971, lr_0 = 4.8239e-04
Loss = 1.4076e-01, PNorm = 48.4008, GNorm = 0.3802, lr_0 = 4.7179e-04
Validation prc-auc = 0.433909
Validation auc = 0.739112
Epoch 11
Loss = 1.9869e-01, PNorm = 48.4512, GNorm = 1.0476, lr_0 = 4.6142e-04
Loss = 1.4822e-01, PNorm = 48.5168, GNorm = 0.3692, lr_0 = 4.5127e-04
Loss = 9.4925e-02, PNorm = 48.5778, GNorm = 0.2053, lr_0 = 4.4135e-04
Loss = 1.0595e-01, PNorm = 48.6187, GNorm = 0.1717, lr_0 = 4.3165e-04
Validation prc-auc = 0.398388
Validation auc = 0.747780
Epoch 12
Loss = 9.8700e-02, PNorm = 48.6439, GNorm = 0.3990, lr_0 = 4.2217e-04
Loss = 8.4378e-02, PNorm = 48.7071, GNorm = 0.1629, lr_0 = 4.1289e-04
Loss = 1.5351e-01, PNorm = 48.7295, GNorm = 0.7600, lr_0 = 4.0381e-04
Loss = 1.0942e-01, PNorm = 48.7731, GNorm = 0.7854, lr_0 = 3.9493e-04
Validation prc-auc = 0.435313
Validation auc = 0.748203
Epoch 13
Loss = 1.4093e-01, PNorm = 48.8019, GNorm = 0.8658, lr_0 = 3.8625e-04
Loss = 8.5983e-02, PNorm = 48.8560, GNorm = 0.4847, lr_0 = 3.7776e-04
Loss = 1.3486e-01, PNorm = 48.9011, GNorm = 1.4731, lr_0 = 3.6946e-04
Loss = 1.0679e-01, PNorm = 48.9396, GNorm = 0.2847, lr_0 = 3.6134e-04
Validation prc-auc = 0.434799
Validation auc = 0.747357
Epoch 14
Loss = 1.0340e-01, PNorm = 48.9825, GNorm = 0.4192, lr_0 = 3.5340e-04
Loss = 1.1491e-01, PNorm = 49.0257, GNorm = 0.3305, lr_0 = 3.4563e-04
Loss = 9.1775e-02, PNorm = 49.0560, GNorm = 0.5880, lr_0 = 3.3803e-04
Validation prc-auc = 0.449186
Validation auc = 0.749683
Epoch 15
Loss = 2.4084e-02, PNorm = 49.0844, GNorm = 0.3036, lr_0 = 3.3060e-04
Loss = 5.6787e-02, PNorm = 49.1219, GNorm = 0.1839, lr_0 = 3.2333e-04
Loss = 1.4481e-01, PNorm = 49.1461, GNorm = 0.5235, lr_0 = 3.1623e-04
Loss = 1.0043e-01, PNorm = 49.1734, GNorm = 0.3413, lr_0 = 3.0928e-04
Validation prc-auc = 0.445535
Validation auc = 0.753700
Epoch 16
Loss = 7.3621e-02, PNorm = 49.2067, GNorm = 0.2086, lr_0 = 3.0248e-04
Loss = 9.4388e-02, PNorm = 49.2517, GNorm = 0.2243, lr_0 = 2.9583e-04
Loss = 8.1344e-02, PNorm = 49.2853, GNorm = 0.3057, lr_0 = 2.8933e-04
Loss = 1.2362e-01, PNorm = 49.3052, GNorm = 0.4641, lr_0 = 2.8297e-04
Validation prc-auc = 0.403393
Validation auc = 0.732347
Epoch 17
Loss = 1.0252e-01, PNorm = 49.3355, GNorm = 0.2440, lr_0 = 2.7675e-04
Loss = 9.6509e-02, PNorm = 49.3707, GNorm = 1.5224, lr_0 = 2.7067e-04
Loss = 9.1961e-02, PNorm = 49.3900, GNorm = 0.6883, lr_0 = 2.6472e-04
Loss = 9.4129e-02, PNorm = 49.4201, GNorm = 0.5819, lr_0 = 2.5890e-04
Validation prc-auc = 0.404628
Validation auc = 0.735941
Epoch 18
Loss = 1.0330e-01, PNorm = 49.4510, GNorm = 0.5080, lr_0 = 2.5321e-04
Loss = 1.1046e-01, PNorm = 49.4640, GNorm = 0.7140, lr_0 = 2.4764e-04
Loss = 6.4205e-02, PNorm = 49.5038, GNorm = 0.3614, lr_0 = 2.4220e-04
Loss = 8.7900e-02, PNorm = 49.5197, GNorm = 0.3269, lr_0 = 2.3687e-04
Validation prc-auc = 0.397995
Validation auc = 0.745455
Epoch 19
Loss = 8.5686e-02, PNorm = 49.5670, GNorm = 0.6706, lr_0 = 2.3167e-04
Loss = 6.9920e-02, PNorm = 49.5859, GNorm = 0.3554, lr_0 = 2.2658e-04
Loss = 8.9040e-02, PNorm = 49.6092, GNorm = 0.7277, lr_0 = 2.2159e-04
Validation prc-auc = 0.364786
Validation auc = 0.723044
Epoch 20
Loss = 2.0148e-02, PNorm = 49.6293, GNorm = 0.2919, lr_0 = 2.1672e-04
Loss = 7.4566e-02, PNorm = 49.6632, GNorm = 0.8399, lr_0 = 2.1196e-04
Loss = 7.6308e-02, PNorm = 49.6898, GNorm = 0.6018, lr_0 = 2.0730e-04
Loss = 8.8183e-02, PNorm = 49.7152, GNorm = 0.5849, lr_0 = 2.0274e-04
Validation prc-auc = 0.402981
Validation auc = 0.745243
Epoch 21
Loss = 1.1454e-01, PNorm = 49.7350, GNorm = 0.4597, lr_0 = 1.9829e-04
Loss = 5.6817e-02, PNorm = 49.7541, GNorm = 0.4879, lr_0 = 1.9393e-04
Loss = 8.1392e-02, PNorm = 49.7763, GNorm = 0.7065, lr_0 = 1.8967e-04
Loss = 5.4466e-02, PNorm = 49.7978, GNorm = 0.2239, lr_0 = 1.8550e-04
Validation prc-auc = 0.333847
Validation auc = 0.695349
Epoch 22
Loss = 3.0181e-02, PNorm = 49.8204, GNorm = 0.1364, lr_0 = 1.8142e-04
Loss = 5.0658e-02, PNorm = 49.8404, GNorm = 0.2244, lr_0 = 1.7743e-04
Loss = 8.7180e-02, PNorm = 49.8578, GNorm = 0.4904, lr_0 = 1.7353e-04
Loss = 6.5954e-02, PNorm = 49.8814, GNorm = 0.6397, lr_0 = 1.6972e-04
Validation prc-auc = 0.394296
Validation auc = 0.735941
Epoch 23
Loss = 7.4401e-02, PNorm = 49.8986, GNorm = 0.3227, lr_0 = 1.6599e-04
Loss = 4.9825e-02, PNorm = 49.9251, GNorm = 0.4637, lr_0 = 1.6234e-04
Loss = 5.3887e-02, PNorm = 49.9447, GNorm = 0.6585, lr_0 = 1.5877e-04
Loss = 6.9455e-02, PNorm = 49.9561, GNorm = 0.6098, lr_0 = 1.5528e-04
Validation prc-auc = 0.401698
Validation auc = 0.697674
Epoch 24
Loss = 4.6493e-02, PNorm = 49.9708, GNorm = 0.4515, lr_0 = 1.5187e-04
Loss = 4.5412e-02, PNorm = 49.9843, GNorm = 0.6789, lr_0 = 1.4853e-04
Loss = 4.6561e-02, PNorm = 50.0045, GNorm = 0.2092, lr_0 = 1.4527e-04
Validation prc-auc = 0.390955
Validation auc = 0.723256
Epoch 25
Loss = 2.8247e-02, PNorm = 50.0115, GNorm = 0.5407, lr_0 = 1.4207e-04
Loss = 5.2099e-02, PNorm = 50.0356, GNorm = 0.3570, lr_0 = 1.3895e-04
Loss = 5.9600e-02, PNorm = 50.0425, GNorm = 0.4053, lr_0 = 1.3590e-04
Loss = 6.2245e-02, PNorm = 50.0613, GNorm = 0.9488, lr_0 = 1.3291e-04
Validation prc-auc = 0.420661
Validation auc = 0.719239
Epoch 26
Loss = 4.2667e-02, PNorm = 50.0726, GNorm = 0.4614, lr_0 = 1.2999e-04
Loss = 4.2252e-02, PNorm = 50.0905, GNorm = 0.8374, lr_0 = 1.2713e-04
Loss = 4.5842e-02, PNorm = 50.1057, GNorm = 0.9121, lr_0 = 1.2434e-04
Loss = 5.7678e-02, PNorm = 50.1218, GNorm = 2.2625, lr_0 = 1.2160e-04
Validation prc-auc = 0.392670
Validation auc = 0.736152
Epoch 27
Loss = 3.8721e-02, PNorm = 50.1295, GNorm = 0.3036, lr_0 = 1.1893e-04
Loss = 5.8866e-02, PNorm = 50.1476, GNorm = 0.8370, lr_0 = 1.1632e-04
Loss = 5.0471e-02, PNorm = 50.1558, GNorm = 1.8895, lr_0 = 1.1376e-04
Loss = 4.5097e-02, PNorm = 50.1696, GNorm = 0.2152, lr_0 = 1.1126e-04
Validation prc-auc = 0.368958
Validation auc = 0.723256
Epoch 28
Loss = 5.1763e-02, PNorm = 50.1777, GNorm = 0.5054, lr_0 = 1.0881e-04
Loss = 4.2049e-02, PNorm = 50.1903, GNorm = 0.6943, lr_0 = 1.0642e-04
Loss = 3.3471e-02, PNorm = 50.1986, GNorm = 1.0598, lr_0 = 1.0408e-04
Loss = 4.4864e-02, PNorm = 50.2099, GNorm = 0.2078, lr_0 = 1.0179e-04
Validation prc-auc = 0.425014
Validation auc = 0.730867
Epoch 29
Loss = 3.2511e-02, PNorm = 50.2231, GNorm = 0.5184, lr_0 = 1.0000e-04
Loss = 3.5895e-02, PNorm = 50.2266, GNorm = 0.6941, lr_0 = 1.0000e-04
Loss = 6.1710e-02, PNorm = 50.2440, GNorm = 0.0417, lr_0 = 1.0000e-04
Validation prc-auc = 0.426390
Validation auc = 0.731078
Model 0 best validation prc-auc = 0.449186 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.606067
Model 0 test auc = 0.846916
Ensemble test prc-auc = 0.606067
Ensemble test auc = 0.846916
Fold 6
Splitting data with seed 6
Total scaffolds = 1,115 | train scaffolds = 804 | val scaffolds = 151 | test scaffolds = 160
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.7557e-01, PNorm = 46.0430, GNorm = 0.7169, lr_0 = 2.3378e-04
Loss = 2.2877e-01, PNorm = 46.0595, GNorm = 0.4346, lr_0 = 3.5541e-04
Loss = 1.8079e-01, PNorm = 46.0830, GNorm = 0.3188, lr_0 = 4.7703e-04
Validation prc-auc = 0.129975
Validation auc = 0.713514
Epoch 1
Loss = 1.3658e-01, PNorm = 46.1088, GNorm = 0.2853, lr_0 = 6.1081e-04
Loss = 2.4878e-01, PNorm = 46.1351, GNorm = 0.3094, lr_0 = 7.3243e-04
Loss = 2.3061e-01, PNorm = 46.1639, GNorm = 0.3532, lr_0 = 8.5405e-04
Loss = 2.0109e-01, PNorm = 46.2167, GNorm = 1.6456, lr_0 = 9.7568e-04
Validation prc-auc = 0.243198
Validation auc = 0.811712
Epoch 2
Loss = 2.3318e-01, PNorm = 46.2791, GNorm = 0.9699, lr_0 = 9.8238e-04
Loss = 2.0694e-01, PNorm = 46.3702, GNorm = 0.2810, lr_0 = 9.6078e-04
Loss = 2.1193e-01, PNorm = 46.4476, GNorm = 0.2446, lr_0 = 9.3966e-04
Loss = 1.7624e-01, PNorm = 46.5320, GNorm = 0.2486, lr_0 = 9.1901e-04
Validation prc-auc = 0.163158
Validation auc = 0.615916
Epoch 3
Loss = 1.7415e-01, PNorm = 46.6003, GNorm = 0.8632, lr_0 = 8.9881e-04
Loss = 1.8330e-01, PNorm = 46.6890, GNorm = 0.2261, lr_0 = 8.7905e-04
Loss = 2.1571e-01, PNorm = 46.7165, GNorm = 0.3812, lr_0 = 8.5973e-04
Loss = 1.7381e-01, PNorm = 46.7962, GNorm = 0.1861, lr_0 = 8.4083e-04
Validation prc-auc = 0.250170
Validation auc = 0.713514
Epoch 4
Loss = 2.0529e-01, PNorm = 46.8634, GNorm = 0.3985, lr_0 = 8.2235e-04
Loss = 1.9568e-01, PNorm = 46.9286, GNorm = 0.1824, lr_0 = 8.0428e-04
Loss = 1.5322e-01, PNorm = 47.0057, GNorm = 0.5591, lr_0 = 7.8660e-04
Validation prc-auc = 0.308363
Validation auc = 0.767568
Epoch 5
Loss = 2.8391e-01, PNorm = 47.0831, GNorm = 0.9297, lr_0 = 7.6931e-04
Loss = 1.1962e-01, PNorm = 47.1511, GNorm = 0.2595, lr_0 = 7.5240e-04
Loss = 1.7857e-01, PNorm = 47.1934, GNorm = 0.4025, lr_0 = 7.3586e-04
Loss = 1.8588e-01, PNorm = 47.2637, GNorm = 1.0516, lr_0 = 7.1969e-04
Validation prc-auc = 0.352110
Validation auc = 0.839640
Epoch 6
Loss = 1.7616e-01, PNorm = 47.3158, GNorm = 0.4783, lr_0 = 7.0387e-04
Loss = 1.4963e-01, PNorm = 47.3964, GNorm = 0.2433, lr_0 = 6.8840e-04
Loss = 1.8721e-01, PNorm = 47.4352, GNorm = 0.9707, lr_0 = 6.7326e-04
Loss = 1.4895e-01, PNorm = 47.4849, GNorm = 0.2352, lr_0 = 6.5847e-04
Validation prc-auc = 0.362334
Validation auc = 0.836036
Epoch 7
Loss = 1.6285e-01, PNorm = 47.5542, GNorm = 0.2711, lr_0 = 6.4399e-04
Loss = 1.4620e-01, PNorm = 47.6157, GNorm = 0.2900, lr_0 = 6.2984e-04
Loss = 1.3517e-01, PNorm = 47.6674, GNorm = 0.2495, lr_0 = 6.1599e-04
Loss = 1.4289e-01, PNorm = 47.6964, GNorm = 0.2855, lr_0 = 6.0245e-04
Validation prc-auc = 0.436542
Validation auc = 0.879279
Epoch 8
Loss = 1.1641e-01, PNorm = 47.7584, GNorm = 0.5131, lr_0 = 5.8921e-04
Loss = 1.7144e-01, PNorm = 47.8040, GNorm = 0.6585, lr_0 = 5.7626e-04
Loss = 1.5376e-01, PNorm = 47.8467, GNorm = 0.4223, lr_0 = 5.6359e-04
Loss = 1.4063e-01, PNorm = 47.8916, GNorm = 0.2395, lr_0 = 5.5120e-04
Validation prc-auc = 0.437085
Validation auc = 0.907207
Epoch 9
Loss = 1.4359e-01, PNorm = 47.9652, GNorm = 0.3830, lr_0 = 5.3909e-04
Loss = 1.3618e-01, PNorm = 48.0142, GNorm = 0.8376, lr_0 = 5.2724e-04
Loss = 1.5726e-01, PNorm = 48.0529, GNorm = 0.7936, lr_0 = 5.1565e-04
Validation prc-auc = 0.407708
Validation auc = 0.848649
Epoch 10
Loss = 9.9934e-02, PNorm = 48.1082, GNorm = 0.8117, lr_0 = 5.0432e-04
Loss = 1.6839e-01, PNorm = 48.1716, GNorm = 0.4137, lr_0 = 4.9323e-04
Loss = 1.4167e-01, PNorm = 48.2284, GNorm = 0.2284, lr_0 = 4.8239e-04
Loss = 1.2285e-01, PNorm = 48.2910, GNorm = 1.3553, lr_0 = 4.7179e-04
Validation prc-auc = 0.332482
Validation auc = 0.814114
Epoch 11
Loss = 1.0872e-01, PNorm = 48.3042, GNorm = 0.6859, lr_0 = 4.6142e-04
Loss = 1.9105e-01, PNorm = 48.3349, GNorm = 0.4171, lr_0 = 4.5127e-04
Loss = 1.2934e-01, PNorm = 48.3985, GNorm = 0.5154, lr_0 = 4.4135e-04
Loss = 1.7100e-01, PNorm = 48.4304, GNorm = 0.4902, lr_0 = 4.3165e-04
Validation prc-auc = 0.397049
Validation auc = 0.863063
Epoch 12
Loss = 1.1994e-01, PNorm = 48.4870, GNorm = 0.3601, lr_0 = 4.2217e-04
Loss = 1.5570e-01, PNorm = 48.5007, GNorm = 0.2463, lr_0 = 4.1289e-04
Loss = 1.2435e-01, PNorm = 48.5348, GNorm = 0.3057, lr_0 = 4.0381e-04
Loss = 1.2885e-01, PNorm = 48.5760, GNorm = 0.4272, lr_0 = 3.9493e-04
Validation prc-auc = 0.417832
Validation auc = 0.874174
Epoch 13
Loss = 1.8224e-01, PNorm = 48.6017, GNorm = 0.3368, lr_0 = 3.8625e-04
Loss = 6.5286e-02, PNorm = 48.6537, GNorm = 0.1778, lr_0 = 3.7776e-04
Loss = 1.6052e-01, PNorm = 48.6650, GNorm = 0.4271, lr_0 = 3.6946e-04
Loss = 1.2861e-01, PNorm = 48.7001, GNorm = 0.2780, lr_0 = 3.6134e-04
Validation prc-auc = 0.415935
Validation auc = 0.883784
Epoch 14
Loss = 1.0342e-01, PNorm = 48.7357, GNorm = 0.4530, lr_0 = 3.5340e-04
Loss = 9.4901e-02, PNorm = 48.7859, GNorm = 1.0327, lr_0 = 3.4563e-04
Loss = 1.6366e-01, PNorm = 48.8053, GNorm = 0.3515, lr_0 = 3.3803e-04
Validation prc-auc = 0.401700
Validation auc = 0.843243
Epoch 15
Loss = 1.0160e-01, PNorm = 48.8431, GNorm = 0.2624, lr_0 = 3.3060e-04
Loss = 9.1102e-02, PNorm = 48.8769, GNorm = 0.2466, lr_0 = 3.2333e-04
Loss = 1.2514e-01, PNorm = 48.9065, GNorm = 0.2917, lr_0 = 3.1623e-04
Loss = 1.3625e-01, PNorm = 48.9522, GNorm = 0.3047, lr_0 = 3.0928e-04
Validation prc-auc = 0.389015
Validation auc = 0.877477
Epoch 16
Loss = 7.7702e-02, PNorm = 48.9880, GNorm = 0.7731, lr_0 = 3.0248e-04
Loss = 8.7020e-02, PNorm = 49.0192, GNorm = 0.4119, lr_0 = 2.9583e-04
Loss = 1.4011e-01, PNorm = 49.0424, GNorm = 0.4496, lr_0 = 2.8933e-04
Loss = 1.1559e-01, PNorm = 49.0813, GNorm = 0.2209, lr_0 = 2.8297e-04
Validation prc-auc = 0.412349
Validation auc = 0.847147
Epoch 17
Loss = 1.1261e-01, PNorm = 49.1103, GNorm = 0.3241, lr_0 = 2.7675e-04
Loss = 1.2609e-01, PNorm = 49.1545, GNorm = 0.3476, lr_0 = 2.7067e-04
Loss = 1.3275e-01, PNorm = 49.1835, GNorm = 0.1928, lr_0 = 2.6472e-04
Loss = 6.6157e-02, PNorm = 49.2294, GNorm = 0.3144, lr_0 = 2.5890e-04
Validation prc-auc = 0.445334
Validation auc = 0.884985
Epoch 18
Loss = 6.1377e-02, PNorm = 49.2591, GNorm = 0.2121, lr_0 = 2.5321e-04
Loss = 1.2256e-01, PNorm = 49.2822, GNorm = 0.1961, lr_0 = 2.4764e-04
Loss = 1.0807e-01, PNorm = 49.3057, GNorm = 0.3247, lr_0 = 2.4220e-04
Loss = 1.0825e-01, PNorm = 49.3466, GNorm = 0.3117, lr_0 = 2.3687e-04
Validation prc-auc = 0.410959
Validation auc = 0.839940
Epoch 19
Loss = 1.0693e-01, PNorm = 49.3833, GNorm = 0.5721, lr_0 = 2.3167e-04
Loss = 9.5836e-02, PNorm = 49.4233, GNorm = 0.9755, lr_0 = 2.2658e-04
Loss = 7.7723e-02, PNorm = 49.4479, GNorm = 0.4715, lr_0 = 2.2159e-04
Validation prc-auc = 0.408435
Validation auc = 0.876276
Epoch 20
Loss = 4.8999e-02, PNorm = 49.4755, GNorm = 0.5222, lr_0 = 2.1672e-04
Loss = 8.1060e-02, PNorm = 49.5099, GNorm = 0.4960, lr_0 = 2.1196e-04
Loss = 1.0453e-01, PNorm = 49.5452, GNorm = 0.7341, lr_0 = 2.0730e-04
Loss = 1.0927e-01, PNorm = 49.5682, GNorm = 0.6378, lr_0 = 2.0274e-04
Validation prc-auc = 0.361008
Validation auc = 0.849550
Epoch 21
Loss = 7.4028e-02, PNorm = 49.6124, GNorm = 0.2746, lr_0 = 1.9829e-04
Loss = 9.4204e-02, PNorm = 49.6322, GNorm = 0.3242, lr_0 = 1.9393e-04
Loss = 8.6383e-02, PNorm = 49.6562, GNorm = 0.2425, lr_0 = 1.8967e-04
Loss = 1.0364e-01, PNorm = 49.6813, GNorm = 0.3763, lr_0 = 1.8550e-04
Validation prc-auc = 0.407662
Validation auc = 0.817417
Epoch 22
Loss = 1.1433e-01, PNorm = 49.7129, GNorm = 0.8457, lr_0 = 1.8142e-04
Loss = 1.0346e-01, PNorm = 49.7300, GNorm = 0.9222, lr_0 = 1.7743e-04
Loss = 7.9597e-02, PNorm = 49.7686, GNorm = 0.7055, lr_0 = 1.7353e-04
Loss = 6.0891e-02, PNorm = 49.7922, GNorm = 0.4460, lr_0 = 1.6972e-04
Validation prc-auc = 0.406121
Validation auc = 0.891291
Epoch 23
Loss = 8.9157e-02, PNorm = 49.8182, GNorm = 0.3235, lr_0 = 1.6599e-04
Loss = 7.4193e-02, PNorm = 49.8390, GNorm = 0.1795, lr_0 = 1.6234e-04
Loss = 8.8654e-02, PNorm = 49.8528, GNorm = 0.2454, lr_0 = 1.5877e-04
Loss = 7.8305e-02, PNorm = 49.8716, GNorm = 0.8492, lr_0 = 1.5528e-04
Validation prc-auc = 0.413565
Validation auc = 0.878679
Epoch 24
Loss = 4.5868e-02, PNorm = 49.9001, GNorm = 0.1854, lr_0 = 1.5187e-04
Loss = 7.5291e-02, PNorm = 49.9166, GNorm = 0.6735, lr_0 = 1.4853e-04
Loss = 8.0342e-02, PNorm = 49.9300, GNorm = 0.8618, lr_0 = 1.4527e-04
Validation prc-auc = 0.427391
Validation auc = 0.869970
Epoch 25
Loss = 6.2155e-02, PNorm = 49.9510, GNorm = 0.9145, lr_0 = 1.4207e-04
Loss = 8.8090e-02, PNorm = 49.9724, GNorm = 0.3350, lr_0 = 1.3895e-04
Loss = 6.2898e-02, PNorm = 49.9959, GNorm = 0.4651, lr_0 = 1.3590e-04
Loss = 7.4085e-02, PNorm = 50.0174, GNorm = 0.4914, lr_0 = 1.3291e-04
Validation prc-auc = 0.419329
Validation auc = 0.881682
Epoch 26
Loss = 5.1250e-02, PNorm = 50.0344, GNorm = 0.8419, lr_0 = 1.2999e-04
Loss = 6.3432e-02, PNorm = 50.0463, GNorm = 0.4735, lr_0 = 1.2713e-04
Loss = 6.5211e-02, PNorm = 50.0621, GNorm = 0.4783, lr_0 = 1.2434e-04
Loss = 6.3685e-02, PNorm = 50.0789, GNorm = 0.5960, lr_0 = 1.2160e-04
Validation prc-auc = 0.415955
Validation auc = 0.873874
Epoch 27
Loss = 7.9203e-02, PNorm = 50.0954, GNorm = 0.4447, lr_0 = 1.1893e-04
Loss = 4.9743e-02, PNorm = 50.1166, GNorm = 0.7312, lr_0 = 1.1632e-04
Loss = 4.8749e-02, PNorm = 50.1301, GNorm = 0.8841, lr_0 = 1.1376e-04
Loss = 6.2169e-02, PNorm = 50.1420, GNorm = 1.0819, lr_0 = 1.1126e-04
Validation prc-auc = 0.435758
Validation auc = 0.863363
Epoch 28
Loss = 5.1571e-02, PNorm = 50.1634, GNorm = 0.9102, lr_0 = 1.0881e-04
Loss = 6.8665e-02, PNorm = 50.1738, GNorm = 0.4113, lr_0 = 1.0642e-04
Loss = 5.5414e-02, PNorm = 50.1868, GNorm = 1.0630, lr_0 = 1.0408e-04
Loss = 5.1769e-02, PNorm = 50.2030, GNorm = 0.6081, lr_0 = 1.0179e-04
Validation prc-auc = 0.414349
Validation auc = 0.868168
Epoch 29
Loss = 5.9366e-02, PNorm = 50.2169, GNorm = 0.5977, lr_0 = 1.0000e-04
Loss = 4.7566e-02, PNorm = 50.2279, GNorm = 0.9098, lr_0 = 1.0000e-04
Loss = 5.8944e-02, PNorm = 50.2413, GNorm = 0.8034, lr_0 = 1.0000e-04
Validation prc-auc = 0.414774
Validation auc = 0.859459
Model 0 best validation prc-auc = 0.445334 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.468469
Model 0 test auc = 0.810248
Ensemble test prc-auc = 0.468469
Ensemble test auc = 0.810248
Fold 7
Splitting data with seed 7
Total scaffolds = 1,115 | train scaffolds = 812 | val scaffolds = 135 | test scaffolds = 168
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.4168e-01, PNorm = 46.0437, GNorm = 0.6063, lr_0 = 2.3378e-04
Loss = 2.5241e-01, PNorm = 46.0591, GNorm = 0.6723, lr_0 = 3.5541e-04
Loss = 2.3389e-01, PNorm = 46.0814, GNorm = 0.4569, lr_0 = 4.7703e-04
Validation prc-auc = 0.369389
Validation auc = 0.798077
Epoch 1
Loss = 1.3131e-01, PNorm = 46.1192, GNorm = 0.1732, lr_0 = 6.1081e-04
Loss = 2.5212e-01, PNorm = 46.1470, GNorm = 0.6515, lr_0 = 7.3243e-04
Loss = 2.0981e-01, PNorm = 46.2072, GNorm = 1.2185, lr_0 = 8.5405e-04
Loss = 1.8235e-01, PNorm = 46.2659, GNorm = 0.3304, lr_0 = 9.7568e-04
Validation prc-auc = 0.505644
Validation auc = 0.782240
Epoch 2
Loss = 1.6838e-01, PNorm = 46.3363, GNorm = 0.1966, lr_0 = 9.8238e-04
Loss = 2.1883e-01, PNorm = 46.4004, GNorm = 0.5878, lr_0 = 9.6078e-04
Loss = 2.4135e-01, PNorm = 46.4661, GNorm = 0.8194, lr_0 = 9.3966e-04
Loss = 1.8908e-01, PNorm = 46.5547, GNorm = 0.6905, lr_0 = 9.1901e-04
Validation prc-auc = 0.514823
Validation auc = 0.823812
Epoch 3
Loss = 2.4392e-01, PNorm = 46.6081, GNorm = 0.3318, lr_0 = 8.9881e-04
Loss = 1.1137e-01, PNorm = 46.7130, GNorm = 0.1287, lr_0 = 8.7905e-04
Loss = 1.6685e-01, PNorm = 46.7660, GNorm = 0.2926, lr_0 = 8.5973e-04
Loss = 2.4481e-01, PNorm = 46.8192, GNorm = 0.3541, lr_0 = 8.4083e-04
Validation prc-auc = 0.496108
Validation auc = 0.818722
Epoch 4
Loss = 2.4423e-01, PNorm = 46.9226, GNorm = 0.5291, lr_0 = 8.2235e-04
Loss = 1.7539e-01, PNorm = 47.0305, GNorm = 0.2330, lr_0 = 8.0428e-04
Loss = 1.2163e-01, PNorm = 47.1281, GNorm = 0.4689, lr_0 = 7.8660e-04
Validation prc-auc = 0.439539
Validation auc = 0.835973
Epoch 5
Loss = 1.2935e-01, PNorm = 47.1955, GNorm = 0.4683, lr_0 = 7.6931e-04
Loss = 1.8845e-01, PNorm = 47.2798, GNorm = 0.7031, lr_0 = 7.5240e-04
Loss = 1.7148e-01, PNorm = 47.3636, GNorm = 0.3015, lr_0 = 7.3586e-04
Loss = 1.6145e-01, PNorm = 47.4601, GNorm = 0.2072, lr_0 = 7.1969e-04
Validation prc-auc = 0.499649
Validation auc = 0.826075
Epoch 6
Loss = 1.5174e-01, PNorm = 47.5290, GNorm = 0.5464, lr_0 = 7.0387e-04
Loss = 1.6940e-01, PNorm = 47.6011, GNorm = 0.2665, lr_0 = 6.8840e-04
Loss = 1.5725e-01, PNorm = 47.6670, GNorm = 0.4616, lr_0 = 6.7326e-04
Loss = 1.5800e-01, PNorm = 47.7458, GNorm = 0.4428, lr_0 = 6.5847e-04
Validation prc-auc = 0.524930
Validation auc = 0.826075
Epoch 7
Loss = 2.2455e-01, PNorm = 47.8416, GNorm = 0.1849, lr_0 = 6.4399e-04
Loss = 1.1360e-01, PNorm = 47.9241, GNorm = 0.7593, lr_0 = 6.2984e-04
Loss = 1.5632e-01, PNorm = 47.9947, GNorm = 0.3460, lr_0 = 6.1599e-04
Loss = 1.7380e-01, PNorm = 48.0575, GNorm = 0.2532, lr_0 = 6.0245e-04
Validation prc-auc = 0.461728
Validation auc = 0.833993
Epoch 8
Loss = 1.3414e-01, PNorm = 48.1138, GNorm = 0.2309, lr_0 = 5.8921e-04
Loss = 1.4718e-01, PNorm = 48.1764, GNorm = 0.8493, lr_0 = 5.7626e-04
Loss = 1.4175e-01, PNorm = 48.2457, GNorm = 0.7449, lr_0 = 5.6359e-04
Loss = 1.4335e-01, PNorm = 48.2938, GNorm = 0.3477, lr_0 = 5.5120e-04
Validation prc-auc = 0.412477
Validation auc = 0.850396
Epoch 9
Loss = 1.0690e-01, PNorm = 48.3500, GNorm = 0.3257, lr_0 = 5.3909e-04
Loss = 1.4457e-01, PNorm = 48.4041, GNorm = 0.4230, lr_0 = 5.2724e-04
Loss = 1.2350e-01, PNorm = 48.4560, GNorm = 0.2354, lr_0 = 5.1565e-04
Validation prc-auc = 0.419690
Validation auc = 0.833710
Epoch 10
Loss = 3.5253e-02, PNorm = 48.5127, GNorm = 0.4001, lr_0 = 5.0432e-04
Loss = 1.4683e-01, PNorm = 48.5630, GNorm = 0.7083, lr_0 = 4.9323e-04
Loss = 1.0804e-01, PNorm = 48.6485, GNorm = 0.1368, lr_0 = 4.8239e-04
Loss = 1.1576e-01, PNorm = 48.6987, GNorm = 0.3314, lr_0 = 4.7179e-04
Validation prc-auc = 0.405312
Validation auc = 0.819853
Epoch 11
Loss = 1.9330e-01, PNorm = 48.7356, GNorm = 0.2517, lr_0 = 4.6142e-04
Loss = 1.2780e-01, PNorm = 48.7943, GNorm = 0.2676, lr_0 = 4.5127e-04
Loss = 1.1910e-01, PNorm = 48.8429, GNorm = 0.2663, lr_0 = 4.4135e-04
Loss = 9.3100e-02, PNorm = 48.8983, GNorm = 0.8767, lr_0 = 4.3165e-04
Validation prc-auc = 0.399834
Validation auc = 0.818722
Epoch 12
Loss = 1.0406e-01, PNorm = 48.9311, GNorm = 0.7245, lr_0 = 4.2217e-04
Loss = 1.5349e-01, PNorm = 48.9750, GNorm = 0.3961, lr_0 = 4.1289e-04
Loss = 1.1495e-01, PNorm = 49.0194, GNorm = 1.4858, lr_0 = 4.0381e-04
Loss = 1.2109e-01, PNorm = 49.0643, GNorm = 0.3128, lr_0 = 3.9493e-04
Validation prc-auc = 0.385506
Validation auc = 0.780543
Epoch 13
Loss = 1.0905e-01, PNorm = 49.1232, GNorm = 0.9710, lr_0 = 3.8625e-04
Loss = 8.8829e-02, PNorm = 49.1698, GNorm = 0.2724, lr_0 = 3.7776e-04
Loss = 1.5078e-01, PNorm = 49.2027, GNorm = 0.3760, lr_0 = 3.6946e-04
Loss = 1.4483e-01, PNorm = 49.2399, GNorm = 0.4744, lr_0 = 3.6134e-04
Validation prc-auc = 0.386666
Validation auc = 0.812783
Epoch 14
Loss = 1.2159e-01, PNorm = 49.2707, GNorm = 0.3627, lr_0 = 3.5340e-04
Loss = 7.9931e-02, PNorm = 49.3127, GNorm = 0.3556, lr_0 = 3.4563e-04
Loss = 1.0613e-01, PNorm = 49.3388, GNorm = 0.5331, lr_0 = 3.3803e-04
Validation prc-auc = 0.403361
Validation auc = 0.815328
Epoch 15
Loss = 1.0603e-01, PNorm = 49.3738, GNorm = 0.4590, lr_0 = 3.3060e-04
Loss = 8.4982e-02, PNorm = 49.4165, GNorm = 0.2671, lr_0 = 3.2333e-04
Loss = 9.6350e-02, PNorm = 49.4480, GNorm = 0.5426, lr_0 = 3.1623e-04
Loss = 1.2159e-01, PNorm = 49.4877, GNorm = 0.3761, lr_0 = 3.0928e-04
Validation prc-auc = 0.395486
Validation auc = 0.826075
Epoch 16
Loss = 6.5466e-02, PNorm = 49.5209, GNorm = 0.4932, lr_0 = 3.0248e-04
Loss = 9.9371e-02, PNorm = 49.5550, GNorm = 0.7202, lr_0 = 2.9583e-04
Loss = 1.0460e-01, PNorm = 49.5812, GNorm = 0.5188, lr_0 = 2.8933e-04
Loss = 8.8006e-02, PNorm = 49.6140, GNorm = 0.3167, lr_0 = 2.8297e-04
Validation prc-auc = 0.370137
Validation auc = 0.810520
Epoch 17
Loss = 7.0852e-02, PNorm = 49.6497, GNorm = 0.4647, lr_0 = 2.7675e-04
Loss = 9.5738e-02, PNorm = 49.6892, GNorm = 0.5250, lr_0 = 2.7067e-04
Loss = 7.9595e-02, PNorm = 49.7168, GNorm = 0.2881, lr_0 = 2.6472e-04
Loss = 1.2797e-01, PNorm = 49.7518, GNorm = 0.7676, lr_0 = 2.5890e-04
Validation prc-auc = 0.390192
Validation auc = 0.818439
Epoch 18
Loss = 9.2167e-02, PNorm = 49.7897, GNorm = 0.3005, lr_0 = 2.5321e-04
Loss = 8.4347e-02, PNorm = 49.8245, GNorm = 0.4825, lr_0 = 2.4764e-04
Loss = 8.6327e-02, PNorm = 49.8600, GNorm = 0.3224, lr_0 = 2.4220e-04
Loss = 9.9349e-02, PNorm = 49.8854, GNorm = 0.3968, lr_0 = 2.3687e-04
Validation prc-auc = 0.364525
Validation auc = 0.810803
Epoch 19
Loss = 6.1195e-02, PNorm = 49.9257, GNorm = 0.6383, lr_0 = 2.3167e-04
Loss = 7.3045e-02, PNorm = 49.9592, GNorm = 0.3251, lr_0 = 2.2658e-04
Loss = 7.9312e-02, PNorm = 49.9832, GNorm = 1.0251, lr_0 = 2.2159e-04
Validation prc-auc = 0.404740
Validation auc = 0.798360
Epoch 20
Loss = 3.6219e-02, PNorm = 50.0042, GNorm = 0.3328, lr_0 = 2.1672e-04
Loss = 8.0553e-02, PNorm = 50.0291, GNorm = 0.7776, lr_0 = 2.1196e-04
Loss = 8.1204e-02, PNorm = 50.0565, GNorm = 0.6814, lr_0 = 2.0730e-04
Loss = 7.3496e-02, PNorm = 50.0854, GNorm = 0.6323, lr_0 = 2.0274e-04
Validation prc-auc = 0.387284
Validation auc = 0.779129
Epoch 21
Loss = 1.8351e-02, PNorm = 50.1084, GNorm = 0.2114, lr_0 = 1.9829e-04
Loss = 6.1230e-02, PNorm = 50.1273, GNorm = 0.7932, lr_0 = 1.9393e-04
Loss = 1.0374e-01, PNorm = 50.1476, GNorm = 0.7759, lr_0 = 1.8967e-04
Loss = 7.1115e-02, PNorm = 50.1800, GNorm = 0.2574, lr_0 = 1.8550e-04
Validation prc-auc = 0.361361
Validation auc = 0.793552
Epoch 22
Loss = 5.2949e-02, PNorm = 50.2007, GNorm = 0.1421, lr_0 = 1.8142e-04
Loss = 7.4281e-02, PNorm = 50.2250, GNorm = 0.5282, lr_0 = 1.7743e-04
Loss = 7.5979e-02, PNorm = 50.2492, GNorm = 0.3003, lr_0 = 1.7353e-04
Loss = 6.4160e-02, PNorm = 50.2692, GNorm = 0.4562, lr_0 = 1.6972e-04
Validation prc-auc = 0.352079
Validation auc = 0.791007
Epoch 23
Loss = 7.2588e-02, PNorm = 50.2981, GNorm = 0.3473, lr_0 = 1.6599e-04
Loss = 6.2377e-02, PNorm = 50.3224, GNorm = 0.5018, lr_0 = 1.6234e-04
Loss = 5.7046e-02, PNorm = 50.3429, GNorm = 0.5765, lr_0 = 1.5877e-04
Loss = 6.2728e-02, PNorm = 50.3648, GNorm = 0.8178, lr_0 = 1.5528e-04
Validation prc-auc = 0.355785
Validation auc = 0.792704
Epoch 24
Loss = 4.6874e-02, PNorm = 50.3825, GNorm = 0.4463, lr_0 = 1.5187e-04
Loss = 5.6154e-02, PNorm = 50.3977, GNorm = 0.4094, lr_0 = 1.4853e-04
Loss = 6.5975e-02, PNorm = 50.4155, GNorm = 0.6537, lr_0 = 1.4527e-04
Validation prc-auc = 0.328823
Validation auc = 0.797511
Epoch 25
Loss = 4.0783e-02, PNorm = 50.4327, GNorm = 0.4619, lr_0 = 1.4207e-04
Loss = 6.0056e-02, PNorm = 50.4553, GNorm = 0.3118, lr_0 = 1.3895e-04
Loss = 2.0658e-02, PNorm = 50.4731, GNorm = 0.9971, lr_0 = 1.3590e-04
Loss = 1.0280e-01, PNorm = 50.4871, GNorm = 1.1383, lr_0 = 1.3291e-04
Validation prc-auc = 0.308400
Validation auc = 0.799208
Epoch 26
Loss = 7.1970e-02, PNorm = 50.5077, GNorm = 0.6007, lr_0 = 1.2999e-04
Loss = 5.4974e-02, PNorm = 50.5239, GNorm = 0.6974, lr_0 = 1.2713e-04
Loss = 4.5667e-02, PNorm = 50.5430, GNorm = 0.1270, lr_0 = 1.2434e-04
Loss = 5.2394e-02, PNorm = 50.5544, GNorm = 0.5338, lr_0 = 1.2160e-04
Validation prc-auc = 0.325755
Validation auc = 0.756505
Epoch 27
Loss = 4.8845e-02, PNorm = 50.5741, GNorm = 1.1336, lr_0 = 1.1893e-04
Loss = 4.4641e-02, PNorm = 50.5848, GNorm = 0.4156, lr_0 = 1.1632e-04
Loss = 3.4417e-02, PNorm = 50.6028, GNorm = 0.3235, lr_0 = 1.1376e-04
Loss = 4.4755e-02, PNorm = 50.6129, GNorm = 0.4042, lr_0 = 1.1126e-04
Validation prc-auc = 0.368497
Validation auc = 0.783088
Epoch 28
Loss = 4.5243e-02, PNorm = 50.6259, GNorm = 1.3478, lr_0 = 1.0881e-04
Loss = 5.0196e-02, PNorm = 50.6384, GNorm = 0.1283, lr_0 = 1.0642e-04
Loss = 4.5432e-02, PNorm = 50.6464, GNorm = 0.4045, lr_0 = 1.0408e-04
Loss = 5.0585e-02, PNorm = 50.6617, GNorm = 0.8063, lr_0 = 1.0179e-04
Validation prc-auc = 0.312327
Validation auc = 0.759615
Epoch 29
Loss = 4.4441e-02, PNorm = 50.6760, GNorm = 0.5019, lr_0 = 1.0000e-04
Loss = 3.5283e-02, PNorm = 50.6889, GNorm = 0.7518, lr_0 = 1.0000e-04
Loss = 3.4130e-02, PNorm = 50.7013, GNorm = 0.5784, lr_0 = 1.0000e-04
Validation prc-auc = 0.414514
Validation auc = 0.752262
Model 0 best validation prc-auc = 0.524930 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.452467
Model 0 test auc = 0.802365
Ensemble test prc-auc = 0.452467
Ensemble test auc = 0.802365
Fold 8
Splitting data with seed 8
Total scaffolds = 1,115 | train scaffolds = 852 | val scaffolds = 151 | test scaffolds = 112
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.1890e-01, PNorm = 46.0450, GNorm = 0.8647, lr_0 = 2.3378e-04
Loss = 3.3841e-01, PNorm = 46.0611, GNorm = 0.3382, lr_0 = 3.5541e-04
Loss = 2.5362e-01, PNorm = 46.0835, GNorm = 0.4728, lr_0 = 4.7703e-04
Validation prc-auc = 0.168174
Validation auc = 0.683216
Epoch 1
Loss = 2.3083e-01, PNorm = 46.1131, GNorm = 0.4327, lr_0 = 6.1081e-04
Loss = 2.4696e-01, PNorm = 46.1436, GNorm = 0.5861, lr_0 = 7.3243e-04
Loss = 1.6987e-01, PNorm = 46.1845, GNorm = 0.2232, lr_0 = 8.5405e-04
Loss = 2.5696e-01, PNorm = 46.2308, GNorm = 0.7606, lr_0 = 9.7568e-04
Validation prc-auc = 0.139617
Validation auc = 0.545804
Epoch 2
Loss = 1.4950e-01, PNorm = 46.3006, GNorm = 0.2670, lr_0 = 9.8238e-04
Loss = 2.1446e-01, PNorm = 46.3565, GNorm = 0.2950, lr_0 = 9.6078e-04
Loss = 1.8975e-01, PNorm = 46.4270, GNorm = 0.4253, lr_0 = 9.3966e-04
Loss = 2.1733e-01, PNorm = 46.5033, GNorm = 0.5483, lr_0 = 9.1901e-04
Validation prc-auc = 0.155778
Validation auc = 0.618514
Epoch 3
Loss = 1.7671e-01, PNorm = 46.5836, GNorm = 0.6519, lr_0 = 8.9881e-04
Loss = 1.9695e-01, PNorm = 46.6621, GNorm = 0.4279, lr_0 = 8.7905e-04
Loss = 1.8914e-01, PNorm = 46.7588, GNorm = 0.5460, lr_0 = 8.5973e-04
Loss = 1.7296e-01, PNorm = 46.8260, GNorm = 1.0737, lr_0 = 8.4083e-04
Validation prc-auc = 0.154767
Validation auc = 0.596413
Epoch 4
Loss = 1.9058e-01, PNorm = 46.9061, GNorm = 0.3211, lr_0 = 8.2235e-04
Loss = 2.1119e-01, PNorm = 46.9762, GNorm = 0.3760, lr_0 = 8.0428e-04
Loss = 1.7913e-01, PNorm = 47.0651, GNorm = 1.2478, lr_0 = 7.8660e-04
Validation prc-auc = 0.173404
Validation auc = 0.640295
Epoch 5
Loss = 8.3219e-02, PNorm = 47.1397, GNorm = 0.3799, lr_0 = 7.6931e-04
Loss = 1.8086e-01, PNorm = 47.2185, GNorm = 1.0185, lr_0 = 7.5240e-04
Loss = 1.6964e-01, PNorm = 47.2866, GNorm = 1.3395, lr_0 = 7.3586e-04
Loss = 1.9512e-01, PNorm = 47.3542, GNorm = 0.2286, lr_0 = 7.1969e-04
Validation prc-auc = 0.170425
Validation auc = 0.630685
Epoch 6
Loss = 1.9341e-01, PNorm = 47.4116, GNorm = 0.2144, lr_0 = 7.0387e-04
Loss = 1.8558e-01, PNorm = 47.4955, GNorm = 0.3380, lr_0 = 6.8840e-04
Loss = 1.5026e-01, PNorm = 47.5507, GNorm = 1.1522, lr_0 = 6.7326e-04
Loss = 1.6526e-01, PNorm = 47.6347, GNorm = 0.5183, lr_0 = 6.5847e-04
Validation prc-auc = 0.189167
Validation auc = 0.621717
Epoch 7
Loss = 1.3026e-01, PNorm = 47.6751, GNorm = 0.3749, lr_0 = 6.4399e-04
Loss = 1.2921e-01, PNorm = 47.7307, GNorm = 0.1560, lr_0 = 6.2984e-04
Loss = 1.6472e-01, PNorm = 47.7931, GNorm = 0.6620, lr_0 = 6.1599e-04
Loss = 1.7582e-01, PNorm = 47.8455, GNorm = 0.7137, lr_0 = 6.0245e-04
Validation prc-auc = 0.189098
Validation auc = 0.660154
Epoch 8
Loss = 1.5671e-01, PNorm = 47.9082, GNorm = 0.2412, lr_0 = 5.8921e-04
Loss = 1.3531e-01, PNorm = 47.9786, GNorm = 0.2455, lr_0 = 5.7626e-04
Loss = 1.7444e-01, PNorm = 48.0278, GNorm = 0.3601, lr_0 = 5.6359e-04
Loss = 1.2830e-01, PNorm = 48.0906, GNorm = 2.0036, lr_0 = 5.5120e-04
Validation prc-auc = 0.206635
Validation auc = 0.641576
Epoch 9
Loss = 1.2997e-01, PNorm = 48.1356, GNorm = 0.2816, lr_0 = 5.3909e-04
Loss = 1.3336e-01, PNorm = 48.1953, GNorm = 0.5316, lr_0 = 5.2724e-04
Loss = 1.3438e-01, PNorm = 48.2560, GNorm = 0.3289, lr_0 = 5.1565e-04
Validation prc-auc = 0.188588
Validation auc = 0.634529
Epoch 10
Loss = 1.2578e-01, PNorm = 48.3038, GNorm = 0.9617, lr_0 = 5.0432e-04
Loss = 1.1181e-01, PNorm = 48.3661, GNorm = 0.3604, lr_0 = 4.9323e-04
Loss = 1.2979e-01, PNorm = 48.4021, GNorm = 0.3532, lr_0 = 4.8239e-04
Loss = 1.6606e-01, PNorm = 48.4493, GNorm = 0.3812, lr_0 = 4.7179e-04
Validation prc-auc = 0.252390
Validation auc = 0.673286
Epoch 11
Loss = 1.2271e-01, PNorm = 48.4936, GNorm = 0.3055, lr_0 = 4.6142e-04
Loss = 1.2460e-01, PNorm = 48.5477, GNorm = 0.3045, lr_0 = 4.5127e-04
Loss = 1.4390e-01, PNorm = 48.5686, GNorm = 0.3221, lr_0 = 4.4135e-04
Loss = 1.2984e-01, PNorm = 48.6228, GNorm = 0.3501, lr_0 = 4.3165e-04
Validation prc-auc = 0.191289
Validation auc = 0.680653
Epoch 12
Loss = 7.3425e-02, PNorm = 48.6778, GNorm = 0.2990, lr_0 = 4.2217e-04
Loss = 1.0630e-01, PNorm = 48.7128, GNorm = 0.9460, lr_0 = 4.1289e-04
Loss = 1.4802e-01, PNorm = 48.7502, GNorm = 0.3261, lr_0 = 4.0381e-04
Loss = 1.1344e-01, PNorm = 48.7901, GNorm = 0.2376, lr_0 = 3.9493e-04
Validation prc-auc = 0.227610
Validation auc = 0.683216
Epoch 13
Loss = 1.3795e-01, PNorm = 48.8114, GNorm = 0.3732, lr_0 = 3.8625e-04
Loss = 1.0593e-01, PNorm = 48.8537, GNorm = 0.3359, lr_0 = 3.7776e-04
Loss = 1.1675e-01, PNorm = 48.8916, GNorm = 0.2509, lr_0 = 3.6946e-04
Loss = 9.9268e-02, PNorm = 48.9300, GNorm = 0.6809, lr_0 = 3.6134e-04
Validation prc-auc = 0.340809
Validation auc = 0.714606
Epoch 14
Loss = 7.4372e-02, PNorm = 48.9772, GNorm = 0.3334, lr_0 = 3.5340e-04
Loss = 1.0845e-01, PNorm = 49.0159, GNorm = 0.6110, lr_0 = 3.4563e-04
Loss = 1.3960e-01, PNorm = 49.0606, GNorm = 0.3247, lr_0 = 3.3803e-04
Validation prc-auc = 0.255083
Validation auc = 0.702755
Epoch 15
Loss = 1.0679e-01, PNorm = 49.0870, GNorm = 0.5376, lr_0 = 3.3060e-04
Loss = 9.5122e-02, PNorm = 49.1280, GNorm = 1.3080, lr_0 = 3.2333e-04
Loss = 8.8836e-02, PNorm = 49.1586, GNorm = 0.4900, lr_0 = 3.1623e-04
Loss = 1.3056e-01, PNorm = 49.1818, GNorm = 0.4857, lr_0 = 3.0928e-04
Validation prc-auc = 0.236069
Validation auc = 0.690583
Epoch 16
Loss = 8.2862e-02, PNorm = 49.2294, GNorm = 0.1824, lr_0 = 3.0248e-04
Loss = 1.1957e-01, PNorm = 49.2599, GNorm = 0.5987, lr_0 = 2.9583e-04
Loss = 9.5747e-02, PNorm = 49.2891, GNorm = 0.2621, lr_0 = 2.8933e-04
Loss = 9.0935e-02, PNorm = 49.3328, GNorm = 0.1967, lr_0 = 2.8297e-04
Validation prc-auc = 0.229774
Validation auc = 0.664958
Epoch 17
Loss = 1.1269e-01, PNorm = 49.3669, GNorm = 0.3752, lr_0 = 2.7675e-04
Loss = 8.6223e-02, PNorm = 49.3938, GNorm = 0.2716, lr_0 = 2.7067e-04
Loss = 8.9189e-02, PNorm = 49.4342, GNorm = 0.3634, lr_0 = 2.6472e-04
Loss = 1.1676e-01, PNorm = 49.4479, GNorm = 0.9725, lr_0 = 2.5890e-04
Validation prc-auc = 0.246515
Validation auc = 0.684177
Epoch 18
Loss = 9.8081e-02, PNorm = 49.4879, GNorm = 0.7278, lr_0 = 2.5321e-04
Loss = 9.9772e-02, PNorm = 49.5101, GNorm = 0.2936, lr_0 = 2.4764e-04
Loss = 1.0061e-01, PNorm = 49.5471, GNorm = 1.1218, lr_0 = 2.4220e-04
Loss = 8.9690e-02, PNorm = 49.5704, GNorm = 0.5568, lr_0 = 2.3687e-04
Validation prc-auc = 0.283201
Validation auc = 0.684817
Epoch 19
Loss = 8.4019e-02, PNorm = 49.6017, GNorm = 0.4818, lr_0 = 2.3167e-04
Loss = 9.0461e-02, PNorm = 49.6350, GNorm = 0.3615, lr_0 = 2.2658e-04
Loss = 8.8305e-02, PNorm = 49.6584, GNorm = 0.3738, lr_0 = 2.2159e-04
Validation prc-auc = 0.153278
Validation auc = 0.681614
Epoch 20
Loss = 6.9296e-02, PNorm = 49.6865, GNorm = 0.6365, lr_0 = 2.1672e-04
Loss = 9.6061e-02, PNorm = 49.7062, GNorm = 0.8072, lr_0 = 2.1196e-04
Loss = 7.9117e-02, PNorm = 49.7266, GNorm = 0.2157, lr_0 = 2.0730e-04
Loss = 9.3784e-02, PNorm = 49.7509, GNorm = 0.2165, lr_0 = 2.0274e-04
Validation prc-auc = 0.247125
Validation auc = 0.680974
Epoch 21
Loss = 7.3995e-02, PNorm = 49.7764, GNorm = 0.2910, lr_0 = 1.9829e-04
Loss = 6.5631e-02, PNorm = 49.8077, GNorm = 0.5842, lr_0 = 1.9393e-04
Loss = 7.3899e-02, PNorm = 49.8272, GNorm = 0.4509, lr_0 = 1.8967e-04
Loss = 8.8861e-02, PNorm = 49.8488, GNorm = 0.9761, lr_0 = 1.8550e-04
Validation prc-auc = 0.306663
Validation auc = 0.689942
Epoch 22
Loss = 3.8438e-02, PNorm = 49.8639, GNorm = 0.2766, lr_0 = 1.8142e-04
Loss = 8.4286e-02, PNorm = 49.8825, GNorm = 0.2864, lr_0 = 1.7743e-04
Loss = 6.8004e-02, PNorm = 49.9098, GNorm = 0.7449, lr_0 = 1.7353e-04
Loss = 7.4346e-02, PNorm = 49.9190, GNorm = 0.5821, lr_0 = 1.6972e-04
Validation prc-auc = 0.250169
Validation auc = 0.694747
Epoch 23
Loss = 4.2011e-02, PNorm = 49.9421, GNorm = 0.3422, lr_0 = 1.6599e-04
Loss = 7.9526e-02, PNorm = 49.9645, GNorm = 0.9823, lr_0 = 1.6234e-04
Loss = 1.0162e-01, PNorm = 49.9829, GNorm = 0.7749, lr_0 = 1.5877e-04
Loss = 5.1294e-02, PNorm = 50.0057, GNorm = 0.4312, lr_0 = 1.5528e-04
Validation prc-auc = 0.270185
Validation auc = 0.697950
Epoch 24
Loss = 6.9921e-02, PNorm = 50.0197, GNorm = 0.2661, lr_0 = 1.5187e-04
Loss = 4.1099e-02, PNorm = 50.0432, GNorm = 0.3784, lr_0 = 1.4853e-04
Loss = 5.0122e-02, PNorm = 50.0530, GNorm = 0.5802, lr_0 = 1.4527e-04
Validation prc-auc = 0.215845
Validation auc = 0.678091
Epoch 25
Loss = 5.2906e-02, PNorm = 50.0770, GNorm = 0.5958, lr_0 = 1.4207e-04
Loss = 6.4426e-02, PNorm = 50.0911, GNorm = 0.4137, lr_0 = 1.3895e-04
Loss = 6.5228e-02, PNorm = 50.1117, GNorm = 0.7483, lr_0 = 1.3590e-04
Loss = 6.1056e-02, PNorm = 50.1271, GNorm = 0.4068, lr_0 = 1.3291e-04
Validation prc-auc = 0.196022
Validation auc = 0.683536
Epoch 26
Loss = 3.8313e-02, PNorm = 50.1454, GNorm = 0.7944, lr_0 = 1.2999e-04
Loss = 5.3873e-02, PNorm = 50.1479, GNorm = 0.1820, lr_0 = 1.2713e-04
Loss = 8.5021e-02, PNorm = 50.1620, GNorm = 0.5151, lr_0 = 1.2434e-04
Loss = 4.5393e-02, PNorm = 50.1757, GNorm = 0.5255, lr_0 = 1.2160e-04
Validation prc-auc = 0.212410
Validation auc = 0.664638
Epoch 27
Loss = 4.8334e-02, PNorm = 50.1880, GNorm = 0.5073, lr_0 = 1.1893e-04
Loss = 4.8254e-02, PNorm = 50.2020, GNorm = 0.3353, lr_0 = 1.1632e-04
Loss = 7.3173e-02, PNorm = 50.2154, GNorm = 0.6135, lr_0 = 1.1376e-04
Loss = 5.5323e-02, PNorm = 50.2302, GNorm = 0.3405, lr_0 = 1.1126e-04
Validation prc-auc = 0.222496
Validation auc = 0.668482
Epoch 28
Loss = 4.2243e-02, PNorm = 50.2402, GNorm = 0.3998, lr_0 = 1.0881e-04
Loss = 3.4967e-02, PNorm = 50.2549, GNorm = 0.1062, lr_0 = 1.0642e-04
Loss = 8.3341e-02, PNorm = 50.2630, GNorm = 1.1357, lr_0 = 1.0408e-04
Loss = 4.9814e-02, PNorm = 50.2749, GNorm = 0.8337, lr_0 = 1.0179e-04
Validation prc-auc = 0.194759
Validation auc = 0.665919
Epoch 29
Loss = 6.2505e-02, PNorm = 50.2843, GNorm = 0.8980, lr_0 = 1.0000e-04
Loss = 3.7998e-02, PNorm = 50.2912, GNorm = 0.6013, lr_0 = 1.0000e-04
Loss = 3.5605e-02, PNorm = 50.3058, GNorm = 0.4256, lr_0 = 1.0000e-04
Validation prc-auc = 0.170760
Validation auc = 0.660474
Model 0 best validation prc-auc = 0.340809 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.313540
Model 0 test auc = 0.716228
Ensemble test prc-auc = 0.313540
Ensemble test auc = 0.716228
Fold 9
Splitting data with seed 9
Total scaffolds = 1,115 | train scaffolds = 850 | val scaffolds = 139 | test scaffolds = 126
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.6937e-01, PNorm = 46.0441, GNorm = 2.5921, lr_0 = 2.3378e-04
Loss = 2.2071e-01, PNorm = 46.0591, GNorm = 0.3763, lr_0 = 3.5541e-04
Loss = 2.0059e-01, PNorm = 46.0801, GNorm = 0.6889, lr_0 = 4.7703e-04
Validation prc-auc = 0.269439
Validation auc = 0.719820
Epoch 1
Loss = 1.4776e-01, PNorm = 46.1105, GNorm = 0.6666, lr_0 = 6.1081e-04
Loss = 2.1888e-01, PNorm = 46.1381, GNorm = 0.4104, lr_0 = 7.3243e-04
Loss = 2.1222e-01, PNorm = 46.1796, GNorm = 0.2809, lr_0 = 8.5405e-04
Loss = 2.1435e-01, PNorm = 46.2300, GNorm = 0.3046, lr_0 = 9.7568e-04
Validation prc-auc = 0.366838
Validation auc = 0.776877
Epoch 2
Loss = 1.8193e-01, PNorm = 46.3000, GNorm = 0.3244, lr_0 = 9.8238e-04
Loss = 2.0705e-01, PNorm = 46.3925, GNorm = 0.3992, lr_0 = 9.6078e-04
Loss = 1.8472e-01, PNorm = 46.4584, GNorm = 0.4365, lr_0 = 9.3966e-04
Loss = 1.9701e-01, PNorm = 46.5304, GNorm = 0.2104, lr_0 = 9.1901e-04
Validation prc-auc = 0.419344
Validation auc = 0.811111
Epoch 3
Loss = 1.7220e-01, PNorm = 46.6209, GNorm = 0.6977, lr_0 = 8.9881e-04
Loss = 1.5267e-01, PNorm = 46.7096, GNorm = 0.2153, lr_0 = 8.7905e-04
Loss = 2.2165e-01, PNorm = 46.7715, GNorm = 0.4584, lr_0 = 8.5973e-04
Loss = 2.0669e-01, PNorm = 46.8101, GNorm = 0.2500, lr_0 = 8.4083e-04
Validation prc-auc = 0.479925
Validation auc = 0.809309
Epoch 4
Loss = 2.0124e-01, PNorm = 46.8494, GNorm = 0.1633, lr_0 = 8.2235e-04
Loss = 1.6820e-01, PNorm = 46.9103, GNorm = 0.5770, lr_0 = 8.0428e-04
Loss = 1.3991e-01, PNorm = 46.9761, GNorm = 0.2441, lr_0 = 7.8660e-04
Validation prc-auc = 0.443445
Validation auc = 0.815015
Epoch 5
Loss = 1.1496e-01, PNorm = 47.0455, GNorm = 0.1625, lr_0 = 7.6931e-04
Loss = 1.6798e-01, PNorm = 47.1225, GNorm = 1.3047, lr_0 = 7.5240e-04
Loss = 1.2508e-01, PNorm = 47.1897, GNorm = 0.5785, lr_0 = 7.3586e-04
Loss = 2.0190e-01, PNorm = 47.2384, GNorm = 0.2260, lr_0 = 7.1969e-04
Validation prc-auc = 0.450032
Validation auc = 0.833333
Epoch 6
Loss = 2.0361e-01, PNorm = 47.2904, GNorm = 0.3106, lr_0 = 7.0387e-04
Loss = 1.6774e-01, PNorm = 47.3727, GNorm = 0.2914, lr_0 = 6.8840e-04
Loss = 1.5059e-01, PNorm = 47.4450, GNorm = 0.4608, lr_0 = 6.7326e-04
Loss = 1.6698e-01, PNorm = 47.4837, GNorm = 0.9090, lr_0 = 6.5847e-04
Validation prc-auc = 0.463465
Validation auc = 0.832132
Epoch 7
Loss = 1.7162e-01, PNorm = 47.5440, GNorm = 0.2017, lr_0 = 6.4399e-04
Loss = 1.6128e-01, PNorm = 47.5949, GNorm = 0.6442, lr_0 = 6.2984e-04
Loss = 1.7845e-01, PNorm = 47.6631, GNorm = 0.3258, lr_0 = 6.1599e-04
Loss = 1.4327e-01, PNorm = 47.7137, GNorm = 0.1566, lr_0 = 6.0245e-04
Validation prc-auc = 0.449903
Validation auc = 0.828529
Epoch 8
Loss = 1.3544e-01, PNorm = 47.7599, GNorm = 0.3680, lr_0 = 5.8921e-04
Loss = 1.6519e-01, PNorm = 47.8365, GNorm = 2.9579, lr_0 = 5.7626e-04
Loss = 1.5149e-01, PNorm = 47.8948, GNorm = 0.2300, lr_0 = 5.6359e-04
Loss = 1.7008e-01, PNorm = 47.9621, GNorm = 0.5174, lr_0 = 5.5120e-04
Validation prc-auc = 0.459206
Validation auc = 0.818318
Epoch 9
Loss = 1.5460e-01, PNorm = 48.0329, GNorm = 0.4896, lr_0 = 5.3909e-04
Loss = 1.6962e-01, PNorm = 48.0791, GNorm = 0.3082, lr_0 = 5.2724e-04
Loss = 9.9598e-02, PNorm = 48.1469, GNorm = 0.2330, lr_0 = 5.1565e-04
Validation prc-auc = 0.533939
Validation auc = 0.817417
Epoch 10
Loss = 1.8445e-01, PNorm = 48.1984, GNorm = 0.2365, lr_0 = 5.0432e-04
Loss = 1.3806e-01, PNorm = 48.2380, GNorm = 0.2972, lr_0 = 4.9323e-04
Loss = 1.4323e-01, PNorm = 48.2752, GNorm = 0.2821, lr_0 = 4.8239e-04
Loss = 1.3542e-01, PNorm = 48.3162, GNorm = 0.8541, lr_0 = 4.7179e-04
Validation prc-auc = 0.537598
Validation auc = 0.827628
Epoch 11
Loss = 1.0764e-01, PNorm = 48.3556, GNorm = 0.5374, lr_0 = 4.6142e-04
Loss = 1.4320e-01, PNorm = 48.4132, GNorm = 0.2116, lr_0 = 4.5127e-04
Loss = 1.4470e-01, PNorm = 48.4672, GNorm = 0.2160, lr_0 = 4.4135e-04
Loss = 1.0226e-01, PNorm = 48.5074, GNorm = 0.4611, lr_0 = 4.3165e-04
Validation prc-auc = 0.528273
Validation auc = 0.836937
Epoch 12
Loss = 1.0195e-01, PNorm = 48.5348, GNorm = 0.2200, lr_0 = 4.2217e-04
Loss = 8.9928e-02, PNorm = 48.5895, GNorm = 0.8871, lr_0 = 4.1289e-04
Loss = 1.6446e-01, PNorm = 48.6073, GNorm = 0.8297, lr_0 = 4.0381e-04
Loss = 1.2313e-01, PNorm = 48.6604, GNorm = 0.3061, lr_0 = 3.9493e-04
Validation prc-auc = 0.524954
Validation auc = 0.852853
Epoch 13
Loss = 1.2778e-01, PNorm = 48.6978, GNorm = 0.2690, lr_0 = 3.8625e-04
Loss = 1.1404e-01, PNorm = 48.7489, GNorm = 0.5094, lr_0 = 3.7776e-04
Loss = 1.0037e-01, PNorm = 48.7966, GNorm = 0.1944, lr_0 = 3.6946e-04
Loss = 1.2285e-01, PNorm = 48.8211, GNorm = 0.4206, lr_0 = 3.6134e-04
Validation prc-auc = 0.545570
Validation auc = 0.838739
Epoch 14
Loss = 1.2257e-01, PNorm = 48.8634, GNorm = 0.3238, lr_0 = 3.5340e-04
Loss = 1.1034e-01, PNorm = 48.8988, GNorm = 0.8219, lr_0 = 3.4563e-04
Loss = 1.1500e-01, PNorm = 48.9285, GNorm = 0.3841, lr_0 = 3.3803e-04
Validation prc-auc = 0.528774
Validation auc = 0.844444
Epoch 15
Loss = 1.2154e-01, PNorm = 48.9739, GNorm = 0.4492, lr_0 = 3.3060e-04
Loss = 1.0912e-01, PNorm = 49.0132, GNorm = 0.3451, lr_0 = 3.2333e-04
Loss = 1.4466e-01, PNorm = 49.0418, GNorm = 0.3191, lr_0 = 3.1623e-04
Loss = 1.0833e-01, PNorm = 49.0881, GNorm = 0.1699, lr_0 = 3.0928e-04
Validation prc-auc = 0.518189
Validation auc = 0.836637
Epoch 16
Loss = 8.6829e-02, PNorm = 49.1264, GNorm = 0.3724, lr_0 = 3.0248e-04
Loss = 1.0259e-01, PNorm = 49.1564, GNorm = 0.2931, lr_0 = 2.9583e-04
Loss = 1.1824e-01, PNorm = 49.1903, GNorm = 0.1640, lr_0 = 2.8933e-04
Loss = 1.1547e-01, PNorm = 49.2111, GNorm = 0.4689, lr_0 = 2.8297e-04
Validation prc-auc = 0.558862
Validation auc = 0.876276
Epoch 17
Loss = 7.4782e-02, PNorm = 49.2518, GNorm = 0.3432, lr_0 = 2.7675e-04
Loss = 1.0325e-01, PNorm = 49.2823, GNorm = 0.3548, lr_0 = 2.7067e-04
Loss = 1.0962e-01, PNorm = 49.3050, GNorm = 0.5118, lr_0 = 2.6472e-04
Loss = 1.0312e-01, PNorm = 49.3372, GNorm = 0.4068, lr_0 = 2.5890e-04
Validation prc-auc = 0.462566
Validation auc = 0.868468
Epoch 18
Loss = 1.1866e-01, PNorm = 49.3663, GNorm = 0.3353, lr_0 = 2.5321e-04
Loss = 9.0441e-02, PNorm = 49.4041, GNorm = 0.5889, lr_0 = 2.4764e-04
Loss = 8.7028e-02, PNorm = 49.4298, GNorm = 0.2626, lr_0 = 2.4220e-04
Loss = 7.9715e-02, PNorm = 49.4619, GNorm = 0.3094, lr_0 = 2.3687e-04
Validation prc-auc = 0.534057
Validation auc = 0.883483
Epoch 19
Loss = 9.2411e-02, PNorm = 49.4843, GNorm = 0.9480, lr_0 = 2.3167e-04
Loss = 9.2831e-02, PNorm = 49.5067, GNorm = 0.7064, lr_0 = 2.2658e-04
Loss = 1.0096e-01, PNorm = 49.5370, GNorm = 0.6782, lr_0 = 2.2159e-04
Validation prc-auc = 0.508518
Validation auc = 0.853153
Epoch 20
Loss = 5.4455e-02, PNorm = 49.5606, GNorm = 0.2682, lr_0 = 2.1672e-04
Loss = 6.2612e-02, PNorm = 49.5894, GNorm = 0.6979, lr_0 = 2.1196e-04
Loss = 6.2242e-02, PNorm = 49.6072, GNorm = 0.3742, lr_0 = 2.0730e-04
Loss = 6.6447e-02, PNorm = 49.6268, GNorm = 0.1723, lr_0 = 2.0274e-04
Validation prc-auc = 0.491112
Validation auc = 0.868769
Epoch 21
Loss = 1.1080e-01, PNorm = 49.6550, GNorm = 0.8128, lr_0 = 1.9829e-04
Loss = 6.0151e-02, PNorm = 49.6898, GNorm = 0.3582, lr_0 = 1.9393e-04
Loss = 8.2534e-02, PNorm = 49.7143, GNorm = 0.7405, lr_0 = 1.8967e-04
Loss = 6.8266e-02, PNorm = 49.7462, GNorm = 0.2348, lr_0 = 1.8550e-04
Validation prc-auc = 0.459153
Validation auc = 0.866667
Epoch 22
Loss = 7.2776e-02, PNorm = 49.7741, GNorm = 0.3914, lr_0 = 1.8142e-04
Loss = 8.0625e-02, PNorm = 49.8009, GNorm = 0.8067, lr_0 = 1.7743e-04
Loss = 8.2093e-02, PNorm = 49.8230, GNorm = 0.8383, lr_0 = 1.7353e-04
Loss = 7.3389e-02, PNorm = 49.8455, GNorm = 0.4762, lr_0 = 1.6972e-04
Validation prc-auc = 0.504432
Validation auc = 0.849550
Epoch 23
Loss = 7.2840e-02, PNorm = 49.8695, GNorm = 0.3914, lr_0 = 1.6599e-04
Loss = 5.1924e-02, PNorm = 49.8898, GNorm = 0.3417, lr_0 = 1.6234e-04
Loss = 8.9723e-02, PNorm = 49.9144, GNorm = 0.7365, lr_0 = 1.5877e-04
Loss = 7.8127e-02, PNorm = 49.9309, GNorm = 1.3192, lr_0 = 1.5528e-04
Validation prc-auc = 0.489276
Validation auc = 0.878979
Epoch 24
Loss = 4.6696e-02, PNorm = 49.9529, GNorm = 0.1564, lr_0 = 1.5187e-04
Loss = 7.8039e-02, PNorm = 49.9718, GNorm = 0.6025, lr_0 = 1.4853e-04
Loss = 7.0409e-02, PNorm = 49.9929, GNorm = 1.5840, lr_0 = 1.4527e-04
Validation prc-auc = 0.495113
Validation auc = 0.874775
Epoch 25
Loss = 5.5590e-02, PNorm = 50.0127, GNorm = 0.4573, lr_0 = 1.4207e-04
Loss = 5.3162e-02, PNorm = 50.0303, GNorm = 0.4613, lr_0 = 1.3895e-04
Loss = 5.9613e-02, PNorm = 50.0485, GNorm = 0.8464, lr_0 = 1.3590e-04
Loss = 6.2419e-02, PNorm = 50.0670, GNorm = 0.5279, lr_0 = 1.3291e-04
Validation prc-auc = 0.465584
Validation auc = 0.873874
Epoch 26
Loss = 2.6752e-02, PNorm = 50.0787, GNorm = 0.5396, lr_0 = 1.2999e-04
Loss = 6.3528e-02, PNorm = 50.0944, GNorm = 0.6598, lr_0 = 1.2713e-04
Loss = 5.0606e-02, PNorm = 50.1116, GNorm = 0.8389, lr_0 = 1.2434e-04
Loss = 4.8551e-02, PNorm = 50.1246, GNorm = 0.9895, lr_0 = 1.2160e-04
Validation prc-auc = 0.501234
Validation auc = 0.866066
Epoch 27
Loss = 8.5467e-02, PNorm = 50.1383, GNorm = 0.9531, lr_0 = 1.1893e-04
Loss = 4.7915e-02, PNorm = 50.1501, GNorm = 0.2667, lr_0 = 1.1632e-04
Loss = 4.8499e-02, PNorm = 50.1633, GNorm = 0.5646, lr_0 = 1.1376e-04
Loss = 4.9150e-02, PNorm = 50.1757, GNorm = 0.5873, lr_0 = 1.1126e-04
Validation prc-auc = 0.468109
Validation auc = 0.877177
Epoch 28
Loss = 4.6734e-02, PNorm = 50.1909, GNorm = 0.4001, lr_0 = 1.0881e-04
Loss = 5.0351e-02, PNorm = 50.2031, GNorm = 1.0388, lr_0 = 1.0642e-04
Loss = 4.5572e-02, PNorm = 50.2179, GNorm = 0.2327, lr_0 = 1.0408e-04
Loss = 5.4982e-02, PNorm = 50.2246, GNorm = 0.5256, lr_0 = 1.0179e-04
Validation prc-auc = 0.483255
Validation auc = 0.847447
Epoch 29
Loss = 3.9968e-02, PNorm = 50.2378, GNorm = 0.1815, lr_0 = 1.0000e-04
Loss = 3.9794e-02, PNorm = 50.2498, GNorm = 0.8754, lr_0 = 1.0000e-04
Loss = 5.0926e-02, PNorm = 50.2583, GNorm = 0.2097, lr_0 = 1.0000e-04
Validation prc-auc = 0.412697
Validation auc = 0.845045
Model 0 best validation prc-auc = 0.558862 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.561773
Model 0 test auc = 0.859557
Ensemble test prc-auc = 0.561773
Ensemble test auc = 0.859557
Fold 10
Splitting data with seed 10
Total scaffolds = 1,115 | train scaffolds = 823 | val scaffolds = 131 | test scaffolds = 161
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.6575e-01, PNorm = 46.0449, GNorm = 1.6115, lr_0 = 2.3378e-04
Loss = 2.5369e-01, PNorm = 46.0620, GNorm = 0.8252, lr_0 = 3.5541e-04
Loss = 1.9236e-01, PNorm = 46.0852, GNorm = 0.3499, lr_0 = 4.7703e-04
Validation prc-auc = 0.273244
Validation auc = 0.777707
Epoch 1
Loss = 1.6205e-01, PNorm = 46.1125, GNorm = 0.3123, lr_0 = 6.1081e-04
Loss = 2.0238e-01, PNorm = 46.1401, GNorm = 0.4775, lr_0 = 7.3243e-04
Loss = 2.3974e-01, PNorm = 46.1746, GNorm = 0.7039, lr_0 = 8.5405e-04
Loss = 2.1252e-01, PNorm = 46.2172, GNorm = 0.7248, lr_0 = 9.7568e-04
Validation prc-auc = 0.240954
Validation auc = 0.810058
Epoch 2
Loss = 2.3000e-01, PNorm = 46.2834, GNorm = 1.6255, lr_0 = 9.8238e-04
Loss = 2.3123e-01, PNorm = 46.3561, GNorm = 0.6848, lr_0 = 9.6078e-04
Loss = 2.2953e-01, PNorm = 46.4164, GNorm = 0.4526, lr_0 = 9.3966e-04
Loss = 1.7950e-01, PNorm = 46.4952, GNorm = 0.6994, lr_0 = 9.1901e-04
Validation prc-auc = 0.214307
Validation auc = 0.764894
Epoch 3
Loss = 2.1225e-01, PNorm = 46.5826, GNorm = 2.0472, lr_0 = 8.9881e-04
Loss = 1.9286e-01, PNorm = 46.6746, GNorm = 0.7904, lr_0 = 8.7905e-04
Loss = 1.9253e-01, PNorm = 46.7693, GNorm = 0.4099, lr_0 = 8.5973e-04
Loss = 1.7894e-01, PNorm = 46.8302, GNorm = 0.4473, lr_0 = 8.4083e-04
Validation prc-auc = 0.347096
Validation auc = 0.817425
Epoch 4
Loss = 1.8613e-01, PNorm = 46.8945, GNorm = 0.2331, lr_0 = 8.2235e-04
Loss = 1.5998e-01, PNorm = 46.9573, GNorm = 0.2018, lr_0 = 8.0428e-04
Loss = 1.7687e-01, PNorm = 47.0182, GNorm = 0.2651, lr_0 = 7.8660e-04
Validation prc-auc = 0.243036
Validation auc = 0.803011
Epoch 5
Loss = 1.8976e-01, PNorm = 47.0769, GNorm = 0.2548, lr_0 = 7.6931e-04
Loss = 1.7816e-01, PNorm = 47.1459, GNorm = 0.1918, lr_0 = 7.5240e-04
Loss = 1.7747e-01, PNorm = 47.2166, GNorm = 0.2653, lr_0 = 7.3586e-04
Loss = 1.5198e-01, PNorm = 47.2903, GNorm = 0.3464, lr_0 = 7.1969e-04
Validation prc-auc = 0.270128
Validation auc = 0.784433
Epoch 6
Loss = 1.5889e-01, PNorm = 47.3825, GNorm = 0.8624, lr_0 = 7.0387e-04
Loss = 1.3894e-01, PNorm = 47.4430, GNorm = 0.3331, lr_0 = 6.8840e-04
Loss = 1.9954e-01, PNorm = 47.5024, GNorm = 0.4269, lr_0 = 6.7326e-04
Loss = 1.1202e-01, PNorm = 47.5849, GNorm = 0.2492, lr_0 = 6.5847e-04
Validation prc-auc = 0.309696
Validation auc = 0.816464
Epoch 7
Loss = 1.7656e-01, PNorm = 47.6296, GNorm = 0.2021, lr_0 = 6.4399e-04
Loss = 1.6166e-01, PNorm = 47.6913, GNorm = 0.2755, lr_0 = 6.2984e-04
Loss = 1.5630e-01, PNorm = 47.7538, GNorm = 0.6112, lr_0 = 6.1599e-04
Loss = 1.0757e-01, PNorm = 47.8314, GNorm = 0.1978, lr_0 = 6.0245e-04
Validation prc-auc = 0.371205
Validation auc = 0.752723
Epoch 8
Loss = 1.8861e-01, PNorm = 47.8671, GNorm = 0.5188, lr_0 = 5.8921e-04
Loss = 1.4265e-01, PNorm = 47.9348, GNorm = 0.2459, lr_0 = 5.7626e-04
Loss = 1.6466e-01, PNorm = 48.0031, GNorm = 0.5120, lr_0 = 5.6359e-04
Loss = 1.3418e-01, PNorm = 48.0593, GNorm = 0.2136, lr_0 = 5.5120e-04
Validation prc-auc = 0.426199
Validation auc = 0.814222
Epoch 9
Loss = 1.4319e-01, PNorm = 48.0980, GNorm = 0.2550, lr_0 = 5.3909e-04
Loss = 1.3337e-01, PNorm = 48.1495, GNorm = 0.3051, lr_0 = 5.2724e-04
Loss = 1.2671e-01, PNorm = 48.1889, GNorm = 0.4661, lr_0 = 5.1565e-04
Validation prc-auc = 0.434032
Validation auc = 0.741192
Epoch 10
Loss = 2.0596e-01, PNorm = 48.2289, GNorm = 0.4114, lr_0 = 5.0432e-04
Loss = 1.3360e-01, PNorm = 48.2814, GNorm = 0.3792, lr_0 = 4.9323e-04
Loss = 1.6495e-01, PNorm = 48.3316, GNorm = 0.3492, lr_0 = 4.8239e-04
Loss = 1.1609e-01, PNorm = 48.3768, GNorm = 0.2932, lr_0 = 4.7179e-04
Validation prc-auc = 0.341290
Validation auc = 0.745035
Epoch 11
Loss = 1.8065e-01, PNorm = 48.4097, GNorm = 0.9023, lr_0 = 4.6142e-04
Loss = 1.1660e-01, PNorm = 48.4553, GNorm = 0.1940, lr_0 = 4.5127e-04
Loss = 1.3932e-01, PNorm = 48.5086, GNorm = 0.2240, lr_0 = 4.4135e-04
Loss = 1.4267e-01, PNorm = 48.5465, GNorm = 0.4905, lr_0 = 4.3165e-04
Validation prc-auc = 0.439591
Validation auc = 0.724536
Epoch 12
Loss = 1.4286e-01, PNorm = 48.5951, GNorm = 0.2829, lr_0 = 4.2217e-04
Loss = 1.3223e-01, PNorm = 48.6311, GNorm = 0.7958, lr_0 = 4.1289e-04
Loss = 1.1853e-01, PNorm = 48.6565, GNorm = 0.2093, lr_0 = 4.0381e-04
Loss = 1.0480e-01, PNorm = 48.7069, GNorm = 0.3288, lr_0 = 3.9493e-04
Validation prc-auc = 0.445103
Validation auc = 0.726778
Epoch 13
Loss = 1.3114e-01, PNorm = 48.7420, GNorm = 0.2012, lr_0 = 3.8625e-04
Loss = 1.3484e-01, PNorm = 48.7948, GNorm = 0.9058, lr_0 = 3.7776e-04
Loss = 7.9825e-02, PNorm = 48.8418, GNorm = 0.3587, lr_0 = 3.6946e-04
Loss = 1.2357e-01, PNorm = 48.8695, GNorm = 0.3926, lr_0 = 3.6134e-04
Validation prc-auc = 0.367743
Validation auc = 0.769699
Epoch 14
Loss = 1.1153e-01, PNorm = 48.9112, GNorm = 0.4272, lr_0 = 3.5340e-04
Loss = 1.4291e-01, PNorm = 48.9362, GNorm = 0.7632, lr_0 = 3.4563e-04
Loss = 1.3291e-01, PNorm = 48.9968, GNorm = 0.3113, lr_0 = 3.3803e-04
Validation prc-auc = 0.448584
Validation auc = 0.766496
Epoch 15
Loss = 5.3422e-02, PNorm = 49.0452, GNorm = 0.1785, lr_0 = 3.3060e-04
Loss = 1.2486e-01, PNorm = 49.0752, GNorm = 0.3352, lr_0 = 3.2333e-04
Loss = 9.6921e-02, PNorm = 49.1219, GNorm = 0.2070, lr_0 = 3.1623e-04
Loss = 9.3389e-02, PNorm = 49.1611, GNorm = 0.9401, lr_0 = 3.0928e-04
Validation prc-auc = 0.387064
Validation auc = 0.708200
Epoch 16
Loss = 1.2639e-01, PNorm = 49.1834, GNorm = 0.5068, lr_0 = 3.0248e-04
Loss = 1.1953e-01, PNorm = 49.2319, GNorm = 0.3577, lr_0 = 2.9583e-04
Loss = 1.0285e-01, PNorm = 49.2589, GNorm = 0.2429, lr_0 = 2.8933e-04
Loss = 1.0416e-01, PNorm = 49.2896, GNorm = 0.3374, lr_0 = 2.8297e-04
Validation prc-auc = 0.410594
Validation auc = 0.746637
Epoch 17
Loss = 8.3005e-02, PNorm = 49.3247, GNorm = 0.4369, lr_0 = 2.7675e-04
Loss = 6.9821e-02, PNorm = 49.3580, GNorm = 1.4679, lr_0 = 2.7067e-04
Loss = 1.2738e-01, PNorm = 49.3872, GNorm = 0.4959, lr_0 = 2.6472e-04
Loss = 9.6673e-02, PNorm = 49.4239, GNorm = 0.3448, lr_0 = 2.5890e-04
Validation prc-auc = 0.434447
Validation auc = 0.756246
Epoch 18
Loss = 8.0740e-02, PNorm = 49.4545, GNorm = 0.5971, lr_0 = 2.5321e-04
Loss = 9.9057e-02, PNorm = 49.4813, GNorm = 0.2241, lr_0 = 2.4764e-04
Loss = 9.5588e-02, PNorm = 49.5082, GNorm = 1.2945, lr_0 = 2.4220e-04
Loss = 9.9132e-02, PNorm = 49.5474, GNorm = 0.2843, lr_0 = 2.3687e-04
Validation prc-auc = 0.402699
Validation auc = 0.723575
Epoch 19
Loss = 9.5150e-02, PNorm = 49.5725, GNorm = 0.2739, lr_0 = 2.3167e-04
Loss = 6.2085e-02, PNorm = 49.5975, GNorm = 0.4021, lr_0 = 2.2658e-04
Loss = 1.0711e-01, PNorm = 49.6242, GNorm = 0.7135, lr_0 = 2.2159e-04
Validation prc-auc = 0.405789
Validation auc = 0.743434
Epoch 20
Loss = 1.0829e-01, PNorm = 49.6451, GNorm = 0.5092, lr_0 = 2.1672e-04
Loss = 8.7133e-02, PNorm = 49.6787, GNorm = 0.6736, lr_0 = 2.1196e-04
Loss = 8.9167e-02, PNorm = 49.7030, GNorm = 0.5772, lr_0 = 2.0730e-04
Loss = 6.8714e-02, PNorm = 49.7310, GNorm = 0.5182, lr_0 = 2.0274e-04
Validation prc-auc = 0.363953
Validation auc = 0.746637
Epoch 21
Loss = 3.7128e-02, PNorm = 49.7590, GNorm = 0.7294, lr_0 = 1.9829e-04
Loss = 7.5261e-02, PNorm = 49.7721, GNorm = 0.4200, lr_0 = 1.9393e-04
Loss = 9.1447e-02, PNorm = 49.8035, GNorm = 0.2728, lr_0 = 1.8967e-04
Loss = 9.5039e-02, PNorm = 49.8213, GNorm = 0.5082, lr_0 = 1.8550e-04
Validation prc-auc = 0.392557
Validation auc = 0.754644
Epoch 22
Loss = 1.1949e-01, PNorm = 49.8522, GNorm = 0.2957, lr_0 = 1.8142e-04
Loss = 9.4955e-02, PNorm = 49.8792, GNorm = 0.2926, lr_0 = 1.7743e-04
Loss = 6.6959e-02, PNorm = 49.9058, GNorm = 0.4892, lr_0 = 1.7353e-04
Loss = 5.8321e-02, PNorm = 49.9261, GNorm = 0.4093, lr_0 = 1.6972e-04
Validation prc-auc = 0.377885
Validation auc = 0.757527
Epoch 23
Loss = 4.7790e-02, PNorm = 49.9459, GNorm = 0.2486, lr_0 = 1.6599e-04
Loss = 5.8231e-02, PNorm = 49.9704, GNorm = 0.5175, lr_0 = 1.6234e-04
Loss = 1.0004e-01, PNorm = 49.9793, GNorm = 0.5293, lr_0 = 1.5877e-04
Loss = 7.6541e-02, PNorm = 50.0061, GNorm = 0.2345, lr_0 = 1.5528e-04
Validation prc-auc = 0.368902
Validation auc = 0.720692
Epoch 24
Loss = 7.5053e-02, PNorm = 50.0267, GNorm = 0.2745, lr_0 = 1.5187e-04
Loss = 5.9981e-02, PNorm = 50.0537, GNorm = 0.1882, lr_0 = 1.4853e-04
Loss = 7.2237e-02, PNorm = 50.0655, GNorm = 0.4573, lr_0 = 1.4527e-04
Validation prc-auc = 0.291161
Validation auc = 0.716528
Epoch 25
Loss = 2.0796e-01, PNorm = 50.0857, GNorm = 2.5951, lr_0 = 1.4207e-04
Loss = 6.2803e-02, PNorm = 50.0972, GNorm = 0.3220, lr_0 = 1.3895e-04
Loss = 7.7282e-02, PNorm = 50.1158, GNorm = 0.6270, lr_0 = 1.3590e-04
Loss = 4.5397e-02, PNorm = 50.1352, GNorm = 0.4530, lr_0 = 1.3291e-04
Validation prc-auc = 0.368090
Validation auc = 0.724215
Epoch 26
Loss = 9.4412e-02, PNorm = 50.1495, GNorm = 0.6619, lr_0 = 1.2999e-04
Loss = 5.5259e-02, PNorm = 50.1648, GNorm = 0.1488, lr_0 = 1.2713e-04
Loss = 5.1322e-02, PNorm = 50.1784, GNorm = 0.2824, lr_0 = 1.2434e-04
Loss = 7.5964e-02, PNorm = 50.1934, GNorm = 0.4398, lr_0 = 1.2160e-04
Validation prc-auc = 0.360087
Validation auc = 0.734465
Epoch 27
Loss = 5.1734e-02, PNorm = 50.2087, GNorm = 0.5783, lr_0 = 1.1893e-04
Loss = 5.1784e-02, PNorm = 50.2209, GNorm = 0.5687, lr_0 = 1.1632e-04
Loss = 7.9543e-02, PNorm = 50.2392, GNorm = 0.6356, lr_0 = 1.1376e-04
Loss = 5.5200e-02, PNorm = 50.2490, GNorm = 1.6920, lr_0 = 1.1126e-04
Validation prc-auc = 0.365440
Validation auc = 0.716208
Epoch 28
Loss = 3.3968e-02, PNorm = 50.2626, GNorm = 0.4643, lr_0 = 1.0881e-04
Loss = 5.2200e-02, PNorm = 50.2806, GNorm = 0.1103, lr_0 = 1.0642e-04
Loss = 6.8355e-02, PNorm = 50.2875, GNorm = 0.6549, lr_0 = 1.0408e-04
Loss = 6.2960e-02, PNorm = 50.3002, GNorm = 0.3214, lr_0 = 1.0179e-04
Validation prc-auc = 0.240757
Validation auc = 0.749840
Epoch 29
Loss = 5.4395e-02, PNorm = 50.3094, GNorm = 0.2794, lr_0 = 1.0000e-04
Loss = 3.8638e-02, PNorm = 50.3178, GNorm = 0.2802, lr_0 = 1.0000e-04
Loss = 4.5801e-02, PNorm = 50.3289, GNorm = 0.4884, lr_0 = 1.0000e-04
Validation prc-auc = 0.310017
Validation auc = 0.702755
Model 0 best validation prc-auc = 0.448584 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.462790
Model 0 test auc = 0.882818
Ensemble test prc-auc = 0.462790
Ensemble test auc = 0.882818
Fold 11
Splitting data with seed 11
Total scaffolds = 1,115 | train scaffolds = 832 | val scaffolds = 153 | test scaffolds = 130
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.9120e-01, PNorm = 46.0434, GNorm = 1.3287, lr_0 = 2.3378e-04
Loss = 2.1161e-01, PNorm = 46.0613, GNorm = 0.2689, lr_0 = 3.5541e-04
Loss = 2.7970e-01, PNorm = 46.0788, GNorm = 0.3657, lr_0 = 4.7703e-04
Validation prc-auc = 0.259115
Validation auc = 0.700322
Epoch 1
Loss = 2.1062e-01, PNorm = 46.1045, GNorm = 0.3560, lr_0 = 6.1081e-04
Loss = 2.1041e-01, PNorm = 46.1341, GNorm = 0.3669, lr_0 = 7.3243e-04
Loss = 2.3147e-01, PNorm = 46.1756, GNorm = 0.6671, lr_0 = 8.5405e-04
Loss = 2.1728e-01, PNorm = 46.2329, GNorm = 0.6689, lr_0 = 9.7568e-04
Validation prc-auc = 0.274055
Validation auc = 0.697506
Epoch 2
Loss = 2.7973e-01, PNorm = 46.3025, GNorm = 1.1262, lr_0 = 9.8238e-04
Loss = 1.9916e-01, PNorm = 46.3853, GNorm = 0.4988, lr_0 = 9.6078e-04
Loss = 1.8906e-01, PNorm = 46.4533, GNorm = 0.3164, lr_0 = 9.3966e-04
Loss = 2.0015e-01, PNorm = 46.5376, GNorm = 0.2430, lr_0 = 9.1901e-04
Validation prc-auc = 0.296564
Validation auc = 0.674980
Epoch 3
Loss = 1.5317e-01, PNorm = 46.6119, GNorm = 0.4146, lr_0 = 8.9881e-04
Loss = 1.8788e-01, PNorm = 46.6864, GNorm = 0.7537, lr_0 = 8.7905e-04
Loss = 2.1890e-01, PNorm = 46.7630, GNorm = 0.4346, lr_0 = 8.5973e-04
Loss = 2.1343e-01, PNorm = 46.8226, GNorm = 0.6433, lr_0 = 8.4083e-04
Validation prc-auc = 0.403466
Validation auc = 0.710780
Epoch 4
Loss = 2.1413e-01, PNorm = 46.8828, GNorm = 0.7355, lr_0 = 8.2235e-04
Loss = 1.9895e-01, PNorm = 46.9701, GNorm = 1.0720, lr_0 = 8.0428e-04
Loss = 1.6107e-01, PNorm = 47.0505, GNorm = 0.2387, lr_0 = 7.8660e-04
Validation prc-auc = 0.400771
Validation auc = 0.703942
Epoch 5
Loss = 6.4570e-02, PNorm = 47.1268, GNorm = 0.7222, lr_0 = 7.6931e-04
Loss = 1.7573e-01, PNorm = 47.1893, GNorm = 0.3245, lr_0 = 7.5240e-04
Loss = 1.7784e-01, PNorm = 47.2585, GNorm = 0.2132, lr_0 = 7.3586e-04
Loss = 1.7062e-01, PNorm = 47.3221, GNorm = 0.2776, lr_0 = 7.1969e-04
Validation prc-auc = 0.285969
Validation auc = 0.692679
Epoch 6
Loss = 8.8489e-02, PNorm = 47.4133, GNorm = 0.3023, lr_0 = 7.0387e-04
Loss = 1.8249e-01, PNorm = 47.4976, GNorm = 0.7933, lr_0 = 6.8840e-04
Loss = 1.4977e-01, PNorm = 47.6116, GNorm = 0.2925, lr_0 = 6.7326e-04
Loss = 1.9844e-01, PNorm = 47.6712, GNorm = 0.4664, lr_0 = 6.5847e-04
Validation prc-auc = 0.339788
Validation auc = 0.689863
Epoch 7
Loss = 1.5038e-01, PNorm = 47.7192, GNorm = 0.5545, lr_0 = 6.4399e-04
Loss = 1.7393e-01, PNorm = 47.7858, GNorm = 0.2998, lr_0 = 6.2984e-04
Loss = 1.2799e-01, PNorm = 47.8502, GNorm = 0.2243, lr_0 = 6.1599e-04
Loss = 1.8303e-01, PNorm = 47.9057, GNorm = 0.4789, lr_0 = 6.0245e-04
Validation prc-auc = 0.297064
Validation auc = 0.737329
Epoch 8
Loss = 1.5331e-01, PNorm = 47.9731, GNorm = 0.3636, lr_0 = 5.8921e-04
Loss = 1.7601e-01, PNorm = 48.0280, GNorm = 0.6139, lr_0 = 5.7626e-04
Loss = 1.5082e-01, PNorm = 48.0867, GNorm = 0.4192, lr_0 = 5.6359e-04
Loss = 1.6173e-01, PNorm = 48.1369, GNorm = 0.6557, lr_0 = 5.5120e-04
Validation prc-auc = 0.374766
Validation auc = 0.701931
Epoch 9
Loss = 1.3880e-01, PNorm = 48.2095, GNorm = 0.1900, lr_0 = 5.3909e-04
Loss = 1.4773e-01, PNorm = 48.2525, GNorm = 0.2194, lr_0 = 5.2724e-04
Loss = 1.4911e-01, PNorm = 48.3190, GNorm = 0.3065, lr_0 = 5.1565e-04
Validation prc-auc = 0.362982
Validation auc = 0.717216
Epoch 10
Loss = 1.7010e-01, PNorm = 48.3732, GNorm = 0.3234, lr_0 = 5.0432e-04
Loss = 1.4148e-01, PNorm = 48.4261, GNorm = 0.5560, lr_0 = 4.9323e-04
Loss = 1.5223e-01, PNorm = 48.4818, GNorm = 0.4492, lr_0 = 4.8239e-04
Loss = 1.5164e-01, PNorm = 48.5337, GNorm = 0.4082, lr_0 = 4.7179e-04
Validation prc-auc = 0.322496
Validation auc = 0.675784
Epoch 11
Loss = 9.3267e-02, PNorm = 48.5847, GNorm = 0.3637, lr_0 = 4.6142e-04
Loss = 1.5183e-01, PNorm = 48.6357, GNorm = 0.4029, lr_0 = 4.5127e-04
Loss = 1.3429e-01, PNorm = 48.6855, GNorm = 0.3141, lr_0 = 4.4135e-04
Loss = 1.3517e-01, PNorm = 48.7480, GNorm = 1.1711, lr_0 = 4.3165e-04
Validation prc-auc = 0.207603
Validation auc = 0.680209
Epoch 12
Loss = 1.3902e-01, PNorm = 48.7875, GNorm = 0.3937, lr_0 = 4.2217e-04
Loss = 1.0658e-01, PNorm = 48.8488, GNorm = 0.3090, lr_0 = 4.1289e-04
Loss = 1.3291e-01, PNorm = 48.8946, GNorm = 0.3119, lr_0 = 4.0381e-04
Loss = 1.5923e-01, PNorm = 48.9426, GNorm = 0.5547, lr_0 = 3.9493e-04
Validation prc-auc = 0.289741
Validation auc = 0.748190
Epoch 13
Loss = 9.6437e-02, PNorm = 48.9869, GNorm = 0.2737, lr_0 = 3.8625e-04
Loss = 1.2239e-01, PNorm = 49.0412, GNorm = 0.6226, lr_0 = 3.7776e-04
Loss = 1.1715e-01, PNorm = 49.0861, GNorm = 0.2769, lr_0 = 3.6946e-04
Loss = 1.8247e-01, PNorm = 49.1170, GNorm = 0.6579, lr_0 = 3.6134e-04
Validation prc-auc = 0.316337
Validation auc = 0.708367
Epoch 14
Loss = 9.6951e-02, PNorm = 49.1799, GNorm = 0.4974, lr_0 = 3.5340e-04
Loss = 1.6078e-01, PNorm = 49.2206, GNorm = 0.6481, lr_0 = 3.4563e-04
Loss = 1.3875e-01, PNorm = 49.2671, GNorm = 0.3452, lr_0 = 3.3803e-04
Validation prc-auc = 0.228372
Validation auc = 0.757039
Epoch 15
Loss = 1.8525e-01, PNorm = 49.3118, GNorm = 0.5359, lr_0 = 3.3060e-04
Loss = 1.0832e-01, PNorm = 49.3641, GNorm = 0.3540, lr_0 = 3.2333e-04
Loss = 1.1208e-01, PNorm = 49.4076, GNorm = 0.4101, lr_0 = 3.1623e-04
Loss = 1.0265e-01, PNorm = 49.4370, GNorm = 0.4185, lr_0 = 3.0928e-04
Validation prc-auc = 0.341201
Validation auc = 0.780370
Epoch 16
Loss = 1.1433e-01, PNorm = 49.4714, GNorm = 0.2739, lr_0 = 3.0248e-04
Loss = 1.1229e-01, PNorm = 49.5194, GNorm = 0.5277, lr_0 = 2.9583e-04
Loss = 1.1304e-01, PNorm = 49.5612, GNorm = 0.3058, lr_0 = 2.8933e-04
Loss = 1.0093e-01, PNorm = 49.5955, GNorm = 0.3675, lr_0 = 2.8297e-04
Validation prc-auc = 0.265223
Validation auc = 0.713596
Epoch 17
Loss = 7.8358e-02, PNorm = 49.6436, GNorm = 0.1416, lr_0 = 2.7675e-04
Loss = 1.2517e-01, PNorm = 49.6716, GNorm = 0.5383, lr_0 = 2.7067e-04
Loss = 1.1202e-01, PNorm = 49.7158, GNorm = 0.4553, lr_0 = 2.6472e-04
Loss = 9.0860e-02, PNorm = 49.7576, GNorm = 0.8232, lr_0 = 2.5890e-04
Validation prc-auc = 0.211788
Validation auc = 0.705551
Epoch 18
Loss = 7.9587e-02, PNorm = 49.7929, GNorm = 0.4027, lr_0 = 2.5321e-04
Loss = 1.1770e-01, PNorm = 49.8253, GNorm = 0.5434, lr_0 = 2.4764e-04
Loss = 1.0024e-01, PNorm = 49.8654, GNorm = 0.6027, lr_0 = 2.4220e-04
Loss = 9.3273e-02, PNorm = 49.8999, GNorm = 0.7210, lr_0 = 2.3687e-04
Validation prc-auc = 0.233602
Validation auc = 0.659694
Epoch 19
Loss = 7.0525e-02, PNorm = 49.9305, GNorm = 0.2104, lr_0 = 2.3167e-04
Loss = 1.1565e-01, PNorm = 49.9535, GNorm = 0.3155, lr_0 = 2.2658e-04
Loss = 9.5150e-02, PNorm = 49.9940, GNorm = 0.2547, lr_0 = 2.2159e-04
Validation prc-auc = 0.219388
Validation auc = 0.748592
Epoch 20
Loss = 8.2036e-02, PNorm = 50.0263, GNorm = 0.6111, lr_0 = 2.1672e-04
Loss = 8.5744e-02, PNorm = 50.0612, GNorm = 0.4349, lr_0 = 2.1196e-04
Loss = 9.7678e-02, PNorm = 50.0896, GNorm = 0.7339, lr_0 = 2.0730e-04
Loss = 8.6637e-02, PNorm = 50.1161, GNorm = 0.6754, lr_0 = 2.0274e-04
Validation prc-auc = 0.249754
Validation auc = 0.721239
Epoch 21
Loss = 7.7684e-02, PNorm = 50.1508, GNorm = 0.7808, lr_0 = 1.9829e-04
Loss = 7.1697e-02, PNorm = 50.1831, GNorm = 0.7709, lr_0 = 1.9393e-04
Loss = 5.9348e-02, PNorm = 50.2086, GNorm = 0.0936, lr_0 = 1.8967e-04
Loss = 1.1182e-01, PNorm = 50.2294, GNorm = 0.4240, lr_0 = 1.8550e-04
Validation prc-auc = 0.227777
Validation auc = 0.746179
Epoch 22
Loss = 6.0487e-02, PNorm = 50.2715, GNorm = 0.2547, lr_0 = 1.8142e-04
Loss = 9.7919e-02, PNorm = 50.2966, GNorm = 0.8297, lr_0 = 1.7743e-04
Loss = 7.3415e-02, PNorm = 50.3321, GNorm = 0.4037, lr_0 = 1.7353e-04
Loss = 8.6642e-02, PNorm = 50.3500, GNorm = 0.9716, lr_0 = 1.6972e-04
Validation prc-auc = 0.319731
Validation auc = 0.744570
Epoch 23
Loss = 6.3369e-02, PNorm = 50.3711, GNorm = 0.2584, lr_0 = 1.6599e-04
Loss = 7.7767e-02, PNorm = 50.3925, GNorm = 1.3503, lr_0 = 1.6234e-04
Loss = 7.1327e-02, PNorm = 50.4181, GNorm = 0.8000, lr_0 = 1.5877e-04
Loss = 6.5489e-02, PNorm = 50.4351, GNorm = 0.7562, lr_0 = 1.5528e-04
Validation prc-auc = 0.334651
Validation auc = 0.737329
Epoch 24
Loss = 6.7598e-02, PNorm = 50.4612, GNorm = 0.6514, lr_0 = 1.5187e-04
Loss = 7.6663e-02, PNorm = 50.4737, GNorm = 0.5191, lr_0 = 1.4853e-04
Loss = 6.7492e-02, PNorm = 50.4953, GNorm = 0.3232, lr_0 = 1.4527e-04
Validation prc-auc = 0.288962
Validation auc = 0.725664
Epoch 25
Loss = 1.7435e-02, PNorm = 50.5172, GNorm = 0.2614, lr_0 = 1.4207e-04
Loss = 4.7363e-02, PNorm = 50.5329, GNorm = 0.7774, lr_0 = 1.3895e-04
Loss = 5.2097e-02, PNorm = 50.5545, GNorm = 0.2599, lr_0 = 1.3590e-04
Loss = 8.0720e-02, PNorm = 50.5723, GNorm = 0.8896, lr_0 = 1.3291e-04
Validation prc-auc = 0.200901
Validation auc = 0.692277
Epoch 26
Loss = 5.0926e-02, PNorm = 50.5955, GNorm = 0.5889, lr_0 = 1.2999e-04
Loss = 6.9862e-02, PNorm = 50.6126, GNorm = 0.9677, lr_0 = 1.2713e-04
Loss = 3.6638e-02, PNorm = 50.6354, GNorm = 0.4599, lr_0 = 1.2434e-04
Loss = 5.1457e-02, PNorm = 50.6490, GNorm = 0.7696, lr_0 = 1.2160e-04
Validation prc-auc = 0.308787
Validation auc = 0.763073
Epoch 27
Loss = 6.1995e-02, PNorm = 50.6614, GNorm = 0.9892, lr_0 = 1.1893e-04
Loss = 6.3594e-02, PNorm = 50.6799, GNorm = 0.7006, lr_0 = 1.1632e-04
Loss = 3.1037e-02, PNorm = 50.6945, GNorm = 0.3501, lr_0 = 1.1376e-04
Loss = 4.9964e-02, PNorm = 50.7056, GNorm = 0.2714, lr_0 = 1.1126e-04
Validation prc-auc = 0.246991
Validation auc = 0.689863
Epoch 28
Loss = 3.8439e-02, PNorm = 50.7211, GNorm = 0.5407, lr_0 = 1.0881e-04
Loss = 5.0194e-02, PNorm = 50.7322, GNorm = 0.7848, lr_0 = 1.0642e-04
Loss = 4.1826e-02, PNorm = 50.7484, GNorm = 0.7620, lr_0 = 1.0408e-04
Loss = 4.5711e-02, PNorm = 50.7606, GNorm = 0.3165, lr_0 = 1.0179e-04
Validation prc-auc = 0.247768
Validation auc = 0.716412
Epoch 29
Loss = 3.2323e-02, PNorm = 50.7745, GNorm = 0.8874, lr_0 = 1.0000e-04
Loss = 4.1847e-02, PNorm = 50.7861, GNorm = 0.6156, lr_0 = 1.0000e-04
Loss = 3.6894e-02, PNorm = 50.7962, GNorm = 0.1145, lr_0 = 1.0000e-04
Validation prc-auc = 0.266306
Validation auc = 0.711987
Model 0 best validation prc-auc = 0.403466 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.691745
Model 0 test auc = 0.973820
Ensemble test prc-auc = 0.691745
Ensemble test auc = 0.973820
Fold 12
Splitting data with seed 12
Total scaffolds = 1,115 | train scaffolds = 850 | val scaffolds = 126 | test scaffolds = 139
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.6145e-01, PNorm = 46.0452, GNorm = 1.2485, lr_0 = 2.3378e-04
Loss = 2.6688e-01, PNorm = 46.0611, GNorm = 0.3726, lr_0 = 3.5541e-04
Loss = 2.2363e-01, PNorm = 46.0907, GNorm = 0.7472, lr_0 = 4.7703e-04
Validation prc-auc = 0.755092
Validation auc = 0.954516
Epoch 1
Loss = 2.3047e-01, PNorm = 46.1198, GNorm = 0.5003, lr_0 = 6.1081e-04
Loss = 2.1024e-01, PNorm = 46.1432, GNorm = 0.4576, lr_0 = 7.3243e-04
Loss = 2.3731e-01, PNorm = 46.1867, GNorm = 0.8136, lr_0 = 8.5405e-04
Loss = 2.1711e-01, PNorm = 46.2306, GNorm = 0.2555, lr_0 = 9.7568e-04
Validation prc-auc = 0.768491
Validation auc = 0.944907
Epoch 2
Loss = 2.2150e-01, PNorm = 46.2935, GNorm = 0.9552, lr_0 = 9.8238e-04
Loss = 2.2824e-01, PNorm = 46.3613, GNorm = 0.5222, lr_0 = 9.6078e-04
Loss = 1.6899e-01, PNorm = 46.4500, GNorm = 0.1767, lr_0 = 9.3966e-04
Loss = 2.1830e-01, PNorm = 46.5320, GNorm = 0.2692, lr_0 = 9.1901e-04
Validation prc-auc = 0.750607
Validation auc = 0.942345
Epoch 3
Loss = 1.7718e-01, PNorm = 46.5927, GNorm = 0.2834, lr_0 = 8.9881e-04
Loss = 2.2636e-01, PNorm = 46.6533, GNorm = 0.4091, lr_0 = 8.7905e-04
Loss = 2.1476e-01, PNorm = 46.7304, GNorm = 0.3698, lr_0 = 8.5973e-04
Loss = 1.8726e-01, PNorm = 46.7977, GNorm = 0.6259, lr_0 = 8.4083e-04
Validation prc-auc = 0.799362
Validation auc = 0.949391
Epoch 4
Loss = 1.7894e-01, PNorm = 46.8570, GNorm = 0.2964, lr_0 = 8.2235e-04
Loss = 1.9770e-01, PNorm = 46.9133, GNorm = 0.5608, lr_0 = 8.0428e-04
Loss = 2.2763e-01, PNorm = 46.9515, GNorm = 0.4909, lr_0 = 7.8660e-04
Validation prc-auc = 0.743410
Validation auc = 0.918962
Epoch 5
Loss = 5.4577e-02, PNorm = 47.0394, GNorm = 0.1262, lr_0 = 7.6931e-04
Loss = 1.9190e-01, PNorm = 47.0944, GNorm = 0.2033, lr_0 = 7.5240e-04
Loss = 2.0662e-01, PNorm = 47.1600, GNorm = 0.3176, lr_0 = 7.3586e-04
Loss = 1.6519e-01, PNorm = 47.2067, GNorm = 0.2765, lr_0 = 7.1969e-04
Validation prc-auc = 0.863831
Validation auc = 0.952594
Epoch 6
Loss = 1.7740e-01, PNorm = 47.3022, GNorm = 0.7823, lr_0 = 7.0387e-04
Loss = 1.6415e-01, PNorm = 47.3965, GNorm = 0.2278, lr_0 = 6.8840e-04
Loss = 1.8066e-01, PNorm = 47.4714, GNorm = 1.0238, lr_0 = 6.7326e-04
Loss = 1.9473e-01, PNorm = 47.5326, GNorm = 0.2366, lr_0 = 6.5847e-04
Validation prc-auc = 0.880276
Validation auc = 0.967969
Epoch 7
Loss = 1.5275e-01, PNorm = 47.5885, GNorm = 0.4436, lr_0 = 6.4399e-04
Loss = 1.6487e-01, PNorm = 47.6492, GNorm = 0.5134, lr_0 = 6.2984e-04
Loss = 1.3082e-01, PNorm = 47.7212, GNorm = 0.5686, lr_0 = 6.1599e-04
Loss = 2.1929e-01, PNorm = 47.7879, GNorm = 0.3010, lr_0 = 6.0245e-04
Validation prc-auc = 0.849971
Validation auc = 0.967969
Epoch 8
Loss = 1.8774e-01, PNorm = 47.8607, GNorm = 0.3374, lr_0 = 5.8921e-04
Loss = 1.5428e-01, PNorm = 47.9347, GNorm = 0.5576, lr_0 = 5.7626e-04
Loss = 1.3022e-01, PNorm = 47.9869, GNorm = 0.2265, lr_0 = 5.6359e-04
Loss = 1.9385e-01, PNorm = 48.0358, GNorm = 0.5593, lr_0 = 5.5120e-04
Validation prc-auc = 0.845458
Validation auc = 0.964446
Epoch 9
Loss = 1.8440e-01, PNorm = 48.0957, GNorm = 0.3166, lr_0 = 5.3909e-04
Loss = 1.4871e-01, PNorm = 48.1623, GNorm = 0.7015, lr_0 = 5.2724e-04
Loss = 1.2376e-01, PNorm = 48.2225, GNorm = 0.3395, lr_0 = 5.1565e-04
Validation prc-auc = 0.782592
Validation auc = 0.963485
Epoch 10
Loss = 1.3692e-01, PNorm = 48.2807, GNorm = 0.8651, lr_0 = 5.0432e-04
Loss = 1.3929e-01, PNorm = 48.3457, GNorm = 0.7082, lr_0 = 4.9323e-04
Loss = 1.5261e-01, PNorm = 48.4168, GNorm = 0.4318, lr_0 = 4.8239e-04
Loss = 1.5633e-01, PNorm = 48.4656, GNorm = 0.3184, lr_0 = 4.7179e-04
Validation prc-auc = 0.787327
Validation auc = 0.962524
Epoch 11
Loss = 1.5661e-01, PNorm = 48.5222, GNorm = 0.3834, lr_0 = 4.6142e-04
Loss = 1.1009e-01, PNorm = 48.5916, GNorm = 0.5155, lr_0 = 4.5127e-04
Loss = 1.3513e-01, PNorm = 48.6371, GNorm = 0.2021, lr_0 = 4.4135e-04
Loss = 1.8632e-01, PNorm = 48.6700, GNorm = 0.9567, lr_0 = 4.3165e-04
Validation prc-auc = 0.856333
Validation auc = 0.975657
Epoch 12
Loss = 1.2412e-01, PNorm = 48.7099, GNorm = 0.4227, lr_0 = 4.2217e-04
Loss = 1.5321e-01, PNorm = 48.7595, GNorm = 0.4705, lr_0 = 4.1289e-04
Loss = 1.4561e-01, PNorm = 48.8247, GNorm = 0.7133, lr_0 = 4.0381e-04
Loss = 1.3245e-01, PNorm = 48.8707, GNorm = 0.1984, lr_0 = 3.9493e-04
Validation prc-auc = 0.855254
Validation auc = 0.973735
Epoch 13
Loss = 1.1975e-01, PNorm = 48.9308, GNorm = 0.7398, lr_0 = 3.8625e-04
Loss = 1.9486e-01, PNorm = 48.9568, GNorm = 1.1680, lr_0 = 3.7776e-04
Loss = 1.4950e-01, PNorm = 49.0070, GNorm = 0.2989, lr_0 = 3.6946e-04
Loss = 8.5897e-02, PNorm = 49.0576, GNorm = 0.3656, lr_0 = 3.6134e-04
Validation prc-auc = 0.846985
Validation auc = 0.977899
Epoch 14
Loss = 1.2842e-01, PNorm = 49.0990, GNorm = 0.8267, lr_0 = 3.5340e-04
Loss = 1.0564e-01, PNorm = 49.1334, GNorm = 0.3272, lr_0 = 3.4563e-04
Loss = 1.1486e-01, PNorm = 49.1725, GNorm = 0.2940, lr_0 = 3.3803e-04
Validation prc-auc = 0.812629
Validation auc = 0.970852
Epoch 15
Loss = 1.0785e-01, PNorm = 49.2134, GNorm = 0.5488, lr_0 = 3.3060e-04
Loss = 1.1241e-01, PNorm = 49.2523, GNorm = 0.2907, lr_0 = 3.2333e-04
Loss = 1.1506e-01, PNorm = 49.2904, GNorm = 0.5832, lr_0 = 3.1623e-04
Loss = 9.6522e-02, PNorm = 49.3290, GNorm = 0.4111, lr_0 = 3.0928e-04
Validation prc-auc = 0.744805
Validation auc = 0.934017
Epoch 16
Loss = 1.4069e-01, PNorm = 49.3595, GNorm = 1.5931, lr_0 = 3.0248e-04
Loss = 1.4157e-01, PNorm = 49.3984, GNorm = 0.9581, lr_0 = 2.9583e-04
Loss = 7.9583e-02, PNorm = 49.4360, GNorm = 0.2654, lr_0 = 2.8933e-04
Loss = 9.8030e-02, PNorm = 49.4799, GNorm = 0.3505, lr_0 = 2.8297e-04
Validation prc-auc = 0.803194
Validation auc = 0.973735
Epoch 17
Loss = 9.3400e-02, PNorm = 49.5119, GNorm = 0.3997, lr_0 = 2.7675e-04
Loss = 1.0842e-01, PNorm = 49.5399, GNorm = 0.7609, lr_0 = 2.7067e-04
Loss = 1.1432e-01, PNorm = 49.5853, GNorm = 0.7838, lr_0 = 2.6472e-04
Loss = 9.7207e-02, PNorm = 49.6119, GNorm = 0.3997, lr_0 = 2.5890e-04
Validation prc-auc = 0.781846
Validation auc = 0.957399
Epoch 18
Loss = 8.5445e-02, PNorm = 49.6457, GNorm = 0.4499, lr_0 = 2.5321e-04
Loss = 1.0700e-01, PNorm = 49.6668, GNorm = 0.4568, lr_0 = 2.4764e-04
Loss = 7.9105e-02, PNorm = 49.7039, GNorm = 0.4846, lr_0 = 2.4220e-04
Loss = 9.3301e-02, PNorm = 49.7251, GNorm = 0.3951, lr_0 = 2.3687e-04
Validation prc-auc = 0.795655
Validation auc = 0.970852
Epoch 19
Loss = 1.0678e-01, PNorm = 49.7652, GNorm = 0.2437, lr_0 = 2.3167e-04
Loss = 8.9362e-02, PNorm = 49.7922, GNorm = 0.3933, lr_0 = 2.2658e-04
Loss = 1.0236e-01, PNorm = 49.8194, GNorm = 0.4749, lr_0 = 2.2159e-04
Validation prc-auc = 0.751246
Validation auc = 0.945868
Epoch 20
Loss = 5.9872e-02, PNorm = 49.8423, GNorm = 0.3143, lr_0 = 2.1672e-04
Loss = 7.4066e-02, PNorm = 49.8690, GNorm = 0.3849, lr_0 = 2.1196e-04
Loss = 5.7821e-02, PNorm = 49.8965, GNorm = 0.2067, lr_0 = 2.0730e-04
Loss = 8.0747e-02, PNorm = 49.9083, GNorm = 0.7203, lr_0 = 2.0274e-04
Validation prc-auc = 0.701567
Validation auc = 0.921525
Epoch 21
Loss = 1.0081e-01, PNorm = 49.9388, GNorm = 0.4910, lr_0 = 1.9829e-04
Loss = 6.5962e-02, PNorm = 49.9647, GNorm = 0.2863, lr_0 = 1.9393e-04
Loss = 7.1049e-02, PNorm = 49.9870, GNorm = 0.4750, lr_0 = 1.8967e-04
Loss = 9.9179e-02, PNorm = 50.0075, GNorm = 0.6670, lr_0 = 1.8550e-04
Validation prc-auc = 0.693097
Validation auc = 0.901986
Epoch 22
Loss = 6.2732e-02, PNorm = 50.0339, GNorm = 0.4397, lr_0 = 1.8142e-04
Loss = 8.1486e-02, PNorm = 50.0543, GNorm = 0.9052, lr_0 = 1.7743e-04
Loss = 7.4586e-02, PNorm = 50.0860, GNorm = 0.3516, lr_0 = 1.7353e-04
Loss = 8.2904e-02, PNorm = 50.0985, GNorm = 0.8348, lr_0 = 1.6972e-04
Validation prc-auc = 0.729998
Validation auc = 0.941384
Epoch 23
Loss = 1.1298e-01, PNorm = 50.1280, GNorm = 0.6381, lr_0 = 1.6599e-04
Loss = 5.4457e-02, PNorm = 50.1482, GNorm = 0.5403, lr_0 = 1.6234e-04
Loss = 5.3626e-02, PNorm = 50.1688, GNorm = 0.8574, lr_0 = 1.5877e-04
Loss = 6.3335e-02, PNorm = 50.1926, GNorm = 0.4901, lr_0 = 1.5528e-04
Validation prc-auc = 0.659015
Validation auc = 0.856182
Epoch 24
Loss = 5.8503e-02, PNorm = 50.2063, GNorm = 0.6688, lr_0 = 1.5187e-04
Loss = 7.2344e-02, PNorm = 50.2204, GNorm = 1.1040, lr_0 = 1.4853e-04
Loss = 5.2785e-02, PNorm = 50.2386, GNorm = 0.8391, lr_0 = 1.4527e-04
Validation prc-auc = 0.658239
Validation auc = 0.848174
Epoch 25
Loss = 4.2554e-02, PNorm = 50.2530, GNorm = 0.7750, lr_0 = 1.4207e-04
Loss = 4.7350e-02, PNorm = 50.2687, GNorm = 0.2216, lr_0 = 1.3895e-04
Loss = 6.6594e-02, PNorm = 50.2810, GNorm = 0.4829, lr_0 = 1.3590e-04
Loss = 5.5369e-02, PNorm = 50.2934, GNorm = 0.5498, lr_0 = 1.3291e-04
Validation prc-auc = 0.659654
Validation auc = 0.837604
Epoch 26
Loss = 5.1982e-02, PNorm = 50.3158, GNorm = 0.4492, lr_0 = 1.2999e-04
Loss = 7.9823e-02, PNorm = 50.3229, GNorm = 0.4477, lr_0 = 1.2713e-04
Loss = 6.1756e-02, PNorm = 50.3448, GNorm = 0.3306, lr_0 = 1.2434e-04
Loss = 4.0400e-02, PNorm = 50.3619, GNorm = 0.1114, lr_0 = 1.2160e-04
Validation prc-auc = 0.648281
Validation auc = 0.827354
Epoch 27
Loss = 6.2284e-02, PNorm = 50.3741, GNorm = 0.6902, lr_0 = 1.1893e-04
Loss = 4.7283e-02, PNorm = 50.3870, GNorm = 0.6448, lr_0 = 1.1632e-04
Loss = 5.0849e-02, PNorm = 50.3963, GNorm = 0.5727, lr_0 = 1.1376e-04
Loss = 4.7233e-02, PNorm = 50.4094, GNorm = 0.1355, lr_0 = 1.1126e-04
Validation prc-auc = 0.655888
Validation auc = 0.824471
Epoch 28
Loss = 3.4643e-02, PNorm = 50.4197, GNorm = 1.0302, lr_0 = 1.0881e-04
Loss = 4.1054e-02, PNorm = 50.4317, GNorm = 0.5455, lr_0 = 1.0642e-04
Loss = 4.7109e-02, PNorm = 50.4417, GNorm = 0.7680, lr_0 = 1.0408e-04
Loss = 5.5160e-02, PNorm = 50.4513, GNorm = 0.6199, lr_0 = 1.0179e-04
Validation prc-auc = 0.617086
Validation auc = 0.812620
Epoch 29
Loss = 3.7584e-02, PNorm = 50.4629, GNorm = 0.8419, lr_0 = 1.0000e-04
Loss = 4.9069e-02, PNorm = 50.4762, GNorm = 1.8492, lr_0 = 1.0000e-04
Loss = 3.6123e-02, PNorm = 50.4854, GNorm = 0.5497, lr_0 = 1.0000e-04
Validation prc-auc = 0.637252
Validation auc = 0.808776
Model 0 best validation prc-auc = 0.880276 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.375430
Model 0 test auc = 0.815689
Ensemble test prc-auc = 0.375430
Ensemble test auc = 0.815689
Fold 13
Splitting data with seed 13
Total scaffolds = 1,115 | train scaffolds = 850 | val scaffolds = 117 | test scaffolds = 148
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.2346e-01, PNorm = 46.0428, GNorm = 0.2448, lr_0 = 2.3378e-04
Loss = 2.6491e-01, PNorm = 46.0574, GNorm = 1.0595, lr_0 = 3.5541e-04
Loss = 2.3339e-01, PNorm = 46.0777, GNorm = 0.4755, lr_0 = 4.7703e-04
Validation prc-auc = 0.095290
Validation auc = 0.642537
Epoch 1
Loss = 3.0035e-01, PNorm = 46.1078, GNorm = 0.2265, lr_0 = 6.1081e-04
Loss = 2.2066e-01, PNorm = 46.1430, GNorm = 0.7193, lr_0 = 7.3243e-04
Loss = 1.8085e-01, PNorm = 46.1898, GNorm = 0.2218, lr_0 = 8.5405e-04
Loss = 1.9004e-01, PNorm = 46.2362, GNorm = 0.7543, lr_0 = 9.7568e-04
Validation prc-auc = 0.161943
Validation auc = 0.646701
Epoch 2
Loss = 2.3858e-01, PNorm = 46.3114, GNorm = 0.2699, lr_0 = 9.8238e-04
Loss = 1.7389e-01, PNorm = 46.3909, GNorm = 0.3523, lr_0 = 9.6078e-04
Loss = 1.9563e-01, PNorm = 46.4593, GNorm = 0.6066, lr_0 = 9.3966e-04
Loss = 2.0248e-01, PNorm = 46.5167, GNorm = 0.7114, lr_0 = 9.1901e-04
Validation prc-auc = 0.113724
Validation auc = 0.645740
Epoch 3
Loss = 1.9823e-01, PNorm = 46.5916, GNorm = 0.4516, lr_0 = 8.9881e-04
Loss = 1.4429e-01, PNorm = 46.6796, GNorm = 0.1221, lr_0 = 8.7905e-04
Loss = 1.6184e-01, PNorm = 46.7366, GNorm = 0.1855, lr_0 = 8.5973e-04
Loss = 1.9990e-01, PNorm = 46.7946, GNorm = 0.4164, lr_0 = 8.4083e-04
Validation prc-auc = 0.169812
Validation auc = 0.671044
Epoch 4
Loss = 1.9118e-01, PNorm = 46.8545, GNorm = 0.3850, lr_0 = 8.2235e-04
Loss = 1.2736e-01, PNorm = 46.9500, GNorm = 0.6553, lr_0 = 8.0428e-04
Loss = 1.8436e-01, PNorm = 47.0144, GNorm = 0.3211, lr_0 = 7.8660e-04
Validation prc-auc = 0.132480
Validation auc = 0.666560
Epoch 5
Loss = 1.8228e-01, PNorm = 47.1204, GNorm = 0.4870, lr_0 = 7.6931e-04
Loss = 1.5095e-01, PNorm = 47.2048, GNorm = 0.5551, lr_0 = 7.5240e-04
Loss = 1.5729e-01, PNorm = 47.2659, GNorm = 0.3820, lr_0 = 7.3586e-04
Loss = 1.2719e-01, PNorm = 47.3466, GNorm = 0.5704, lr_0 = 7.1969e-04
Validation prc-auc = 0.147636
Validation auc = 0.696348
Epoch 6
Loss = 1.9871e-01, PNorm = 47.4162, GNorm = 0.3962, lr_0 = 7.0387e-04
Loss = 1.1924e-01, PNorm = 47.5178, GNorm = 0.3653, lr_0 = 6.8840e-04
Loss = 1.2060e-01, PNorm = 47.5844, GNorm = 0.2244, lr_0 = 6.7326e-04
Loss = 1.8322e-01, PNorm = 47.6289, GNorm = 0.3833, lr_0 = 6.5847e-04
Validation prc-auc = 0.178049
Validation auc = 0.696669
Epoch 7
Loss = 1.3973e-01, PNorm = 47.6921, GNorm = 0.1902, lr_0 = 6.4399e-04
Loss = 1.6194e-01, PNorm = 47.7531, GNorm = 0.2799, lr_0 = 6.2984e-04
Loss = 1.4739e-01, PNorm = 47.8110, GNorm = 0.2375, lr_0 = 6.1599e-04
Loss = 1.0887e-01, PNorm = 47.8697, GNorm = 0.3218, lr_0 = 6.0245e-04
Validation prc-auc = 0.203030
Validation auc = 0.688661
Epoch 8
Loss = 1.2682e-01, PNorm = 47.9323, GNorm = 0.2706, lr_0 = 5.8921e-04
Loss = 9.6864e-02, PNorm = 47.9850, GNorm = 0.2677, lr_0 = 5.7626e-04
Loss = 1.7999e-01, PNorm = 48.0015, GNorm = 0.3647, lr_0 = 5.6359e-04
Loss = 1.2221e-01, PNorm = 48.0692, GNorm = 0.3551, lr_0 = 5.5120e-04
Validation prc-auc = 0.211957
Validation auc = 0.689622
Epoch 9
Loss = 1.4183e-01, PNorm = 48.1213, GNorm = 0.5120, lr_0 = 5.3909e-04
Loss = 1.0314e-01, PNorm = 48.1952, GNorm = 0.2742, lr_0 = 5.2724e-04
Loss = 1.7116e-01, PNorm = 48.2162, GNorm = 0.4448, lr_0 = 5.1565e-04
Validation prc-auc = 0.245446
Validation auc = 0.697630
Epoch 10
Loss = 1.5531e-01, PNorm = 48.2742, GNorm = 0.2878, lr_0 = 5.0432e-04
Loss = 1.1835e-01, PNorm = 48.3249, GNorm = 0.2345, lr_0 = 4.9323e-04
Loss = 1.1894e-01, PNorm = 48.3831, GNorm = 0.7022, lr_0 = 4.8239e-04
Loss = 1.3403e-01, PNorm = 48.4426, GNorm = 0.2106, lr_0 = 4.7179e-04
Validation prc-auc = 0.194864
Validation auc = 0.672005
Epoch 11
Loss = 1.7536e-01, PNorm = 48.4705, GNorm = 0.3260, lr_0 = 4.6142e-04
Loss = 1.2425e-01, PNorm = 48.5099, GNorm = 0.4155, lr_0 = 4.5127e-04
Loss = 1.2399e-01, PNorm = 48.5572, GNorm = 0.4285, lr_0 = 4.4135e-04
Loss = 9.7483e-02, PNorm = 48.5915, GNorm = 0.6344, lr_0 = 4.3165e-04
Validation prc-auc = 0.235243
Validation auc = 0.682255
Epoch 12
Loss = 1.7374e-01, PNorm = 48.6371, GNorm = 0.9721, lr_0 = 4.2217e-04
Loss = 1.2536e-01, PNorm = 48.6564, GNorm = 0.5649, lr_0 = 4.1289e-04
Loss = 1.1193e-01, PNorm = 48.7046, GNorm = 0.2790, lr_0 = 4.0381e-04
Loss = 8.9437e-02, PNorm = 48.7459, GNorm = 0.6581, lr_0 = 3.9493e-04
Validation prc-auc = 0.203146
Validation auc = 0.702434
Epoch 13
Loss = 1.1720e-01, PNorm = 48.7731, GNorm = 0.2549, lr_0 = 3.8625e-04
Loss = 8.1393e-02, PNorm = 48.8290, GNorm = 0.4021, lr_0 = 3.7776e-04
Loss = 1.1874e-01, PNorm = 48.8655, GNorm = 0.5258, lr_0 = 3.6946e-04
Loss = 1.0095e-01, PNorm = 48.8887, GNorm = 0.3479, lr_0 = 3.6134e-04
Validation prc-auc = 0.237667
Validation auc = 0.693786
Epoch 14
Loss = 9.9489e-02, PNorm = 48.9258, GNorm = 0.3443, lr_0 = 3.5340e-04
Loss = 7.9446e-02, PNorm = 48.9679, GNorm = 0.1860, lr_0 = 3.4563e-04
Loss = 1.2183e-01, PNorm = 49.0055, GNorm = 0.8151, lr_0 = 3.3803e-04
Validation prc-auc = 0.210862
Validation auc = 0.696028
Epoch 15
Loss = 3.5259e-02, PNorm = 49.0411, GNorm = 0.1789, lr_0 = 3.3060e-04
Loss = 1.1227e-01, PNorm = 49.0730, GNorm = 0.9462, lr_0 = 3.2333e-04
Loss = 6.3276e-02, PNorm = 49.1126, GNorm = 0.5145, lr_0 = 3.1623e-04
Loss = 9.8176e-02, PNorm = 49.1412, GNorm = 0.5532, lr_0 = 3.0928e-04
Validation prc-auc = 0.225646
Validation auc = 0.719090
Epoch 16
Loss = 7.1912e-02, PNorm = 49.1667, GNorm = 0.2962, lr_0 = 3.0248e-04
Loss = 7.9259e-02, PNorm = 49.2096, GNorm = 0.8569, lr_0 = 2.9583e-04
Loss = 1.0284e-01, PNorm = 49.2550, GNorm = 1.0080, lr_0 = 2.8933e-04
Loss = 9.9457e-02, PNorm = 49.2825, GNorm = 0.4479, lr_0 = 2.8297e-04
Validation prc-auc = 0.191853
Validation auc = 0.683216
Epoch 17
Loss = 4.7011e-02, PNorm = 49.3001, GNorm = 0.3949, lr_0 = 2.7675e-04
Loss = 9.4217e-02, PNorm = 49.3318, GNorm = 0.4771, lr_0 = 2.7067e-04
Loss = 8.5683e-02, PNorm = 49.3609, GNorm = 0.3308, lr_0 = 2.6472e-04
Loss = 9.4988e-02, PNorm = 49.3903, GNorm = 1.2924, lr_0 = 2.5890e-04
Validation prc-auc = 0.257745
Validation auc = 0.687060
Epoch 18
Loss = 7.4444e-02, PNorm = 49.4232, GNorm = 0.4148, lr_0 = 2.5321e-04
Loss = 8.6836e-02, PNorm = 49.4598, GNorm = 0.4507, lr_0 = 2.4764e-04
Loss = 8.5415e-02, PNorm = 49.4899, GNorm = 0.7327, lr_0 = 2.4220e-04
Loss = 8.2937e-02, PNorm = 49.5177, GNorm = 0.8741, lr_0 = 2.3687e-04
Validation prc-auc = 0.188734
Validation auc = 0.688341
Epoch 19
Loss = 7.2145e-02, PNorm = 49.5389, GNorm = 1.1861, lr_0 = 2.3167e-04
Loss = 1.0670e-01, PNorm = 49.5728, GNorm = 0.4460, lr_0 = 2.2658e-04
Loss = 1.1382e-01, PNorm = 49.5889, GNorm = 0.8925, lr_0 = 2.2159e-04
Validation prc-auc = 0.294089
Validation auc = 0.668482
Epoch 20
Loss = 1.2298e-02, PNorm = 49.6286, GNorm = 0.1311, lr_0 = 2.1672e-04
Loss = 1.0852e-01, PNorm = 49.6415, GNorm = 0.5641, lr_0 = 2.1196e-04
Loss = 6.9284e-02, PNorm = 49.6701, GNorm = 0.5414, lr_0 = 2.0730e-04
Loss = 6.3177e-02, PNorm = 49.7007, GNorm = 0.2808, lr_0 = 2.0274e-04
Validation prc-auc = 0.228433
Validation auc = 0.703716
Epoch 21
Loss = 4.1778e-02, PNorm = 49.7184, GNorm = 0.3186, lr_0 = 1.9829e-04
Loss = 6.5063e-02, PNorm = 49.7401, GNorm = 0.3479, lr_0 = 1.9393e-04
Loss = 9.5007e-02, PNorm = 49.7641, GNorm = 0.6173, lr_0 = 1.8967e-04
Loss = 5.4083e-02, PNorm = 49.7906, GNorm = 0.1439, lr_0 = 1.8550e-04
Validation prc-auc = 0.224143
Validation auc = 0.693145
Epoch 22
Loss = 5.4931e-02, PNorm = 49.8088, GNorm = 0.3239, lr_0 = 1.8142e-04
Loss = 4.7158e-02, PNorm = 49.8230, GNorm = 0.2665, lr_0 = 1.7743e-04
Loss = 7.8836e-02, PNorm = 49.8439, GNorm = 0.5449, lr_0 = 1.7353e-04
Loss = 6.4523e-02, PNorm = 49.8570, GNorm = 0.5112, lr_0 = 1.6972e-04
Validation prc-auc = 0.196907
Validation auc = 0.705637
Epoch 23
Loss = 4.1511e-02, PNorm = 49.8786, GNorm = 0.1901, lr_0 = 1.6599e-04
Loss = 7.5945e-02, PNorm = 49.8937, GNorm = 0.6459, lr_0 = 1.6234e-04
Loss = 5.9444e-02, PNorm = 49.9120, GNorm = 0.2317, lr_0 = 1.5877e-04
Loss = 6.3022e-02, PNorm = 49.9310, GNorm = 0.4815, lr_0 = 1.5528e-04
Validation prc-auc = 0.227897
Validation auc = 0.656951
Epoch 24
Loss = 6.6118e-02, PNorm = 49.9447, GNorm = 0.4063, lr_0 = 1.5187e-04
Loss = 6.1913e-02, PNorm = 49.9634, GNorm = 0.2080, lr_0 = 1.4853e-04
Loss = 4.8729e-02, PNorm = 49.9773, GNorm = 0.1424, lr_0 = 1.4527e-04
Validation prc-auc = 0.267512
Validation auc = 0.656310
Epoch 25
Loss = 9.0666e-02, PNorm = 49.9995, GNorm = 0.4897, lr_0 = 1.4207e-04
Loss = 4.8911e-02, PNorm = 50.0116, GNorm = 0.2775, lr_0 = 1.3895e-04
Loss = 4.1087e-02, PNorm = 50.0267, GNorm = 0.5645, lr_0 = 1.3590e-04
Loss = 4.6350e-02, PNorm = 50.0384, GNorm = 0.3071, lr_0 = 1.3291e-04
Validation prc-auc = 0.217429
Validation auc = 0.671365
Epoch 26
Loss = 2.6906e-02, PNorm = 50.0489, GNorm = 0.5490, lr_0 = 1.2999e-04
Loss = 3.2607e-02, PNorm = 50.0663, GNorm = 0.6990, lr_0 = 1.2713e-04
Loss = 7.0057e-02, PNorm = 50.0744, GNorm = 0.4356, lr_0 = 1.2434e-04
Loss = 5.5616e-02, PNorm = 50.0917, GNorm = 0.7545, lr_0 = 1.2160e-04
Validation prc-auc = 0.169743
Validation auc = 0.671044
Epoch 27
Loss = 5.1347e-02, PNorm = 50.1040, GNorm = 0.6542, lr_0 = 1.1893e-04
Loss = 3.3647e-02, PNorm = 50.1167, GNorm = 0.1831, lr_0 = 1.1632e-04
Loss = 6.0883e-02, PNorm = 50.1273, GNorm = 0.9838, lr_0 = 1.1376e-04
Loss = 4.3982e-02, PNorm = 50.1382, GNorm = 0.3363, lr_0 = 1.1126e-04
Validation prc-auc = 0.219667
Validation auc = 0.614670
Epoch 28
Loss = 3.8022e-02, PNorm = 50.1516, GNorm = 0.1910, lr_0 = 1.0881e-04
Loss = 4.1231e-02, PNorm = 50.1594, GNorm = 0.9176, lr_0 = 1.0642e-04
Loss = 3.6000e-02, PNorm = 50.1706, GNorm = 0.5041, lr_0 = 1.0408e-04
Loss = 7.6289e-02, PNorm = 50.1824, GNorm = 0.4672, lr_0 = 1.0179e-04
Validation prc-auc = 0.169600
Validation auc = 0.625561
Epoch 29
Loss = 3.5288e-02, PNorm = 50.1895, GNorm = 0.3518, lr_0 = 1.0000e-04
Loss = 4.1608e-02, PNorm = 50.1982, GNorm = 0.4965, lr_0 = 1.0000e-04
Loss = 4.7787e-02, PNorm = 50.2110, GNorm = 0.5736, lr_0 = 1.0000e-04
Validation prc-auc = 0.173255
Validation auc = 0.669763
Model 0 best validation prc-auc = 0.294089 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.455225
Model 0 test auc = 0.721380
Ensemble test prc-auc = 0.455225
Ensemble test auc = 0.721380
Fold 14
Splitting data with seed 14
Total scaffolds = 1,115 | train scaffolds = 854 | val scaffolds = 106 | test scaffolds = 155
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 4.0277e-01, PNorm = 46.0445, GNorm = 1.8467, lr_0 = 2.3378e-04
Loss = 2.2554e-01, PNorm = 46.0602, GNorm = 0.5658, lr_0 = 3.5541e-04
Loss = 1.9228e-01, PNorm = 46.0831, GNorm = 0.2036, lr_0 = 4.7703e-04
Validation prc-auc = 0.448082
Validation auc = 0.794009
Epoch 1
Loss = 2.1477e-01, PNorm = 46.1126, GNorm = 0.4098, lr_0 = 6.1081e-04
Loss = 2.0598e-01, PNorm = 46.1432, GNorm = 0.5286, lr_0 = 7.3243e-04
Loss = 2.0255e-01, PNorm = 46.1879, GNorm = 0.5608, lr_0 = 8.5405e-04
Loss = 1.9051e-01, PNorm = 46.2397, GNorm = 0.4347, lr_0 = 9.7568e-04
Validation prc-auc = 0.508748
Validation auc = 0.848387
Epoch 2
Loss = 1.7152e-01, PNorm = 46.3151, GNorm = 0.2435, lr_0 = 9.8238e-04
Loss = 2.0835e-01, PNorm = 46.3717, GNorm = 0.3050, lr_0 = 9.6078e-04
Loss = 1.4303e-01, PNorm = 46.4576, GNorm = 0.7587, lr_0 = 9.3966e-04
Loss = 2.1608e-01, PNorm = 46.5224, GNorm = 0.3784, lr_0 = 9.1901e-04
Validation prc-auc = 0.600073
Validation auc = 0.864055
Epoch 3
Loss = 1.6896e-01, PNorm = 46.5909, GNorm = 0.6737, lr_0 = 8.9881e-04
Loss = 1.7165e-01, PNorm = 46.6620, GNorm = 0.3957, lr_0 = 8.7905e-04
Loss = 1.7183e-01, PNorm = 46.7339, GNorm = 1.0181, lr_0 = 8.5973e-04
Loss = 1.6157e-01, PNorm = 46.8042, GNorm = 0.3017, lr_0 = 8.4083e-04
Validation prc-auc = 0.602491
Validation auc = 0.851152
Epoch 4
Loss = 1.6299e-01, PNorm = 46.8922, GNorm = 0.1687, lr_0 = 8.2235e-04
Loss = 1.3918e-01, PNorm = 46.9757, GNorm = 0.7241, lr_0 = 8.0428e-04
Loss = 1.7877e-01, PNorm = 47.0346, GNorm = 0.2568, lr_0 = 7.8660e-04
Validation prc-auc = 0.649546
Validation auc = 0.872120
Epoch 5
Loss = 1.5366e-01, PNorm = 47.1086, GNorm = 0.2991, lr_0 = 7.6931e-04
Loss = 1.6490e-01, PNorm = 47.1840, GNorm = 0.7484, lr_0 = 7.5240e-04
Loss = 1.6809e-01, PNorm = 47.2597, GNorm = 1.2783, lr_0 = 7.3586e-04
Loss = 1.4328e-01, PNorm = 47.3368, GNorm = 1.2074, lr_0 = 7.1969e-04
Validation prc-auc = 0.574505
Validation auc = 0.847465
Epoch 6
Loss = 7.0400e-02, PNorm = 47.4052, GNorm = 0.3756, lr_0 = 7.0387e-04
Loss = 1.8331e-01, PNorm = 47.4595, GNorm = 0.3658, lr_0 = 6.8840e-04
Loss = 1.6059e-01, PNorm = 47.5257, GNorm = 0.4002, lr_0 = 6.7326e-04
Loss = 1.5133e-01, PNorm = 47.6039, GNorm = 0.3678, lr_0 = 6.5847e-04
Validation prc-auc = 0.595503
Validation auc = 0.854608
Epoch 7
Loss = 1.8015e-01, PNorm = 47.6683, GNorm = 0.1650, lr_0 = 6.4399e-04
Loss = 1.3026e-01, PNorm = 47.7136, GNorm = 0.3162, lr_0 = 6.2984e-04
Loss = 1.1055e-01, PNorm = 47.7629, GNorm = 0.3342, lr_0 = 6.1599e-04
Loss = 1.3695e-01, PNorm = 47.8228, GNorm = 0.2376, lr_0 = 6.0245e-04
Validation prc-auc = 0.598061
Validation auc = 0.873733
Epoch 8
Loss = 1.6414e-01, PNorm = 47.8901, GNorm = 0.1807, lr_0 = 5.8921e-04
Loss = 1.1681e-01, PNorm = 47.9409, GNorm = 0.8431, lr_0 = 5.7626e-04
Loss = 1.4012e-01, PNorm = 48.0009, GNorm = 0.3931, lr_0 = 5.6359e-04
Loss = 1.0912e-01, PNorm = 48.0457, GNorm = 0.2566, lr_0 = 5.5120e-04
Validation prc-auc = 0.605413
Validation auc = 0.863134
Epoch 9
Loss = 1.1655e-01, PNorm = 48.0957, GNorm = 0.4070, lr_0 = 5.3909e-04
Loss = 9.4811e-02, PNorm = 48.1500, GNorm = 0.4290, lr_0 = 5.2724e-04
Loss = 1.3505e-01, PNorm = 48.1959, GNorm = 0.6426, lr_0 = 5.1565e-04
Validation prc-auc = 0.664693
Validation auc = 0.892627
Epoch 10
Loss = 6.0892e-02, PNorm = 48.2307, GNorm = 0.3396, lr_0 = 5.0432e-04
Loss = 1.0820e-01, PNorm = 48.3033, GNorm = 0.4915, lr_0 = 4.9323e-04
Loss = 1.2992e-01, PNorm = 48.3582, GNorm = 0.2480, lr_0 = 4.8239e-04
Loss = 1.0552e-01, PNorm = 48.3971, GNorm = 0.1843, lr_0 = 4.7179e-04
Validation prc-auc = 0.608289
Validation auc = 0.900922
Epoch 11
Loss = 6.2033e-02, PNorm = 48.4452, GNorm = 0.3996, lr_0 = 4.6142e-04
Loss = 1.0457e-01, PNorm = 48.4793, GNorm = 0.6079, lr_0 = 4.5127e-04
Loss = 1.1984e-01, PNorm = 48.5355, GNorm = 0.2919, lr_0 = 4.4135e-04
Loss = 1.4377e-01, PNorm = 48.5763, GNorm = 0.8552, lr_0 = 4.3165e-04
Validation prc-auc = 0.613440
Validation auc = 0.880184
Epoch 12
Loss = 7.5370e-02, PNorm = 48.6121, GNorm = 0.4899, lr_0 = 4.2217e-04
Loss = 1.2346e-01, PNorm = 48.6554, GNorm = 0.3526, lr_0 = 4.1289e-04
Loss = 1.1602e-01, PNorm = 48.7161, GNorm = 0.4722, lr_0 = 4.0381e-04
Loss = 1.1159e-01, PNorm = 48.7545, GNorm = 0.3802, lr_0 = 3.9493e-04
Validation prc-auc = 0.566773
Validation auc = 0.873963
Epoch 13
Loss = 7.3351e-02, PNorm = 48.7901, GNorm = 0.4218, lr_0 = 3.8625e-04
Loss = 1.2330e-01, PNorm = 48.8297, GNorm = 0.4168, lr_0 = 3.7776e-04
Loss = 6.9827e-02, PNorm = 48.8735, GNorm = 0.7907, lr_0 = 3.6946e-04
Loss = 1.3375e-01, PNorm = 48.9127, GNorm = 1.7320, lr_0 = 3.6134e-04
Validation prc-auc = 0.601622
Validation auc = 0.879032
Epoch 14
Loss = 1.4410e-01, PNorm = 48.9521, GNorm = 0.7357, lr_0 = 3.5340e-04
Loss = 8.1497e-02, PNorm = 49.0019, GNorm = 0.1081, lr_0 = 3.4563e-04
Loss = 1.0538e-01, PNorm = 49.0394, GNorm = 0.5242, lr_0 = 3.3803e-04
Validation prc-auc = 0.569496
Validation auc = 0.862673
Epoch 15
Loss = 6.4240e-02, PNorm = 49.0782, GNorm = 0.3616, lr_0 = 3.3060e-04
Loss = 7.3641e-02, PNorm = 49.1281, GNorm = 0.4454, lr_0 = 3.2333e-04
Loss = 1.0474e-01, PNorm = 49.1553, GNorm = 0.7018, lr_0 = 3.1623e-04
Loss = 1.1726e-01, PNorm = 49.1966, GNorm = 0.6714, lr_0 = 3.0928e-04
Validation prc-auc = 0.611422
Validation auc = 0.910138
Epoch 16
Loss = 9.4615e-02, PNorm = 49.2267, GNorm = 0.3661, lr_0 = 3.0248e-04
Loss = 9.1944e-02, PNorm = 49.2673, GNorm = 0.2813, lr_0 = 2.9583e-04
Loss = 1.0334e-01, PNorm = 49.3104, GNorm = 0.5449, lr_0 = 2.8933e-04
Loss = 7.2280e-02, PNorm = 49.3386, GNorm = 0.2407, lr_0 = 2.8297e-04
Validation prc-auc = 0.593974
Validation auc = 0.865668
Epoch 17
Loss = 9.1378e-02, PNorm = 49.3707, GNorm = 0.2316, lr_0 = 2.7675e-04
Loss = 5.6899e-02, PNorm = 49.4106, GNorm = 0.3962, lr_0 = 2.7067e-04
Loss = 9.1163e-02, PNorm = 49.4416, GNorm = 0.2119, lr_0 = 2.6472e-04
Loss = 9.0818e-02, PNorm = 49.4629, GNorm = 0.5737, lr_0 = 2.5890e-04
Validation prc-auc = 0.589750
Validation auc = 0.852535
Epoch 18
Loss = 4.7602e-02, PNorm = 49.5015, GNorm = 0.4722, lr_0 = 2.5321e-04
Loss = 8.1871e-02, PNorm = 49.5265, GNorm = 0.2516, lr_0 = 2.4764e-04
Loss = 8.9424e-02, PNorm = 49.5557, GNorm = 0.3662, lr_0 = 2.4220e-04
Loss = 6.9263e-02, PNorm = 49.5920, GNorm = 0.5943, lr_0 = 2.3687e-04
Validation prc-auc = 0.595932
Validation auc = 0.859447
Epoch 19
Loss = 6.9328e-02, PNorm = 49.6180, GNorm = 0.5998, lr_0 = 2.3167e-04
Loss = 6.0065e-02, PNorm = 49.6427, GNorm = 1.0249, lr_0 = 2.2658e-04
Loss = 8.2915e-02, PNorm = 49.6615, GNorm = 0.4879, lr_0 = 2.2159e-04
Validation prc-auc = 0.578504
Validation auc = 0.881106
Epoch 20
Loss = 1.4037e-02, PNorm = 49.6928, GNorm = 0.3046, lr_0 = 2.1672e-04
Loss = 7.0523e-02, PNorm = 49.7168, GNorm = 0.9293, lr_0 = 2.1196e-04
Loss = 6.5020e-02, PNorm = 49.7478, GNorm = 0.3271, lr_0 = 2.0730e-04
Loss = 8.6254e-02, PNorm = 49.7683, GNorm = 0.8948, lr_0 = 2.0274e-04
Validation prc-auc = 0.594280
Validation auc = 0.849078
Epoch 21
Loss = 8.0856e-02, PNorm = 49.8031, GNorm = 0.2882, lr_0 = 1.9829e-04
Loss = 9.6087e-02, PNorm = 49.8180, GNorm = 0.5567, lr_0 = 1.9393e-04
Loss = 4.1312e-02, PNorm = 49.8505, GNorm = 0.3593, lr_0 = 1.8967e-04
Loss = 5.3636e-02, PNorm = 49.8697, GNorm = 0.4693, lr_0 = 1.8550e-04
Validation prc-auc = 0.559794
Validation auc = 0.843779
Epoch 22
Loss = 5.2017e-02, PNorm = 49.8937, GNorm = 0.6035, lr_0 = 1.8142e-04
Loss = 5.7780e-02, PNorm = 49.9072, GNorm = 0.7134, lr_0 = 1.7743e-04
Loss = 6.3914e-02, PNorm = 49.9329, GNorm = 0.5751, lr_0 = 1.7353e-04
Loss = 5.9019e-02, PNorm = 49.9515, GNorm = 0.3340, lr_0 = 1.6972e-04
Validation prc-auc = 0.578443
Validation auc = 0.885253
Epoch 23
Loss = 4.3052e-02, PNorm = 49.9748, GNorm = 0.2486, lr_0 = 1.6599e-04
Loss = 5.4655e-02, PNorm = 49.9895, GNorm = 0.8863, lr_0 = 1.6234e-04
Loss = 7.8908e-02, PNorm = 50.0152, GNorm = 1.3664, lr_0 = 1.5877e-04
Loss = 6.0661e-02, PNorm = 50.0204, GNorm = 0.3327, lr_0 = 1.5528e-04
Validation prc-auc = 0.590864
Validation auc = 0.898848
Epoch 24
Loss = 6.3601e-02, PNorm = 50.0453, GNorm = 0.2193, lr_0 = 1.5187e-04
Loss = 5.0677e-02, PNorm = 50.0618, GNorm = 0.2043, lr_0 = 1.4853e-04
Loss = 6.3413e-02, PNorm = 50.0878, GNorm = 0.5300, lr_0 = 1.4527e-04
Validation prc-auc = 0.586371
Validation auc = 0.877189
Epoch 25
Loss = 1.2152e-01, PNorm = 50.0983, GNorm = 1.2102, lr_0 = 1.4207e-04
Loss = 5.2986e-02, PNorm = 50.1203, GNorm = 0.9740, lr_0 = 1.3895e-04
Loss = 4.5255e-02, PNorm = 50.1366, GNorm = 1.1157, lr_0 = 1.3590e-04
Loss = 5.0722e-02, PNorm = 50.1482, GNorm = 0.3803, lr_0 = 1.3291e-04
Validation prc-auc = 0.514393
Validation auc = 0.845161
Epoch 26
Loss = 5.0630e-02, PNorm = 50.1675, GNorm = 1.1141, lr_0 = 1.2999e-04
Loss = 3.6136e-02, PNorm = 50.1788, GNorm = 0.1993, lr_0 = 1.2713e-04
Loss = 4.3283e-02, PNorm = 50.1976, GNorm = 0.5796, lr_0 = 1.2434e-04
Loss = 4.8050e-02, PNorm = 50.2034, GNorm = 0.7448, lr_0 = 1.2160e-04
Validation prc-auc = 0.504535
Validation auc = 0.831797
Epoch 27
Loss = 5.6288e-02, PNorm = 50.2171, GNorm = 0.3658, lr_0 = 1.1893e-04
Loss = 4.5623e-02, PNorm = 50.2305, GNorm = 0.6825, lr_0 = 1.1632e-04
Loss = 4.3369e-02, PNorm = 50.2435, GNorm = 0.3852, lr_0 = 1.1376e-04
Loss = 3.5416e-02, PNorm = 50.2574, GNorm = 0.6417, lr_0 = 1.1126e-04
Validation prc-auc = 0.534355
Validation auc = 0.864286
Epoch 28
Loss = 4.2210e-02, PNorm = 50.2673, GNorm = 0.5305, lr_0 = 1.0881e-04
Loss = 3.5134e-02, PNorm = 50.2738, GNorm = 0.3606, lr_0 = 1.0642e-04
Loss = 3.2379e-02, PNorm = 50.2851, GNorm = 0.4037, lr_0 = 1.0408e-04
Loss = 4.4708e-02, PNorm = 50.2956, GNorm = 0.6612, lr_0 = 1.0179e-04
Validation prc-auc = 0.526114
Validation auc = 0.869816
Epoch 29
Loss = 3.5107e-02, PNorm = 50.3107, GNorm = 0.2052, lr_0 = 1.0000e-04
Loss = 3.2449e-02, PNorm = 50.3224, GNorm = 0.1497, lr_0 = 1.0000e-04
Loss = 3.0283e-02, PNorm = 50.3330, GNorm = 0.2626, lr_0 = 1.0000e-04
Validation prc-auc = 0.491014
Validation auc = 0.842396
Model 0 best validation prc-auc = 0.664693 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.302903
Model 0 test auc = 0.648161
Ensemble test prc-auc = 0.302903
Ensemble test auc = 0.648161
Fold 15
Splitting data with seed 15
Total scaffolds = 1,115 | train scaffolds = 825 | val scaffolds = 158 | test scaffolds = 132
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.7795e-01, PNorm = 46.0447, GNorm = 3.6928, lr_0 = 2.3378e-04
Loss = 2.6968e-01, PNorm = 46.0597, GNorm = 1.3893, lr_0 = 3.5541e-04
Loss = 2.2003e-01, PNorm = 46.0885, GNorm = 0.9670, lr_0 = 4.7703e-04
Validation prc-auc = 0.233666
Validation auc = 0.781507
Epoch 1
Loss = 2.3096e-01, PNorm = 46.1178, GNorm = 0.8718, lr_0 = 6.1081e-04
Loss = 2.0768e-01, PNorm = 46.1427, GNorm = 0.4951, lr_0 = 7.3243e-04
Loss = 1.8182e-01, PNorm = 46.1827, GNorm = 0.3299, lr_0 = 8.5405e-04
Loss = 2.3253e-01, PNorm = 46.2322, GNorm = 0.2649, lr_0 = 9.7568e-04
Validation prc-auc = 0.356144
Validation auc = 0.824481
Epoch 2
Loss = 1.5131e-01, PNorm = 46.3050, GNorm = 0.3292, lr_0 = 9.8238e-04
Loss = 1.7582e-01, PNorm = 46.3876, GNorm = 0.4374, lr_0 = 9.6078e-04
Loss = 1.7213e-01, PNorm = 46.4661, GNorm = 0.3359, lr_0 = 9.3966e-04
Loss = 2.0700e-01, PNorm = 46.5271, GNorm = 0.3305, lr_0 = 9.1901e-04
Validation prc-auc = 0.364115
Validation auc = 0.801545
Epoch 3
Loss = 1.8788e-01, PNorm = 46.6278, GNorm = 0.9949, lr_0 = 8.9881e-04
Loss = 1.9857e-01, PNorm = 46.6847, GNorm = 0.8204, lr_0 = 8.7905e-04
Loss = 1.9566e-01, PNorm = 46.7830, GNorm = 1.1278, lr_0 = 8.5973e-04
Loss = 1.7190e-01, PNorm = 46.8512, GNorm = 0.2041, lr_0 = 8.4083e-04
Validation prc-auc = 0.442602
Validation auc = 0.853211
Epoch 4
Loss = 2.1018e-01, PNorm = 46.9301, GNorm = 0.9182, lr_0 = 8.2235e-04
Loss = 1.6006e-01, PNorm = 47.0325, GNorm = 0.2214, lr_0 = 8.0428e-04
Loss = 1.5219e-01, PNorm = 47.1170, GNorm = 0.8983, lr_0 = 7.8660e-04
Validation prc-auc = 0.419803
Validation auc = 0.832690
Epoch 5
Loss = 1.8094e-01, PNorm = 47.1660, GNorm = 0.4117, lr_0 = 7.6931e-04
Loss = 1.4908e-01, PNorm = 47.2237, GNorm = 0.5088, lr_0 = 7.5240e-04
Loss = 1.0966e-01, PNorm = 47.3163, GNorm = 0.1691, lr_0 = 7.3586e-04
Loss = 1.9220e-01, PNorm = 47.3600, GNorm = 0.8032, lr_0 = 7.1969e-04
Validation prc-auc = 0.407288
Validation auc = 0.786818
Epoch 6
Loss = 1.6638e-01, PNorm = 47.4245, GNorm = 0.2526, lr_0 = 7.0387e-04
Loss = 1.6421e-01, PNorm = 47.4963, GNorm = 0.2872, lr_0 = 6.8840e-04
Loss = 1.6569e-01, PNorm = 47.5785, GNorm = 0.8266, lr_0 = 6.7326e-04
Loss = 1.1329e-01, PNorm = 47.6574, GNorm = 0.2163, lr_0 = 6.5847e-04
Validation prc-auc = 0.457455
Validation auc = 0.866731
Epoch 7
Loss = 1.3129e-01, PNorm = 47.7000, GNorm = 0.5003, lr_0 = 6.4399e-04
Loss = 1.3771e-01, PNorm = 47.7470, GNorm = 0.6582, lr_0 = 6.2984e-04
Loss = 1.7141e-01, PNorm = 47.8151, GNorm = 0.3327, lr_0 = 6.1599e-04
Loss = 1.6047e-01, PNorm = 47.8839, GNorm = 1.4704, lr_0 = 6.0245e-04
Validation prc-auc = 0.447786
Validation auc = 0.852004
Epoch 8
Loss = 1.6796e-01, PNorm = 47.9585, GNorm = 0.9455, lr_0 = 5.8921e-04
Loss = 1.2058e-01, PNorm = 48.0163, GNorm = 0.2847, lr_0 = 5.7626e-04
Loss = 1.4026e-01, PNorm = 48.0940, GNorm = 0.9946, lr_0 = 5.6359e-04
Loss = 1.7925e-01, PNorm = 48.1382, GNorm = 0.5098, lr_0 = 5.5120e-04
Validation prc-auc = 0.449419
Validation auc = 0.842830
Epoch 9
Loss = 1.3575e-01, PNorm = 48.1905, GNorm = 0.9089, lr_0 = 5.3909e-04
Loss = 1.4178e-01, PNorm = 48.2540, GNorm = 0.1491, lr_0 = 5.2724e-04
Loss = 1.4176e-01, PNorm = 48.3093, GNorm = 0.4868, lr_0 = 5.1565e-04
Validation prc-auc = 0.443959
Validation auc = 0.828344
Epoch 10
Loss = 1.0596e-01, PNorm = 48.3393, GNorm = 0.2985, lr_0 = 5.0432e-04
Loss = 1.5476e-01, PNorm = 48.3940, GNorm = 0.3620, lr_0 = 4.9323e-04
Loss = 1.2773e-01, PNorm = 48.4533, GNorm = 0.1942, lr_0 = 4.8239e-04
Loss = 1.0666e-01, PNorm = 48.4874, GNorm = 0.4296, lr_0 = 4.7179e-04
Validation prc-auc = 0.454226
Validation auc = 0.835587
Epoch 11
Loss = 1.2024e-01, PNorm = 48.5258, GNorm = 0.3064, lr_0 = 4.6142e-04
Loss = 1.2702e-01, PNorm = 48.5686, GNorm = 0.4703, lr_0 = 4.5127e-04
Loss = 1.1338e-01, PNorm = 48.6016, GNorm = 0.2915, lr_0 = 4.4135e-04
Loss = 1.2030e-01, PNorm = 48.6377, GNorm = 0.2304, lr_0 = 4.3165e-04
Validation prc-auc = 0.446686
Validation auc = 0.829551
Epoch 12
Loss = 8.3641e-02, PNorm = 48.6998, GNorm = 0.2907, lr_0 = 4.2217e-04
Loss = 1.5884e-01, PNorm = 48.7437, GNorm = 0.9346, lr_0 = 4.1289e-04
Loss = 1.2763e-01, PNorm = 48.8236, GNorm = 0.3199, lr_0 = 4.0381e-04
Loss = 1.1287e-01, PNorm = 48.8571, GNorm = 0.7041, lr_0 = 3.9493e-04
Validation prc-auc = 0.448933
Validation auc = 0.813617
Epoch 13
Loss = 1.2473e-01, PNorm = 48.9031, GNorm = 0.2806, lr_0 = 3.8625e-04
Loss = 9.8430e-02, PNorm = 48.9515, GNorm = 0.2320, lr_0 = 3.7776e-04
Loss = 1.2553e-01, PNorm = 48.9815, GNorm = 0.4524, lr_0 = 3.6946e-04
Loss = 1.2579e-01, PNorm = 49.0216, GNorm = 0.6670, lr_0 = 3.6134e-04
Validation prc-auc = 0.432322
Validation auc = 0.790439
Epoch 14
Loss = 8.7479e-02, PNorm = 49.0659, GNorm = 0.1948, lr_0 = 3.5340e-04
Loss = 9.1374e-02, PNorm = 49.1150, GNorm = 0.2981, lr_0 = 3.4563e-04
Loss = 1.2446e-01, PNorm = 49.1560, GNorm = 0.5444, lr_0 = 3.3803e-04
Validation prc-auc = 0.402318
Validation auc = 0.782472
Epoch 15
Loss = 6.5907e-02, PNorm = 49.2017, GNorm = 0.2299, lr_0 = 3.3060e-04
Loss = 8.8247e-02, PNorm = 49.2543, GNorm = 0.3013, lr_0 = 3.2333e-04
Loss = 1.2020e-01, PNorm = 49.2827, GNorm = 0.5536, lr_0 = 3.1623e-04
Loss = 1.0854e-01, PNorm = 49.3225, GNorm = 0.7169, lr_0 = 3.0928e-04
Validation prc-auc = 0.422409
Validation auc = 0.801062
Epoch 16
Loss = 1.3610e-01, PNorm = 49.3664, GNorm = 0.4094, lr_0 = 3.0248e-04
Loss = 1.0838e-01, PNorm = 49.4121, GNorm = 0.3728, lr_0 = 2.9583e-04
Loss = 1.1591e-01, PNorm = 49.4512, GNorm = 0.3853, lr_0 = 2.8933e-04
Loss = 8.4816e-02, PNorm = 49.4920, GNorm = 0.5901, lr_0 = 2.8297e-04
Validation prc-auc = 0.443120
Validation auc = 0.797924
Epoch 17
Loss = 8.3596e-02, PNorm = 49.5220, GNorm = 0.7962, lr_0 = 2.7675e-04
Loss = 9.4864e-02, PNorm = 49.5572, GNorm = 0.2167, lr_0 = 2.7067e-04
Loss = 9.7762e-02, PNorm = 49.5847, GNorm = 0.4928, lr_0 = 2.6472e-04
Loss = 9.8242e-02, PNorm = 49.6153, GNorm = 0.5411, lr_0 = 2.5890e-04
Validation prc-auc = 0.379312
Validation auc = 0.786094
Epoch 18
Loss = 9.6212e-02, PNorm = 49.6485, GNorm = 0.6353, lr_0 = 2.5321e-04
Loss = 6.7819e-02, PNorm = 49.6743, GNorm = 0.2297, lr_0 = 2.4764e-04
Loss = 1.1000e-01, PNorm = 49.7050, GNorm = 0.4490, lr_0 = 2.4220e-04
Loss = 8.0141e-02, PNorm = 49.7381, GNorm = 0.3697, lr_0 = 2.3687e-04
Validation prc-auc = 0.398796
Validation auc = 0.767262
Epoch 19
Loss = 8.4622e-02, PNorm = 49.7729, GNorm = 0.3296, lr_0 = 2.3167e-04
Loss = 9.2272e-02, PNorm = 49.8036, GNorm = 0.8275, lr_0 = 2.2658e-04
Loss = 9.6888e-02, PNorm = 49.8408, GNorm = 0.8590, lr_0 = 2.2159e-04
Validation prc-auc = 0.367455
Validation auc = 0.747224
Epoch 20
Loss = 1.0061e-01, PNorm = 49.8674, GNorm = 0.7681, lr_0 = 2.1672e-04
Loss = 8.5230e-02, PNorm = 49.8941, GNorm = 0.3728, lr_0 = 2.1196e-04
Loss = 9.6207e-02, PNorm = 49.9297, GNorm = 0.3144, lr_0 = 2.0730e-04
Loss = 5.7775e-02, PNorm = 49.9609, GNorm = 0.1405, lr_0 = 2.0274e-04
Validation prc-auc = 0.456799
Validation auc = 0.800338
Epoch 21
Loss = 1.0217e-01, PNorm = 49.9772, GNorm = 0.3705, lr_0 = 1.9829e-04
Loss = 5.2159e-02, PNorm = 50.0116, GNorm = 0.3532, lr_0 = 1.9393e-04
Loss = 7.8403e-02, PNorm = 50.0275, GNorm = 0.4332, lr_0 = 1.8967e-04
Loss = 8.1962e-02, PNorm = 50.0540, GNorm = 0.6612, lr_0 = 1.8550e-04
Validation prc-auc = 0.366442
Validation auc = 0.745292
Epoch 22
Loss = 5.3865e-02, PNorm = 50.0696, GNorm = 0.4919, lr_0 = 1.8142e-04
Loss = 6.7461e-02, PNorm = 50.0867, GNorm = 0.1888, lr_0 = 1.7743e-04
Loss = 5.1970e-02, PNorm = 50.1098, GNorm = 0.5745, lr_0 = 1.7353e-04
Loss = 8.1749e-02, PNorm = 50.1300, GNorm = 0.3768, lr_0 = 1.6972e-04
Validation prc-auc = 0.387226
Validation auc = 0.760261
Epoch 23
Loss = 6.7842e-02, PNorm = 50.1526, GNorm = 0.5043, lr_0 = 1.6599e-04
Loss = 4.1514e-02, PNorm = 50.1771, GNorm = 0.3997, lr_0 = 1.6234e-04
Loss = 5.5848e-02, PNorm = 50.1955, GNorm = 0.5755, lr_0 = 1.5877e-04
Loss = 7.3555e-02, PNorm = 50.2145, GNorm = 1.2278, lr_0 = 1.5528e-04
Validation prc-auc = 0.366653
Validation auc = 0.716562
Epoch 24
Loss = 4.7172e-02, PNorm = 50.2351, GNorm = 0.2862, lr_0 = 1.5187e-04
Loss = 6.4071e-02, PNorm = 50.2491, GNorm = 0.7911, lr_0 = 1.4853e-04
Loss = 8.0653e-02, PNorm = 50.2779, GNorm = 0.2177, lr_0 = 1.4527e-04
Validation prc-auc = 0.350470
Validation auc = 0.735152
Epoch 25
Loss = 1.0805e-02, PNorm = 50.2954, GNorm = 0.1810, lr_0 = 1.4207e-04
Loss = 5.3690e-02, PNorm = 50.3030, GNorm = 0.4595, lr_0 = 1.3895e-04
Loss = 6.7210e-02, PNorm = 50.3220, GNorm = 0.5583, lr_0 = 1.3590e-04
Loss = 7.1622e-02, PNorm = 50.3391, GNorm = 1.1048, lr_0 = 1.3291e-04
Validation prc-auc = 0.367916
Validation auc = 0.733945
Epoch 26
Loss = 5.1589e-02, PNorm = 50.3580, GNorm = 0.7493, lr_0 = 1.2999e-04
Loss = 5.4623e-02, PNorm = 50.3697, GNorm = 0.1928, lr_0 = 1.2713e-04
Loss = 4.8194e-02, PNorm = 50.3856, GNorm = 0.5444, lr_0 = 1.2434e-04
Loss = 5.2417e-02, PNorm = 50.4003, GNorm = 0.5085, lr_0 = 1.2160e-04
Validation prc-auc = 0.304057
Validation auc = 0.721632
Epoch 27
Loss = 7.0180e-02, PNorm = 50.4167, GNorm = 0.7215, lr_0 = 1.1893e-04
Loss = 5.7388e-02, PNorm = 50.4356, GNorm = 2.0060, lr_0 = 1.1632e-04
Loss = 3.5261e-02, PNorm = 50.4457, GNorm = 0.7992, lr_0 = 1.1376e-04
Loss = 3.5145e-02, PNorm = 50.4569, GNorm = 0.7465, lr_0 = 1.1126e-04
Validation prc-auc = 0.413081
Validation auc = 0.735876
Epoch 28
Loss = 2.9957e-02, PNorm = 50.4719, GNorm = 0.4156, lr_0 = 1.0881e-04
Loss = 4.8710e-02, PNorm = 50.4832, GNorm = 0.6790, lr_0 = 1.0642e-04
Loss = 5.5169e-02, PNorm = 50.4967, GNorm = 0.6473, lr_0 = 1.0408e-04
Loss = 4.5463e-02, PNorm = 50.5063, GNorm = 0.4784, lr_0 = 1.0179e-04
Validation prc-auc = 0.358890
Validation auc = 0.733945
Epoch 29
Loss = 3.0995e-02, PNorm = 50.5211, GNorm = 0.3128, lr_0 = 1.0000e-04
Loss = 4.5536e-02, PNorm = 50.5294, GNorm = 0.9115, lr_0 = 1.0000e-04
Loss = 5.7762e-02, PNorm = 50.5449, GNorm = 1.7405, lr_0 = 1.0000e-04
Validation prc-auc = 0.362605
Validation auc = 0.744568
Model 0 best validation prc-auc = 0.457455 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.175001
Model 0 test auc = 0.682018
Ensemble test prc-auc = 0.175001
Ensemble test auc = 0.682018
Fold 16
Splitting data with seed 16
Total scaffolds = 1,115 | train scaffolds = 849 | val scaffolds = 153 | test scaffolds = 113
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.5523e-01, PNorm = 46.0443, GNorm = 0.5323, lr_0 = 2.3378e-04
Loss = 2.3314e-01, PNorm = 46.0627, GNorm = 0.5005, lr_0 = 3.5541e-04
Loss = 3.0555e-01, PNorm = 46.0832, GNorm = 0.3412, lr_0 = 4.7703e-04
Validation prc-auc = 0.183574
Validation auc = 0.533540
Epoch 1
Loss = 2.3330e-01, PNorm = 46.1089, GNorm = 0.3278, lr_0 = 6.1081e-04
Loss = 2.1904e-01, PNorm = 46.1405, GNorm = 0.5459, lr_0 = 7.3243e-04
Loss = 2.5429e-01, PNorm = 46.1865, GNorm = 0.4728, lr_0 = 8.5405e-04
Loss = 2.2709e-01, PNorm = 46.2362, GNorm = 0.4165, lr_0 = 9.7568e-04
Validation prc-auc = 0.180235
Validation auc = 0.575776
Epoch 2
Loss = 1.8201e-01, PNorm = 46.3198, GNorm = 0.2260, lr_0 = 9.8238e-04
Loss = 2.7338e-01, PNorm = 46.3882, GNorm = 0.8766, lr_0 = 9.6078e-04
Loss = 2.0993e-01, PNorm = 46.4959, GNorm = 0.2871, lr_0 = 9.3966e-04
Loss = 2.1518e-01, PNorm = 46.5717, GNorm = 0.3522, lr_0 = 9.1901e-04
Validation prc-auc = 0.182713
Validation auc = 0.554037
Epoch 3
Loss = 2.0608e-01, PNorm = 46.6352, GNorm = 0.2608, lr_0 = 8.9881e-04
Loss = 2.2109e-01, PNorm = 46.7033, GNorm = 0.3855, lr_0 = 8.7905e-04
Loss = 1.8096e-01, PNorm = 46.7723, GNorm = 0.3069, lr_0 = 8.5973e-04
Loss = 1.9567e-01, PNorm = 46.8227, GNorm = 0.3163, lr_0 = 8.4083e-04
Validation prc-auc = 0.184155
Validation auc = 0.606211
Epoch 4
Loss = 1.8000e-01, PNorm = 46.8897, GNorm = 0.2250, lr_0 = 8.2235e-04
Loss = 1.3772e-01, PNorm = 46.9774, GNorm = 0.8698, lr_0 = 8.0428e-04
Loss = 2.3919e-01, PNorm = 47.0385, GNorm = 0.8313, lr_0 = 7.8660e-04
Validation prc-auc = 0.181799
Validation auc = 0.642857
Epoch 5
Loss = 1.9941e-01, PNorm = 47.1000, GNorm = 0.1970, lr_0 = 7.6931e-04
Loss = 1.6730e-01, PNorm = 47.1722, GNorm = 0.5445, lr_0 = 7.5240e-04
Loss = 2.0714e-01, PNorm = 47.2431, GNorm = 0.2161, lr_0 = 7.3586e-04
Loss = 1.6640e-01, PNorm = 47.3201, GNorm = 0.1978, lr_0 = 7.1969e-04
Validation prc-auc = 0.191377
Validation auc = 0.652795
Epoch 6
Loss = 1.8925e-01, PNorm = 47.3850, GNorm = 0.4016, lr_0 = 7.0387e-04
Loss = 1.7641e-01, PNorm = 47.4443, GNorm = 0.3293, lr_0 = 6.8840e-04
Loss = 1.5904e-01, PNorm = 47.5355, GNorm = 0.6842, lr_0 = 6.7326e-04
Loss = 1.8393e-01, PNorm = 47.5874, GNorm = 0.4775, lr_0 = 6.5847e-04
Validation prc-auc = 0.193757
Validation auc = 0.651553
Epoch 7
Loss = 1.6057e-01, PNorm = 47.6350, GNorm = 0.4806, lr_0 = 6.4399e-04
Loss = 1.5985e-01, PNorm = 47.7013, GNorm = 0.6269, lr_0 = 6.2984e-04
Loss = 1.7210e-01, PNorm = 47.7551, GNorm = 0.4534, lr_0 = 6.1599e-04
Loss = 1.0807e-01, PNorm = 47.8070, GNorm = 0.8216, lr_0 = 6.0245e-04
Validation prc-auc = 0.192280
Validation auc = 0.511801
Epoch 8
Loss = 1.6288e-01, PNorm = 47.8911, GNorm = 0.7127, lr_0 = 5.8921e-04
Loss = 1.5772e-01, PNorm = 47.9550, GNorm = 0.2619, lr_0 = 5.7626e-04
Loss = 1.4098e-01, PNorm = 48.0095, GNorm = 0.7728, lr_0 = 5.6359e-04
Loss = 1.7115e-01, PNorm = 48.0677, GNorm = 0.2724, lr_0 = 5.5120e-04
Validation prc-auc = 0.204718
Validation auc = 0.548447
Epoch 9
Loss = 1.2256e-01, PNorm = 48.1148, GNorm = 0.3624, lr_0 = 5.3909e-04
Loss = 1.6319e-01, PNorm = 48.1884, GNorm = 0.3231, lr_0 = 5.2724e-04
Loss = 1.2978e-01, PNorm = 48.2479, GNorm = 0.4915, lr_0 = 5.1565e-04
Validation prc-auc = 0.195669
Validation auc = 0.552174
Epoch 10
Loss = 1.1970e-01, PNorm = 48.2891, GNorm = 0.3403, lr_0 = 5.0432e-04
Loss = 1.3404e-01, PNorm = 48.3475, GNorm = 0.3843, lr_0 = 4.9323e-04
Loss = 1.1152e-01, PNorm = 48.4084, GNorm = 0.2273, lr_0 = 4.8239e-04
Loss = 1.7489e-01, PNorm = 48.4530, GNorm = 0.4285, lr_0 = 4.7179e-04
Validation prc-auc = 0.195834
Validation auc = 0.652795
Epoch 11
Loss = 1.7528e-01, PNorm = 48.5168, GNorm = 0.7016, lr_0 = 4.6142e-04
Loss = 1.1160e-01, PNorm = 48.5780, GNorm = 0.5446, lr_0 = 4.5127e-04
Loss = 1.7507e-01, PNorm = 48.6128, GNorm = 0.5914, lr_0 = 4.4135e-04
Loss = 1.1509e-01, PNorm = 48.6847, GNorm = 0.5054, lr_0 = 4.3165e-04
Validation prc-auc = 0.207988
Validation auc = 0.665217
Epoch 12
Loss = 1.2502e-01, PNorm = 48.7202, GNorm = 0.6152, lr_0 = 4.2217e-04
Loss = 1.3061e-01, PNorm = 48.7736, GNorm = 0.4253, lr_0 = 4.1289e-04
Loss = 8.9950e-02, PNorm = 48.8143, GNorm = 0.4556, lr_0 = 4.0381e-04
Loss = 1.5532e-01, PNorm = 48.8582, GNorm = 0.7098, lr_0 = 3.9493e-04
Validation prc-auc = 0.221195
Validation auc = 0.588199
Epoch 13
Loss = 1.1971e-01, PNorm = 48.8930, GNorm = 0.5616, lr_0 = 3.8625e-04
Loss = 1.2656e-01, PNorm = 48.9421, GNorm = 0.3313, lr_0 = 3.7776e-04
Loss = 1.2397e-01, PNorm = 48.9989, GNorm = 0.4418, lr_0 = 3.6946e-04
Loss = 1.2978e-01, PNorm = 49.0414, GNorm = 0.3492, lr_0 = 3.6134e-04
Validation prc-auc = 0.235740
Validation auc = 0.580745
Epoch 14
Loss = 8.3416e-02, PNorm = 49.0875, GNorm = 0.3412, lr_0 = 3.5340e-04
Loss = 1.1986e-01, PNorm = 49.1360, GNorm = 0.4591, lr_0 = 3.4563e-04
Loss = 1.5160e-01, PNorm = 49.1673, GNorm = 0.4150, lr_0 = 3.3803e-04
Validation prc-auc = 0.231147
Validation auc = 0.604969
Epoch 15
Loss = 2.2242e-01, PNorm = 49.2187, GNorm = 0.4828, lr_0 = 3.3060e-04
Loss = 1.1585e-01, PNorm = 49.2612, GNorm = 0.5206, lr_0 = 3.2333e-04
Loss = 9.4297e-02, PNorm = 49.3140, GNorm = 0.2759, lr_0 = 3.1623e-04
Loss = 1.0823e-01, PNorm = 49.3457, GNorm = 0.5587, lr_0 = 3.0928e-04
Validation prc-auc = 0.220807
Validation auc = 0.563975
Epoch 16
Loss = 8.0740e-02, PNorm = 49.3821, GNorm = 0.3641, lr_0 = 3.0248e-04
Loss = 1.1644e-01, PNorm = 49.4187, GNorm = 0.7528, lr_0 = 2.9583e-04
Loss = 1.0972e-01, PNorm = 49.4728, GNorm = 0.4779, lr_0 = 2.8933e-04
Loss = 1.0068e-01, PNorm = 49.5071, GNorm = 0.9486, lr_0 = 2.8297e-04
Validation prc-auc = 0.251153
Validation auc = 0.594410
Epoch 17
Loss = 1.0882e-01, PNorm = 49.5629, GNorm = 0.6326, lr_0 = 2.7675e-04
Loss = 7.9301e-02, PNorm = 49.6025, GNorm = 0.6860, lr_0 = 2.7067e-04
Loss = 1.3028e-01, PNorm = 49.6436, GNorm = 0.5869, lr_0 = 2.6472e-04
Loss = 9.2969e-02, PNorm = 49.6878, GNorm = 0.1901, lr_0 = 2.5890e-04
Validation prc-auc = 0.243986
Validation auc = 0.648447
Epoch 18
Loss = 8.5183e-02, PNorm = 49.7263, GNorm = 1.0216, lr_0 = 2.5321e-04
Loss = 8.9749e-02, PNorm = 49.7505, GNorm = 0.7755, lr_0 = 2.4764e-04
Loss = 9.7906e-02, PNorm = 49.7898, GNorm = 0.9320, lr_0 = 2.4220e-04
Loss = 1.3980e-01, PNorm = 49.8226, GNorm = 1.0398, lr_0 = 2.3687e-04
Validation prc-auc = 0.235062
Validation auc = 0.659006
Epoch 19
Loss = 1.0822e-01, PNorm = 49.8685, GNorm = 0.6309, lr_0 = 2.3167e-04
Loss = 7.2539e-02, PNorm = 49.9053, GNorm = 0.2727, lr_0 = 2.2658e-04
Loss = 9.8225e-02, PNorm = 49.9319, GNorm = 0.7223, lr_0 = 2.2159e-04
Validation prc-auc = 0.257861
Validation auc = 0.595652
Epoch 20
Loss = 1.1590e-01, PNorm = 49.9510, GNorm = 0.5364, lr_0 = 2.1672e-04
Loss = 7.7648e-02, PNorm = 49.9855, GNorm = 0.3177, lr_0 = 2.1196e-04
Loss = 7.4224e-02, PNorm = 50.0061, GNorm = 0.5440, lr_0 = 2.0730e-04
Loss = 9.5771e-02, PNorm = 50.0402, GNorm = 0.3283, lr_0 = 2.0274e-04
Validation prc-auc = 0.231237
Validation auc = 0.590062
Epoch 21
Loss = 7.3656e-02, PNorm = 50.0667, GNorm = 0.4756, lr_0 = 1.9829e-04
Loss = 8.9265e-02, PNorm = 50.0989, GNorm = 0.6367, lr_0 = 1.9393e-04
Loss = 5.9615e-02, PNorm = 50.1310, GNorm = 0.2279, lr_0 = 1.8967e-04
Loss = 8.3476e-02, PNorm = 50.1596, GNorm = 0.5931, lr_0 = 1.8550e-04
Validation prc-auc = 0.265336
Validation auc = 0.621739
Epoch 22
Loss = 7.9573e-02, PNorm = 50.1848, GNorm = 0.6447, lr_0 = 1.8142e-04
Loss = 6.3234e-02, PNorm = 50.2177, GNorm = 0.8851, lr_0 = 1.7743e-04
Loss = 7.8918e-02, PNorm = 50.2395, GNorm = 0.5229, lr_0 = 1.7353e-04
Loss = 8.5666e-02, PNorm = 50.2671, GNorm = 0.2268, lr_0 = 1.6972e-04
Validation prc-auc = 0.263447
Validation auc = 0.637888
Epoch 23
Loss = 5.3825e-02, PNorm = 50.2855, GNorm = 0.5429, lr_0 = 1.6599e-04
Loss = 6.4128e-02, PNorm = 50.3181, GNorm = 1.0453, lr_0 = 1.6234e-04
Loss = 1.0654e-01, PNorm = 50.3260, GNorm = 1.1561, lr_0 = 1.5877e-04
Loss = 7.4541e-02, PNorm = 50.3552, GNorm = 0.8446, lr_0 = 1.5528e-04
Validation prc-auc = 0.272841
Validation auc = 0.644099
Epoch 24
Loss = 4.2565e-02, PNorm = 50.3744, GNorm = 0.2536, lr_0 = 1.5187e-04
Loss = 6.0772e-02, PNorm = 50.3926, GNorm = 0.6368, lr_0 = 1.4853e-04
Loss = 7.7157e-02, PNorm = 50.4126, GNorm = 1.1082, lr_0 = 1.4527e-04
Validation prc-auc = 0.260752
Validation auc = 0.608075
Epoch 25
Loss = 9.7970e-02, PNorm = 50.4395, GNorm = 0.8129, lr_0 = 1.4207e-04
Loss = 7.0735e-02, PNorm = 50.4543, GNorm = 0.8778, lr_0 = 1.3895e-04
Loss = 5.7951e-02, PNorm = 50.4762, GNorm = 0.1636, lr_0 = 1.3590e-04
Loss = 4.4840e-02, PNorm = 50.4959, GNorm = 0.6055, lr_0 = 1.3291e-04
Validation prc-auc = 0.273471
Validation auc = 0.599379
Epoch 26
Loss = 5.8038e-02, PNorm = 50.5105, GNorm = 0.3923, lr_0 = 1.2999e-04
Loss = 4.7575e-02, PNorm = 50.5296, GNorm = 1.3814, lr_0 = 1.2713e-04
Loss = 6.1172e-02, PNorm = 50.5439, GNorm = 0.7307, lr_0 = 1.2434e-04
Loss = 5.8226e-02, PNorm = 50.5636, GNorm = 0.6354, lr_0 = 1.2160e-04
Validation prc-auc = 0.299816
Validation auc = 0.655280
Epoch 27
Loss = 6.7257e-02, PNorm = 50.5789, GNorm = 0.2895, lr_0 = 1.1893e-04
Loss = 6.1115e-02, PNorm = 50.5910, GNorm = 0.7802, lr_0 = 1.1632e-04
Loss = 3.5930e-02, PNorm = 50.6087, GNorm = 1.0112, lr_0 = 1.1376e-04
Loss = 4.4011e-02, PNorm = 50.6193, GNorm = 0.3805, lr_0 = 1.1126e-04
Validation prc-auc = 0.308777
Validation auc = 0.627950
Epoch 28
Loss = 4.7336e-02, PNorm = 50.6322, GNorm = 0.3744, lr_0 = 1.0881e-04
Loss = 5.2019e-02, PNorm = 50.6436, GNorm = 0.9173, lr_0 = 1.0642e-04
Loss = 4.0737e-02, PNorm = 50.6588, GNorm = 0.4925, lr_0 = 1.0408e-04
Loss = 6.2234e-02, PNorm = 50.6714, GNorm = 0.5323, lr_0 = 1.0179e-04
Validation prc-auc = 0.306252
Validation auc = 0.613043
Epoch 29
Loss = 4.2226e-02, PNorm = 50.6821, GNorm = 0.2374, lr_0 = 1.0000e-04
Loss = 5.0071e-02, PNorm = 50.6911, GNorm = 0.5465, lr_0 = 1.0000e-04
Loss = 4.3685e-02, PNorm = 50.7038, GNorm = 0.3365, lr_0 = 1.0000e-04
Validation prc-auc = 0.201179
Validation auc = 0.618634
Model 0 best validation prc-auc = 0.308777 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.295104
Model 0 test auc = 0.717183
Ensemble test prc-auc = 0.295104
Ensemble test auc = 0.717183
Fold 17
Splitting data with seed 17
Total scaffolds = 1,115 | train scaffolds = 837 | val scaffolds = 133 | test scaffolds = 145
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.5257e-01, PNorm = 46.0437, GNorm = 0.2880, lr_0 = 2.3378e-04
Loss = 2.1754e-01, PNorm = 46.0588, GNorm = 0.7797, lr_0 = 3.5541e-04
Loss = 2.2026e-01, PNorm = 46.0829, GNorm = 0.7385, lr_0 = 4.7703e-04
Validation prc-auc = 0.367804
Validation auc = 0.721208
Epoch 1
Loss = 2.0568e-01, PNorm = 46.1111, GNorm = 0.2457, lr_0 = 6.1081e-04
Loss = 2.1784e-01, PNorm = 46.1440, GNorm = 0.2267, lr_0 = 7.3243e-04
Loss = 1.7921e-01, PNorm = 46.1770, GNorm = 0.1943, lr_0 = 8.5405e-04
Loss = 2.1397e-01, PNorm = 46.2308, GNorm = 0.3340, lr_0 = 9.7568e-04
Validation prc-auc = 0.472087
Validation auc = 0.798072
Epoch 2
Loss = 1.9542e-01, PNorm = 46.2962, GNorm = 0.3781, lr_0 = 9.8238e-04
Loss = 2.4796e-01, PNorm = 46.3540, GNorm = 0.9114, lr_0 = 9.6078e-04
Loss = 1.9607e-01, PNorm = 46.4385, GNorm = 0.1635, lr_0 = 9.3966e-04
Loss = 1.3884e-01, PNorm = 46.5328, GNorm = 0.2978, lr_0 = 9.1901e-04
Validation prc-auc = 0.419352
Validation auc = 0.698630
Epoch 3
Loss = 1.8021e-01, PNorm = 46.6084, GNorm = 0.3988, lr_0 = 8.9881e-04
Loss = 2.0600e-01, PNorm = 46.6758, GNorm = 0.7994, lr_0 = 8.7905e-04
Loss = 1.7324e-01, PNorm = 46.7516, GNorm = 0.2038, lr_0 = 8.5973e-04
Loss = 1.4166e-01, PNorm = 46.8022, GNorm = 0.4498, lr_0 = 8.4083e-04
Validation prc-auc = 0.513019
Validation auc = 0.856672
Epoch 4
Loss = 1.6551e-01, PNorm = 46.8502, GNorm = 0.5641, lr_0 = 8.2235e-04
Loss = 1.8878e-01, PNorm = 46.9192, GNorm = 0.2430, lr_0 = 8.0428e-04
Loss = 1.6205e-01, PNorm = 46.9928, GNorm = 0.4567, lr_0 = 7.8660e-04
Validation prc-auc = 0.521481
Validation auc = 0.853120
Epoch 5
Loss = 2.8257e-01, PNorm = 47.0487, GNorm = 0.5313, lr_0 = 7.6931e-04
Loss = 1.2756e-01, PNorm = 47.1105, GNorm = 0.1977, lr_0 = 7.5240e-04
Loss = 1.6988e-01, PNorm = 47.1728, GNorm = 1.1990, lr_0 = 7.3586e-04
Loss = 1.8870e-01, PNorm = 47.2303, GNorm = 0.3177, lr_0 = 7.1969e-04
Validation prc-auc = 0.573169
Validation auc = 0.838407
Epoch 6
Loss = 2.0306e-01, PNorm = 47.2992, GNorm = 0.2448, lr_0 = 7.0387e-04
Loss = 1.5532e-01, PNorm = 47.4035, GNorm = 0.3661, lr_0 = 6.8840e-04
Loss = 1.1506e-01, PNorm = 47.4883, GNorm = 0.0959, lr_0 = 6.7326e-04
Loss = 1.7327e-01, PNorm = 47.4952, GNorm = 0.8020, lr_0 = 6.5847e-04
Validation prc-auc = 0.526450
Validation auc = 0.833587
Epoch 7
Loss = 1.1896e-01, PNorm = 47.5681, GNorm = 0.2279, lr_0 = 6.4399e-04
Loss = 1.5323e-01, PNorm = 47.6218, GNorm = 0.5274, lr_0 = 6.2984e-04
Loss = 1.3880e-01, PNorm = 47.6716, GNorm = 0.2473, lr_0 = 6.1599e-04
Loss = 1.7028e-01, PNorm = 47.7239, GNorm = 0.8718, lr_0 = 6.0245e-04
Validation prc-auc = 0.619150
Validation auc = 0.860223
Epoch 8
Loss = 1.4638e-01, PNorm = 47.7920, GNorm = 0.2394, lr_0 = 5.8921e-04
Loss = 1.5333e-01, PNorm = 47.8533, GNorm = 0.2996, lr_0 = 5.7626e-04
Loss = 1.3745e-01, PNorm = 47.9010, GNorm = 0.2227, lr_0 = 5.6359e-04
Loss = 1.5264e-01, PNorm = 47.9499, GNorm = 0.3078, lr_0 = 5.5120e-04
Validation prc-auc = 0.686734
Validation auc = 0.901319
Epoch 9
Loss = 1.5394e-01, PNorm = 48.0062, GNorm = 0.3632, lr_0 = 5.3909e-04
Loss = 1.3547e-01, PNorm = 48.0705, GNorm = 0.6661, lr_0 = 5.2724e-04
Loss = 1.1649e-01, PNorm = 48.1149, GNorm = 0.1978, lr_0 = 5.1565e-04
Validation prc-auc = 0.649276
Validation auc = 0.845510
Epoch 10
Loss = 1.3974e-01, PNorm = 48.1705, GNorm = 0.2092, lr_0 = 5.0432e-04
Loss = 1.2212e-01, PNorm = 48.2240, GNorm = 0.4223, lr_0 = 4.9323e-04
Loss = 1.5775e-01, PNorm = 48.2706, GNorm = 0.3757, lr_0 = 4.8239e-04
Loss = 1.2778e-01, PNorm = 48.3223, GNorm = 0.4889, lr_0 = 4.7179e-04
Validation prc-auc = 0.705262
Validation auc = 0.867580
Epoch 11
Loss = 2.5611e-01, PNorm = 48.3561, GNorm = 0.4022, lr_0 = 4.6142e-04
Loss = 1.2116e-01, PNorm = 48.4093, GNorm = 0.3347, lr_0 = 4.5127e-04
Loss = 1.0844e-01, PNorm = 48.4591, GNorm = 0.1830, lr_0 = 4.4135e-04
Loss = 8.6516e-02, PNorm = 48.5126, GNorm = 0.2857, lr_0 = 4.3165e-04
Validation prc-auc = 0.720160
Validation auc = 0.883054
Epoch 12
Loss = 1.1964e-01, PNorm = 48.5358, GNorm = 0.5414, lr_0 = 4.2217e-04
Loss = 1.1774e-01, PNorm = 48.5838, GNorm = 0.5153, lr_0 = 4.1289e-04
Loss = 1.2937e-01, PNorm = 48.6441, GNorm = 0.2693, lr_0 = 4.0381e-04
Loss = 9.2362e-02, PNorm = 48.6883, GNorm = 0.2466, lr_0 = 3.9493e-04
Validation prc-auc = 0.707344
Validation auc = 0.860477
Epoch 13
Loss = 1.2150e-01, PNorm = 48.7335, GNorm = 0.3666, lr_0 = 3.8625e-04
Loss = 1.0750e-01, PNorm = 48.7840, GNorm = 0.5588, lr_0 = 3.7776e-04
Loss = 1.0353e-01, PNorm = 48.8395, GNorm = 0.5607, lr_0 = 3.6946e-04
Loss = 1.1700e-01, PNorm = 48.8745, GNorm = 0.7633, lr_0 = 3.6134e-04
Validation prc-auc = 0.749865
Validation auc = 0.900051
Epoch 14
Loss = 1.0192e-01, PNorm = 48.9238, GNorm = 0.2276, lr_0 = 3.5340e-04
Loss = 1.1387e-01, PNorm = 48.9645, GNorm = 0.9403, lr_0 = 3.4563e-04
Loss = 9.4860e-02, PNorm = 49.0094, GNorm = 0.4525, lr_0 = 3.3803e-04
Validation prc-auc = 0.674949
Validation auc = 0.869863
Epoch 15
Loss = 8.7092e-02, PNorm = 49.0457, GNorm = 0.6432, lr_0 = 3.3060e-04
Loss = 1.0115e-01, PNorm = 49.0916, GNorm = 0.3429, lr_0 = 3.2333e-04
Loss = 1.1003e-01, PNorm = 49.1280, GNorm = 0.3563, lr_0 = 3.1623e-04
Loss = 9.4863e-02, PNorm = 49.1631, GNorm = 1.0269, lr_0 = 3.0928e-04
Validation prc-auc = 0.741803
Validation auc = 0.888635
Epoch 16
Loss = 1.3468e-01, PNorm = 49.1861, GNorm = 0.4259, lr_0 = 3.0248e-04
Loss = 9.3851e-02, PNorm = 49.2203, GNorm = 0.2514, lr_0 = 2.9583e-04
Loss = 9.7619e-02, PNorm = 49.2607, GNorm = 0.8673, lr_0 = 2.8933e-04
Loss = 1.1307e-01, PNorm = 49.2876, GNorm = 1.3195, lr_0 = 2.8297e-04
Validation prc-auc = 0.695857
Validation auc = 0.859209
Epoch 17
Loss = 7.4989e-02, PNorm = 49.3256, GNorm = 0.4926, lr_0 = 2.7675e-04
Loss = 8.0875e-02, PNorm = 49.3509, GNorm = 0.4260, lr_0 = 2.7067e-04
Loss = 9.6080e-02, PNorm = 49.3934, GNorm = 0.2203, lr_0 = 2.6472e-04
Loss = 1.1831e-01, PNorm = 49.4087, GNorm = 0.3673, lr_0 = 2.5890e-04
Validation prc-auc = 0.708469
Validation auc = 0.865043
Epoch 18
Loss = 7.3716e-02, PNorm = 49.4581, GNorm = 0.2627, lr_0 = 2.5321e-04
Loss = 1.0675e-01, PNorm = 49.4877, GNorm = 0.5387, lr_0 = 2.4764e-04
Loss = 6.9361e-02, PNorm = 49.5185, GNorm = 0.4752, lr_0 = 2.4220e-04
Loss = 9.4715e-02, PNorm = 49.5494, GNorm = 0.5618, lr_0 = 2.3687e-04
Validation prc-auc = 0.669656
Validation auc = 0.875444
Epoch 19
Loss = 8.1473e-02, PNorm = 49.5860, GNorm = 0.4398, lr_0 = 2.3167e-04
Loss = 6.0979e-02, PNorm = 49.6240, GNorm = 0.7079, lr_0 = 2.2658e-04
Loss = 8.5526e-02, PNorm = 49.6436, GNorm = 1.0400, lr_0 = 2.2159e-04
Validation prc-auc = 0.700739
Validation auc = 0.848554
Epoch 20
Loss = 2.7110e-02, PNorm = 49.6617, GNorm = 0.2974, lr_0 = 2.1672e-04
Loss = 7.1863e-02, PNorm = 49.6782, GNorm = 0.3650, lr_0 = 2.1196e-04
Loss = 6.5845e-02, PNorm = 49.7101, GNorm = 0.2218, lr_0 = 2.0730e-04
Loss = 9.1247e-02, PNorm = 49.7291, GNorm = 0.5437, lr_0 = 2.0274e-04
Validation prc-auc = 0.659356
Validation auc = 0.860477
Epoch 21
Loss = 2.2824e-02, PNorm = 49.7616, GNorm = 0.2145, lr_0 = 1.9829e-04
Loss = 6.4871e-02, PNorm = 49.7858, GNorm = 0.7385, lr_0 = 1.9393e-04
Loss = 8.4512e-02, PNorm = 49.8002, GNorm = 0.9783, lr_0 = 1.8967e-04
Loss = 1.1067e-01, PNorm = 49.8285, GNorm = 0.6850, lr_0 = 1.8550e-04
Validation prc-auc = 0.641504
Validation auc = 0.854642
Epoch 22
Loss = 8.0120e-02, PNorm = 49.8578, GNorm = 0.5340, lr_0 = 1.8142e-04
Loss = 6.9528e-02, PNorm = 49.8840, GNorm = 0.4621, lr_0 = 1.7743e-04
Loss = 5.9137e-02, PNorm = 49.9059, GNorm = 0.2624, lr_0 = 1.7353e-04
Loss = 8.0946e-02, PNorm = 49.9272, GNorm = 1.0478, lr_0 = 1.6972e-04
Validation prc-auc = 0.605379
Validation auc = 0.866565
Epoch 23
Loss = 5.6745e-02, PNorm = 49.9422, GNorm = 0.8332, lr_0 = 1.6599e-04
Loss = 7.5868e-02, PNorm = 49.9613, GNorm = 1.1072, lr_0 = 1.6234e-04
Loss = 5.3556e-02, PNorm = 49.9798, GNorm = 0.2400, lr_0 = 1.5877e-04
Loss = 7.4898e-02, PNorm = 49.9987, GNorm = 0.5658, lr_0 = 1.5528e-04
Validation prc-auc = 0.649713
Validation auc = 0.849315
Epoch 24
Loss = 6.1984e-02, PNorm = 50.0205, GNorm = 0.5567, lr_0 = 1.5187e-04
Loss = 4.7673e-02, PNorm = 50.0403, GNorm = 0.2757, lr_0 = 1.4853e-04
Loss = 5.0663e-02, PNorm = 50.0569, GNorm = 0.3164, lr_0 = 1.4527e-04
Validation prc-auc = 0.594353
Validation auc = 0.864536
Epoch 25
Loss = 2.9026e-02, PNorm = 50.0702, GNorm = 0.2926, lr_0 = 1.4207e-04
Loss = 6.6062e-02, PNorm = 50.0875, GNorm = 0.6082, lr_0 = 1.3895e-04
Loss = 6.0579e-02, PNorm = 50.1039, GNorm = 0.2897, lr_0 = 1.3590e-04
Loss = 6.7888e-02, PNorm = 50.1157, GNorm = 0.5583, lr_0 = 1.3291e-04
Validation prc-auc = 0.576679
Validation auc = 0.855150
Epoch 26
Loss = 6.0036e-02, PNorm = 50.1385, GNorm = 0.8427, lr_0 = 1.2999e-04
Loss = 5.1349e-02, PNorm = 50.1419, GNorm = 0.2337, lr_0 = 1.2713e-04
Loss = 6.3318e-02, PNorm = 50.1608, GNorm = 0.5536, lr_0 = 1.2434e-04
Loss = 6.9798e-02, PNorm = 50.1730, GNorm = 0.2808, lr_0 = 1.2160e-04
Validation prc-auc = 0.636538
Validation auc = 0.867834
Epoch 27
Loss = 3.4767e-02, PNorm = 50.1883, GNorm = 0.6942, lr_0 = 1.1893e-04
Loss = 5.8756e-02, PNorm = 50.2018, GNorm = 0.8894, lr_0 = 1.1632e-04
Loss = 4.6835e-02, PNorm = 50.2158, GNorm = 1.0036, lr_0 = 1.1376e-04
Loss = 6.2217e-02, PNorm = 50.2342, GNorm = 0.6044, lr_0 = 1.1126e-04
Validation prc-auc = 0.609535
Validation auc = 0.869102
Epoch 28
Loss = 4.5958e-02, PNorm = 50.2477, GNorm = 0.1870, lr_0 = 1.0881e-04
Loss = 4.7806e-02, PNorm = 50.2541, GNorm = 0.3885, lr_0 = 1.0642e-04
Loss = 5.1949e-02, PNorm = 50.2725, GNorm = 0.0544, lr_0 = 1.0408e-04
Loss = 5.8957e-02, PNorm = 50.2791, GNorm = 0.7861, lr_0 = 1.0179e-04
Validation prc-auc = 0.596340
Validation auc = 0.843988
Epoch 29
Loss = 5.3309e-02, PNorm = 50.2925, GNorm = 0.2672, lr_0 = 1.0000e-04
Loss = 3.0826e-02, PNorm = 50.3009, GNorm = 0.2588, lr_0 = 1.0000e-04
Loss = 4.9672e-02, PNorm = 50.3117, GNorm = 0.4735, lr_0 = 1.0000e-04
Validation prc-auc = 0.600367
Validation auc = 0.865297
Model 0 best validation prc-auc = 0.749865 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.587767
Model 0 test auc = 0.713189
Ensemble test prc-auc = 0.587767
Ensemble test auc = 0.713189
Fold 18
Splitting data with seed 18
Total scaffolds = 1,115 | train scaffolds = 828 | val scaffolds = 120 | test scaffolds = 167
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 4.1332e-01, PNorm = 46.0444, GNorm = 1.6745, lr_0 = 2.3378e-04
Loss = 2.2503e-01, PNorm = 46.0587, GNorm = 0.4380, lr_0 = 3.5541e-04
Loss = 1.9001e-01, PNorm = 46.0810, GNorm = 0.5444, lr_0 = 4.7703e-04
Validation prc-auc = 0.339858
Validation auc = 0.837952
Epoch 1
Loss = 1.6809e-01, PNorm = 46.1121, GNorm = 0.2709, lr_0 = 6.1081e-04
Loss = 2.4726e-01, PNorm = 46.1367, GNorm = 0.4101, lr_0 = 7.3243e-04
Loss = 1.8891e-01, PNorm = 46.1734, GNorm = 0.4435, lr_0 = 8.5405e-04
Loss = 1.6625e-01, PNorm = 46.2283, GNorm = 0.3550, lr_0 = 9.7568e-04
Validation prc-auc = 0.439011
Validation auc = 0.854921
Epoch 2
Loss = 1.7133e-01, PNorm = 46.2855, GNorm = 0.8825, lr_0 = 9.8238e-04
Loss = 1.8050e-01, PNorm = 46.3319, GNorm = 0.4147, lr_0 = 9.6078e-04
Loss = 2.0147e-01, PNorm = 46.3905, GNorm = 0.3997, lr_0 = 9.3966e-04
Loss = 1.7930e-01, PNorm = 46.4521, GNorm = 0.1677, lr_0 = 9.1901e-04
Validation prc-auc = 0.466565
Validation auc = 0.879525
Epoch 3
Loss = 1.8633e-01, PNorm = 46.5189, GNorm = 0.3350, lr_0 = 8.9881e-04
Loss = 1.3724e-01, PNorm = 46.6121, GNorm = 0.1858, lr_0 = 8.7905e-04
Loss = 1.8525e-01, PNorm = 46.6761, GNorm = 0.2210, lr_0 = 8.5973e-04
Loss = 1.6325e-01, PNorm = 46.7510, GNorm = 0.9811, lr_0 = 8.4083e-04
Validation prc-auc = 0.555091
Validation auc = 0.885747
Epoch 4
Loss = 1.3221e-01, PNorm = 46.8040, GNorm = 0.1769, lr_0 = 8.2235e-04
Loss = 1.6652e-01, PNorm = 46.8675, GNorm = 0.5235, lr_0 = 8.0428e-04
Loss = 1.6863e-01, PNorm = 46.9449, GNorm = 0.5563, lr_0 = 7.8660e-04
Validation prc-auc = 0.628739
Validation auc = 0.873303
Epoch 5
Loss = 1.7222e-01, PNorm = 46.9891, GNorm = 0.6457, lr_0 = 7.6931e-04
Loss = 1.9645e-01, PNorm = 47.0688, GNorm = 1.4508, lr_0 = 7.5240e-04
Loss = 1.1588e-01, PNorm = 47.1333, GNorm = 0.3106, lr_0 = 7.3586e-04
Loss = 1.5134e-01, PNorm = 47.2130, GNorm = 0.6252, lr_0 = 7.1969e-04
Validation prc-auc = 0.504620
Validation auc = 0.905543
Epoch 6
Loss = 1.5369e-01, PNorm = 47.2662, GNorm = 0.3140, lr_0 = 7.0387e-04
Loss = 1.3915e-01, PNorm = 47.3308, GNorm = 0.2532, lr_0 = 6.8840e-04
Loss = 1.4134e-01, PNorm = 47.3823, GNorm = 0.3786, lr_0 = 6.7326e-04
Loss = 1.5676e-01, PNorm = 47.4298, GNorm = 0.2962, lr_0 = 6.5847e-04
Validation prc-auc = 0.611787
Validation auc = 0.867930
Epoch 7
Loss = 1.3425e-01, PNorm = 47.4909, GNorm = 0.5901, lr_0 = 6.4399e-04
Loss = 1.7007e-01, PNorm = 47.5362, GNorm = 0.5869, lr_0 = 6.2984e-04
Loss = 1.4247e-01, PNorm = 47.6011, GNorm = 0.3669, lr_0 = 6.1599e-04
Loss = 9.6439e-02, PNorm = 47.6611, GNorm = 0.2481, lr_0 = 6.0245e-04
Validation prc-auc = 0.675690
Validation auc = 0.899038
Epoch 8
Loss = 9.5070e-02, PNorm = 47.7317, GNorm = 0.1516, lr_0 = 5.8921e-04
Loss = 1.5794e-01, PNorm = 47.7672, GNorm = 0.9399, lr_0 = 5.7626e-04
Loss = 1.5589e-01, PNorm = 47.8279, GNorm = 0.6540, lr_0 = 5.6359e-04
Loss = 1.3073e-01, PNorm = 47.8713, GNorm = 0.4124, lr_0 = 5.5120e-04
Validation prc-auc = 0.631319
Validation auc = 0.865102
Epoch 9
Loss = 1.2814e-01, PNorm = 47.9308, GNorm = 0.5280, lr_0 = 5.3909e-04
Loss = 9.4080e-02, PNorm = 47.9855, GNorm = 0.2857, lr_0 = 5.2724e-04
Loss = 1.6504e-01, PNorm = 48.0389, GNorm = 0.4415, lr_0 = 5.1565e-04
Validation prc-auc = 0.572421
Validation auc = 0.863971
Epoch 10
Loss = 6.8966e-02, PNorm = 48.0925, GNorm = 0.2202, lr_0 = 5.0432e-04
Loss = 1.1028e-01, PNorm = 48.1547, GNorm = 0.3608, lr_0 = 4.9323e-04
Loss = 1.1378e-01, PNorm = 48.2066, GNorm = 0.5086, lr_0 = 4.8239e-04
Loss = 1.1312e-01, PNorm = 48.2444, GNorm = 0.3221, lr_0 = 4.7179e-04
Validation prc-auc = 0.573487
Validation auc = 0.891968
Epoch 11
Loss = 1.0807e-01, PNorm = 48.2727, GNorm = 0.6291, lr_0 = 4.6142e-04
Loss = 1.2483e-01, PNorm = 48.3454, GNorm = 0.5150, lr_0 = 4.5127e-04
Loss = 1.0917e-01, PNorm = 48.3918, GNorm = 0.3583, lr_0 = 4.4135e-04
Loss = 1.3560e-01, PNorm = 48.4424, GNorm = 0.7435, lr_0 = 4.3165e-04
Validation prc-auc = 0.563323
Validation auc = 0.875000
Epoch 12
Loss = 9.0969e-02, PNorm = 48.4692, GNorm = 0.6267, lr_0 = 4.2217e-04
Loss = 1.2367e-01, PNorm = 48.5245, GNorm = 0.4924, lr_0 = 4.1289e-04
Loss = 8.9901e-02, PNorm = 48.5582, GNorm = 0.3539, lr_0 = 4.0381e-04
Loss = 1.3983e-01, PNorm = 48.5952, GNorm = 0.6598, lr_0 = 3.9493e-04
Validation prc-auc = 0.634455
Validation auc = 0.875848
Epoch 13
Loss = 1.0277e-01, PNorm = 48.6382, GNorm = 0.2326, lr_0 = 3.8625e-04
Loss = 1.1619e-01, PNorm = 48.6681, GNorm = 0.3932, lr_0 = 3.7776e-04
Loss = 1.0977e-01, PNorm = 48.7140, GNorm = 0.3341, lr_0 = 3.6946e-04
Loss = 9.4315e-02, PNorm = 48.7462, GNorm = 0.4945, lr_0 = 3.6134e-04
Validation prc-auc = 0.613351
Validation auc = 0.880090
Epoch 14
Loss = 1.0990e-01, PNorm = 48.7872, GNorm = 0.3699, lr_0 = 3.5340e-04
Loss = 1.0501e-01, PNorm = 48.8227, GNorm = 0.3402, lr_0 = 3.4563e-04
Loss = 1.0431e-01, PNorm = 48.8737, GNorm = 0.4327, lr_0 = 3.3803e-04
Validation prc-auc = 0.561669
Validation auc = 0.873020
Epoch 15
Loss = 1.0935e-01, PNorm = 48.9091, GNorm = 0.2848, lr_0 = 3.3060e-04
Loss = 1.1986e-01, PNorm = 48.9359, GNorm = 0.5924, lr_0 = 3.2333e-04
Loss = 1.0467e-01, PNorm = 48.9867, GNorm = 0.5941, lr_0 = 3.1623e-04
Loss = 6.0210e-02, PNorm = 49.0249, GNorm = 0.2385, lr_0 = 3.0928e-04
Validation prc-auc = 0.590027
Validation auc = 0.863971
Epoch 16
Loss = 7.1534e-02, PNorm = 49.0669, GNorm = 0.7264, lr_0 = 3.0248e-04
Loss = 1.1845e-01, PNorm = 49.0967, GNorm = 0.7152, lr_0 = 2.9583e-04
Loss = 6.9442e-02, PNorm = 49.1278, GNorm = 0.8291, lr_0 = 2.8933e-04
Loss = 9.5072e-02, PNorm = 49.1612, GNorm = 0.3024, lr_0 = 2.8297e-04
Validation prc-auc = 0.561696
Validation auc = 0.846719
Epoch 17
Loss = 1.3600e-01, PNorm = 49.1977, GNorm = 0.8490, lr_0 = 2.7675e-04
Loss = 6.1446e-02, PNorm = 49.2350, GNorm = 0.3119, lr_0 = 2.7067e-04
Loss = 5.8134e-02, PNorm = 49.2709, GNorm = 0.4818, lr_0 = 2.6472e-04
Loss = 1.0316e-01, PNorm = 49.2948, GNorm = 0.7112, lr_0 = 2.5890e-04
Validation prc-auc = 0.530202
Validation auc = 0.850113
Epoch 18
Loss = 6.5669e-02, PNorm = 49.3340, GNorm = 0.6669, lr_0 = 2.5321e-04
Loss = 8.5182e-02, PNorm = 49.3716, GNorm = 0.5026, lr_0 = 2.4764e-04
Loss = 4.7835e-02, PNorm = 49.4051, GNorm = 0.6194, lr_0 = 2.4220e-04
Loss = 8.1629e-02, PNorm = 49.4355, GNorm = 0.4103, lr_0 = 2.3687e-04
Validation prc-auc = 0.626563
Validation auc = 0.846719
Epoch 19
Loss = 6.0268e-02, PNorm = 49.4632, GNorm = 0.3304, lr_0 = 2.3167e-04
Loss = 4.3795e-02, PNorm = 49.4950, GNorm = 0.3598, lr_0 = 2.2658e-04
Loss = 6.6735e-02, PNorm = 49.5160, GNorm = 0.2825, lr_0 = 2.2159e-04
Validation prc-auc = 0.565013
Validation auc = 0.835690
Epoch 20
Loss = 4.0111e-02, PNorm = 49.5502, GNorm = 0.4695, lr_0 = 2.1672e-04
Loss = 5.4587e-02, PNorm = 49.5776, GNorm = 0.2378, lr_0 = 2.1196e-04
Loss = 5.6776e-02, PNorm = 49.6006, GNorm = 0.3866, lr_0 = 2.0730e-04
Loss = 8.6013e-02, PNorm = 49.6286, GNorm = 1.3660, lr_0 = 2.0274e-04
Validation prc-auc = 0.545259
Validation auc = 0.888292
Epoch 21
Loss = 4.6359e-02, PNorm = 49.6474, GNorm = 0.5348, lr_0 = 1.9829e-04
Loss = 4.0745e-02, PNorm = 49.6762, GNorm = 0.1598, lr_0 = 1.9393e-04
Loss = 7.1589e-02, PNorm = 49.6991, GNorm = 0.2599, lr_0 = 1.8967e-04
Loss = 6.7429e-02, PNorm = 49.7211, GNorm = 0.6397, lr_0 = 1.8550e-04
Validation prc-auc = 0.533253
Validation auc = 0.877545
Epoch 22
Loss = 5.4024e-02, PNorm = 49.7464, GNorm = 0.5166, lr_0 = 1.8142e-04
Loss = 6.4485e-02, PNorm = 49.7734, GNorm = 0.4281, lr_0 = 1.7743e-04
Loss = 5.9734e-02, PNorm = 49.7963, GNorm = 0.5160, lr_0 = 1.7353e-04
Loss = 6.3698e-02, PNorm = 49.8120, GNorm = 0.5048, lr_0 = 1.6972e-04
Validation prc-auc = 0.562496
Validation auc = 0.850113
Epoch 23
Loss = 7.2683e-02, PNorm = 49.8363, GNorm = 0.2750, lr_0 = 1.6599e-04
Loss = 4.9654e-02, PNorm = 49.8541, GNorm = 0.3022, lr_0 = 1.6234e-04
Loss = 4.2700e-02, PNorm = 49.8741, GNorm = 0.8012, lr_0 = 1.5877e-04
Loss = 5.0371e-02, PNorm = 49.8898, GNorm = 0.1453, lr_0 = 1.5528e-04
Validation prc-auc = 0.559459
Validation auc = 0.841912
Epoch 24
Loss = 2.9892e-02, PNorm = 49.9060, GNorm = 0.9284, lr_0 = 1.5187e-04
Loss = 4.3255e-02, PNorm = 49.9232, GNorm = 0.6708, lr_0 = 1.4853e-04
Loss = 5.1633e-02, PNorm = 49.9416, GNorm = 0.8274, lr_0 = 1.4527e-04
Validation prc-auc = 0.548609
Validation auc = 0.862557
Epoch 25
Loss = 2.7435e-02, PNorm = 49.9599, GNorm = 0.4138, lr_0 = 1.4207e-04
Loss = 3.7612e-02, PNorm = 49.9772, GNorm = 0.8935, lr_0 = 1.3895e-04
Loss = 3.8859e-02, PNorm = 49.9890, GNorm = 0.1682, lr_0 = 1.3590e-04
Loss = 5.0849e-02, PNorm = 50.0081, GNorm = 0.8047, lr_0 = 1.3291e-04
Validation prc-auc = 0.510476
Validation auc = 0.853224
Epoch 26
Loss = 6.0366e-02, PNorm = 50.0210, GNorm = 0.7916, lr_0 = 1.2999e-04
Loss = 5.0387e-02, PNorm = 50.0449, GNorm = 1.6485, lr_0 = 1.2713e-04
Loss = 3.3578e-02, PNorm = 50.0599, GNorm = 0.5087, lr_0 = 1.2434e-04
Loss = 4.9289e-02, PNorm = 50.0722, GNorm = 0.3364, lr_0 = 1.2160e-04
Validation prc-auc = 0.531419
Validation auc = 0.838801
Epoch 27
Loss = 2.9787e-02, PNorm = 50.0844, GNorm = 0.3897, lr_0 = 1.1893e-04
Loss = 4.8019e-02, PNorm = 50.0985, GNorm = 0.6648, lr_0 = 1.1632e-04
Loss = 3.8915e-02, PNorm = 50.1179, GNorm = 0.2337, lr_0 = 1.1376e-04
Loss = 4.9105e-02, PNorm = 50.1296, GNorm = 0.5547, lr_0 = 1.1126e-04
Validation prc-auc = 0.554216
Validation auc = 0.854921
Epoch 28
Loss = 3.7135e-02, PNorm = 50.1378, GNorm = 0.5105, lr_0 = 1.0881e-04
Loss = 2.7122e-02, PNorm = 50.1497, GNorm = 0.3068, lr_0 = 1.0642e-04
Loss = 4.5889e-02, PNorm = 50.1555, GNorm = 0.2190, lr_0 = 1.0408e-04
Loss = 4.3454e-02, PNorm = 50.1716, GNorm = 1.0205, lr_0 = 1.0179e-04
Validation prc-auc = 0.537511
Validation auc = 0.841063
Epoch 29
Loss = 3.6908e-02, PNorm = 50.1823, GNorm = 0.7493, lr_0 = 1.0000e-04
Loss = 3.5459e-02, PNorm = 50.1988, GNorm = 0.7837, lr_0 = 1.0000e-04
Loss = 2.2930e-02, PNorm = 50.2060, GNorm = 0.5449, lr_0 = 1.0000e-04
Validation prc-auc = 0.537813
Validation auc = 0.869627
Model 0 best validation prc-auc = 0.675690 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.510540
Model 0 test auc = 0.696429
Ensemble test prc-auc = 0.510540
Ensemble test auc = 0.696429
Fold 19
Splitting data with seed 19
Total scaffolds = 1,115 | train scaffolds = 825 | val scaffolds = 157 | test scaffolds = 133
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.3773e-01, PNorm = 46.0433, GNorm = 1.7846, lr_0 = 2.3378e-04
Loss = 2.1345e-01, PNorm = 46.0591, GNorm = 0.3009, lr_0 = 3.5541e-04
Loss = 2.2292e-01, PNorm = 46.0783, GNorm = 0.3839, lr_0 = 4.7703e-04
Validation prc-auc = 0.268893
Validation auc = 0.761468
Epoch 1
Loss = 1.9920e-01, PNorm = 46.1080, GNorm = 0.7407, lr_0 = 6.1081e-04
Loss = 2.7142e-01, PNorm = 46.1332, GNorm = 0.3913, lr_0 = 7.3243e-04
Loss = 1.8866e-01, PNorm = 46.1767, GNorm = 0.2358, lr_0 = 8.5405e-04
Loss = 1.8806e-01, PNorm = 46.2306, GNorm = 0.3252, lr_0 = 9.7568e-04
Validation prc-auc = 0.484835
Validation auc = 0.821342
Epoch 2
Loss = 2.0232e-01, PNorm = 46.2974, GNorm = 0.2458, lr_0 = 9.8238e-04
Loss = 1.8429e-01, PNorm = 46.3849, GNorm = 1.2576, lr_0 = 9.6078e-04
Loss = 1.7272e-01, PNorm = 46.4478, GNorm = 0.2234, lr_0 = 9.3966e-04
Loss = 2.0501e-01, PNorm = 46.5255, GNorm = 0.2816, lr_0 = 9.1901e-04
Validation prc-auc = 0.585551
Validation auc = 0.845002
Epoch 3
Loss = 1.9594e-01, PNorm = 46.6098, GNorm = 0.3772, lr_0 = 8.9881e-04
Loss = 1.7228e-01, PNorm = 46.6910, GNorm = 1.1908, lr_0 = 8.7905e-04
Loss = 1.6395e-01, PNorm = 46.7710, GNorm = 0.3353, lr_0 = 8.5973e-04
Loss = 2.0104e-01, PNorm = 46.8354, GNorm = 0.3609, lr_0 = 8.4083e-04
Validation prc-auc = 0.615502
Validation auc = 0.839208
Epoch 4
Loss = 1.4155e-01, PNorm = 46.9330, GNorm = 0.2994, lr_0 = 8.2235e-04
Loss = 1.5651e-01, PNorm = 47.0243, GNorm = 1.1048, lr_0 = 8.0428e-04
Loss = 2.1335e-01, PNorm = 47.0735, GNorm = 0.4692, lr_0 = 7.8660e-04
Validation prc-auc = 0.505623
Validation auc = 0.807581
Epoch 5
Loss = 1.9123e-01, PNorm = 47.1393, GNorm = 0.3550, lr_0 = 7.6931e-04
Loss = 1.5946e-01, PNorm = 47.2223, GNorm = 0.3940, lr_0 = 7.5240e-04
Loss = 1.4162e-01, PNorm = 47.2949, GNorm = 0.3055, lr_0 = 7.3586e-04
Loss = 2.1859e-01, PNorm = 47.3321, GNorm = 0.2804, lr_0 = 7.1969e-04
Validation prc-auc = 0.624837
Validation auc = 0.872284
Epoch 6
Loss = 2.2029e-01, PNorm = 47.3821, GNorm = 0.4421, lr_0 = 7.0387e-04
Loss = 1.7860e-01, PNorm = 47.4447, GNorm = 0.4745, lr_0 = 6.8840e-04
Loss = 1.2385e-01, PNorm = 47.5164, GNorm = 0.3118, lr_0 = 6.7326e-04
Loss = 1.7072e-01, PNorm = 47.5607, GNorm = 0.2991, lr_0 = 6.5847e-04
Validation prc-auc = 0.660669
Validation auc = 0.860695
Epoch 7
Loss = 1.0834e-01, PNorm = 47.6296, GNorm = 0.3202, lr_0 = 6.4399e-04
Loss = 1.3540e-01, PNorm = 47.7049, GNorm = 0.5093, lr_0 = 6.2984e-04
Loss = 1.7305e-01, PNorm = 47.7374, GNorm = 0.3540, lr_0 = 6.1599e-04
Loss = 1.4825e-01, PNorm = 47.8093, GNorm = 0.5501, lr_0 = 6.0245e-04
Validation prc-auc = 0.619553
Validation auc = 0.820859
Epoch 8
Loss = 1.2726e-01, PNorm = 47.8524, GNorm = 0.4352, lr_0 = 5.8921e-04
Loss = 1.5675e-01, PNorm = 47.8929, GNorm = 0.2600, lr_0 = 5.7626e-04
Loss = 1.4723e-01, PNorm = 47.9280, GNorm = 1.0845, lr_0 = 5.6359e-04
Loss = 1.4906e-01, PNorm = 47.9794, GNorm = 0.4033, lr_0 = 5.5120e-04
Validation prc-auc = 0.641073
Validation auc = 0.836311
Epoch 9
Loss = 1.3464e-01, PNorm = 48.0218, GNorm = 0.5411, lr_0 = 5.3909e-04
Loss = 1.4413e-01, PNorm = 48.0686, GNorm = 0.3613, lr_0 = 5.2724e-04
Loss = 1.4046e-01, PNorm = 48.0916, GNorm = 0.4829, lr_0 = 5.1565e-04
Validation prc-auc = 0.628870
Validation auc = 0.844278
Epoch 10
Loss = 2.6976e-01, PNorm = 48.1091, GNorm = 0.4548, lr_0 = 5.0432e-04
Loss = 1.4568e-01, PNorm = 48.1614, GNorm = 0.1780, lr_0 = 4.9323e-04
Loss = 1.2564e-01, PNorm = 48.2017, GNorm = 0.3870, lr_0 = 4.8239e-04
Loss = 1.2483e-01, PNorm = 48.2515, GNorm = 0.6782, lr_0 = 4.7179e-04
Validation prc-auc = 0.644952
Validation auc = 0.799372
Epoch 11
Loss = 1.6350e-01, PNorm = 48.2786, GNorm = 0.3575, lr_0 = 4.6142e-04
Loss = 1.0397e-01, PNorm = 48.3125, GNorm = 0.3267, lr_0 = 4.5127e-04
Loss = 1.2145e-01, PNorm = 48.3576, GNorm = 0.3826, lr_0 = 4.4135e-04
Loss = 1.7777e-01, PNorm = 48.3878, GNorm = 0.4718, lr_0 = 4.3165e-04
Validation prc-auc = 0.643327
Validation auc = 0.787301
Epoch 12
Loss = 1.5425e-01, PNorm = 48.4367, GNorm = 0.5337, lr_0 = 4.2217e-04
Loss = 1.3737e-01, PNorm = 48.4750, GNorm = 0.4573, lr_0 = 4.1289e-04
Loss = 1.1669e-01, PNorm = 48.5187, GNorm = 0.2292, lr_0 = 4.0381e-04
Loss = 1.1824e-01, PNorm = 48.5562, GNorm = 0.9982, lr_0 = 3.9493e-04
Validation prc-auc = 0.634372
Validation auc = 0.795268
Epoch 13
Loss = 1.4409e-01, PNorm = 48.5745, GNorm = 0.5514, lr_0 = 3.8625e-04
Loss = 1.2742e-01, PNorm = 48.6164, GNorm = 0.7332, lr_0 = 3.7776e-04
Loss = 1.0739e-01, PNorm = 48.6496, GNorm = 0.4259, lr_0 = 3.6946e-04
Loss = 1.0239e-01, PNorm = 48.6917, GNorm = 0.7302, lr_0 = 3.6134e-04
Validation prc-auc = 0.627111
Validation auc = 0.777161
Epoch 14
Loss = 1.1235e-01, PNorm = 48.7100, GNorm = 0.2423, lr_0 = 3.5340e-04
Loss = 1.2733e-01, PNorm = 48.7550, GNorm = 0.2248, lr_0 = 3.4563e-04
Loss = 1.5629e-01, PNorm = 48.7660, GNorm = 0.3325, lr_0 = 3.3803e-04
Validation prc-auc = 0.628218
Validation auc = 0.792371
Epoch 15
Loss = 1.1567e-01, PNorm = 48.8066, GNorm = 0.4467, lr_0 = 3.3060e-04
Loss = 1.3041e-01, PNorm = 48.8512, GNorm = 0.4771, lr_0 = 3.2333e-04
Loss = 1.4675e-01, PNorm = 48.8855, GNorm = 0.2278, lr_0 = 3.1623e-04
Loss = 1.2508e-01, PNorm = 48.9151, GNorm = 0.2790, lr_0 = 3.0928e-04
Validation prc-auc = 0.619282
Validation auc = 0.796475
Epoch 16
Loss = 1.1404e-01, PNorm = 48.9555, GNorm = 0.5020, lr_0 = 3.0248e-04
Loss = 8.2748e-02, PNorm = 48.9861, GNorm = 0.1780, lr_0 = 2.9583e-04
Loss = 1.4596e-01, PNorm = 49.0035, GNorm = 0.3704, lr_0 = 2.8933e-04
Loss = 1.0392e-01, PNorm = 49.0308, GNorm = 0.3048, lr_0 = 2.8297e-04
Validation prc-auc = 0.606360
Validation auc = 0.750362
Epoch 17
Loss = 9.7992e-02, PNorm = 49.0537, GNorm = 0.2623, lr_0 = 2.7675e-04
Loss = 1.0806e-01, PNorm = 49.0808, GNorm = 0.4137, lr_0 = 2.7067e-04
Loss = 1.4600e-01, PNorm = 49.1047, GNorm = 0.4712, lr_0 = 2.6472e-04
Loss = 9.1508e-02, PNorm = 49.1267, GNorm = 0.5231, lr_0 = 2.5890e-04
Validation prc-auc = 0.635555
Validation auc = 0.784645
Epoch 18
Loss = 1.2788e-01, PNorm = 49.1390, GNorm = 0.5346, lr_0 = 2.5321e-04
Loss = 9.1903e-02, PNorm = 49.1684, GNorm = 0.3188, lr_0 = 2.4764e-04
Loss = 1.0949e-01, PNorm = 49.1899, GNorm = 0.2264, lr_0 = 2.4220e-04
Loss = 8.9140e-02, PNorm = 49.2092, GNorm = 0.2616, lr_0 = 2.3687e-04
Validation prc-auc = 0.639104
Validation auc = 0.792854
Epoch 19
Loss = 1.0016e-01, PNorm = 49.2433, GNorm = 0.2494, lr_0 = 2.3167e-04
Loss = 9.5142e-02, PNorm = 49.2634, GNorm = 0.3808, lr_0 = 2.2658e-04
Loss = 9.4408e-02, PNorm = 49.2877, GNorm = 0.7673, lr_0 = 2.2159e-04
Validation prc-auc = 0.596558
Validation auc = 0.748431
Epoch 20
Loss = 1.9796e-01, PNorm = 49.3028, GNorm = 1.0311, lr_0 = 2.1672e-04
Loss = 1.0621e-01, PNorm = 49.3300, GNorm = 0.3404, lr_0 = 2.1196e-04
Loss = 9.5359e-02, PNorm = 49.3456, GNorm = 0.2305, lr_0 = 2.0730e-04
Loss = 9.5442e-02, PNorm = 49.3666, GNorm = 0.4016, lr_0 = 2.0274e-04
Validation prc-auc = 0.626700
Validation auc = 0.770401
Epoch 21
Loss = 1.1994e-01, PNorm = 49.3886, GNorm = 0.4442, lr_0 = 1.9829e-04
Loss = 1.1268e-01, PNorm = 49.4147, GNorm = 0.5642, lr_0 = 1.9393e-04
Loss = 6.1512e-02, PNorm = 49.4434, GNorm = 0.3838, lr_0 = 1.8967e-04
Loss = 1.0296e-01, PNorm = 49.4575, GNorm = 0.3811, lr_0 = 1.8550e-04
Validation prc-auc = 0.601209
Validation auc = 0.768469
Epoch 22
Loss = 6.3851e-02, PNorm = 49.4797, GNorm = 0.4580, lr_0 = 1.8142e-04
Loss = 1.1950e-01, PNorm = 49.4943, GNorm = 0.9045, lr_0 = 1.7743e-04
Loss = 9.7809e-02, PNorm = 49.5189, GNorm = 0.3148, lr_0 = 1.7353e-04
Loss = 7.1506e-02, PNorm = 49.5353, GNorm = 0.5269, lr_0 = 1.6972e-04
Validation prc-auc = 0.594023
Validation auc = 0.779575
Epoch 23
Loss = 8.3719e-02, PNorm = 49.5572, GNorm = 0.3706, lr_0 = 1.6599e-04
Loss = 9.0979e-02, PNorm = 49.5758, GNorm = 0.3520, lr_0 = 1.6234e-04
Loss = 7.7467e-02, PNorm = 49.5926, GNorm = 0.3104, lr_0 = 1.5877e-04
Loss = 8.5318e-02, PNorm = 49.6067, GNorm = 0.2557, lr_0 = 1.5528e-04
Validation prc-auc = 0.595511
Validation auc = 0.762434
Epoch 24
Loss = 7.0629e-02, PNorm = 49.6263, GNorm = 0.4465, lr_0 = 1.5187e-04
Loss = 9.0625e-02, PNorm = 49.6409, GNorm = 0.3085, lr_0 = 1.4853e-04
Loss = 7.3537e-02, PNorm = 49.6654, GNorm = 0.2535, lr_0 = 1.4527e-04
Validation prc-auc = 0.589147
Validation auc = 0.768469
Epoch 25
Loss = 6.6604e-02, PNorm = 49.6734, GNorm = 0.6462, lr_0 = 1.4207e-04
Loss = 8.1840e-02, PNorm = 49.6956, GNorm = 0.3270, lr_0 = 1.3895e-04
Loss = 7.7883e-02, PNorm = 49.7111, GNorm = 0.5335, lr_0 = 1.3590e-04
Loss = 6.3548e-02, PNorm = 49.7220, GNorm = 0.4377, lr_0 = 1.3291e-04
Validation prc-auc = 0.600249
Validation auc = 0.764848
Epoch 26
Loss = 1.0068e-01, PNorm = 49.7352, GNorm = 0.4290, lr_0 = 1.2999e-04
Loss = 7.3648e-02, PNorm = 49.7543, GNorm = 0.4137, lr_0 = 1.2713e-04
Loss = 8.2076e-02, PNorm = 49.7715, GNorm = 0.5756, lr_0 = 1.2434e-04
Loss = 6.7223e-02, PNorm = 49.7834, GNorm = 0.4036, lr_0 = 1.2160e-04
Validation prc-auc = 0.604358
Validation auc = 0.781507
Epoch 27
Loss = 7.2847e-02, PNorm = 49.7974, GNorm = 0.2730, lr_0 = 1.1893e-04
Loss = 5.9165e-02, PNorm = 49.8138, GNorm = 0.5997, lr_0 = 1.1632e-04
Loss = 6.3103e-02, PNorm = 49.8273, GNorm = 0.3491, lr_0 = 1.1376e-04
Loss = 6.0593e-02, PNorm = 49.8321, GNorm = 0.7646, lr_0 = 1.1126e-04
Validation prc-auc = 0.586740
Validation auc = 0.788991
Epoch 28
Loss = 4.8744e-02, PNorm = 49.8448, GNorm = 0.2158, lr_0 = 1.0881e-04
Loss = 5.2072e-02, PNorm = 49.8565, GNorm = 0.2840, lr_0 = 1.0642e-04
Loss = 9.7976e-02, PNorm = 49.8680, GNorm = 0.7926, lr_0 = 1.0408e-04
Loss = 6.2588e-02, PNorm = 49.8835, GNorm = 0.2874, lr_0 = 1.0179e-04
Validation prc-auc = 0.571495
Validation auc = 0.777885
Epoch 29
Loss = 4.9852e-02, PNorm = 49.8914, GNorm = 0.7316, lr_0 = 1.0000e-04
Loss = 5.0684e-02, PNorm = 49.9038, GNorm = 0.5097, lr_0 = 1.0000e-04
Loss = 8.4665e-02, PNorm = 49.9124, GNorm = 0.4195, lr_0 = 1.0000e-04
Validation prc-auc = 0.559671
Validation auc = 0.779092
Model 0 best validation prc-auc = 0.660669 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.224715
Model 0 test auc = 0.771930
Ensemble test prc-auc = 0.224715
Ensemble test auc = 0.771930
Fold 20
Splitting data with seed 20
Total scaffolds = 1,115 | train scaffolds = 831 | val scaffolds = 148 | test scaffolds = 136
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.8819e-01, PNorm = 46.0426, GNorm = 0.4942, lr_0 = 2.3378e-04
Loss = 2.5356e-01, PNorm = 46.0587, GNorm = 0.3034, lr_0 = 3.5541e-04
Loss = 1.8555e-01, PNorm = 46.0823, GNorm = 0.8273, lr_0 = 4.7703e-04
Validation prc-auc = 0.134334
Validation auc = 0.757212
Epoch 1
Loss = 2.6046e-01, PNorm = 46.1103, GNorm = 0.3293, lr_0 = 6.1081e-04
Loss = 2.1300e-01, PNorm = 46.1483, GNorm = 0.3584, lr_0 = 7.3243e-04
Loss = 2.1528e-01, PNorm = 46.1868, GNorm = 0.6996, lr_0 = 8.5405e-04
Loss = 2.2236e-01, PNorm = 46.2433, GNorm = 0.3569, lr_0 = 9.7568e-04
Validation prc-auc = 0.412878
Validation auc = 0.856456
Epoch 2
Loss = 2.3991e-01, PNorm = 46.3203, GNorm = 1.4375, lr_0 = 9.8238e-04
Loss = 1.8838e-01, PNorm = 46.3948, GNorm = 0.3516, lr_0 = 9.6078e-04
Loss = 2.1370e-01, PNorm = 46.4747, GNorm = 0.5745, lr_0 = 9.3966e-04
Loss = 1.9669e-01, PNorm = 46.5556, GNorm = 0.6495, lr_0 = 9.1901e-04
Validation prc-auc = 0.441724
Validation auc = 0.867788
Epoch 3
Loss = 1.7660e-01, PNorm = 46.6227, GNorm = 0.2821, lr_0 = 8.9881e-04
Loss = 1.6622e-01, PNorm = 46.6932, GNorm = 0.7327, lr_0 = 8.7905e-04
Loss = 1.5201e-01, PNorm = 46.7911, GNorm = 0.2881, lr_0 = 8.5973e-04
Loss = 2.2177e-01, PNorm = 46.8417, GNorm = 0.9226, lr_0 = 8.4083e-04
Validation prc-auc = 0.315868
Validation auc = 0.739011
Epoch 4
Loss = 2.0767e-01, PNorm = 46.9288, GNorm = 0.3425, lr_0 = 8.2235e-04
Loss = 1.6936e-01, PNorm = 47.0170, GNorm = 0.3557, lr_0 = 8.0428e-04
Loss = 1.6444e-01, PNorm = 47.0650, GNorm = 0.3094, lr_0 = 7.8660e-04
Validation prc-auc = 0.410870
Validation auc = 0.838599
Epoch 5
Loss = 2.5792e-01, PNorm = 47.1296, GNorm = 0.8620, lr_0 = 7.6931e-04
Loss = 1.7533e-01, PNorm = 47.1990, GNorm = 0.2177, lr_0 = 7.5240e-04
Loss = 1.3203e-01, PNorm = 47.2853, GNorm = 0.2541, lr_0 = 7.3586e-04
Loss = 1.7432e-01, PNorm = 47.3643, GNorm = 0.7287, lr_0 = 7.1969e-04
Validation prc-auc = 0.364256
Validation auc = 0.833104
Epoch 6
Loss = 1.3204e-01, PNorm = 47.4088, GNorm = 0.5398, lr_0 = 7.0387e-04
Loss = 1.9476e-01, PNorm = 47.4670, GNorm = 0.5412, lr_0 = 6.8840e-04
Loss = 1.8682e-01, PNorm = 47.5398, GNorm = 0.3801, lr_0 = 6.7326e-04
Loss = 2.0126e-01, PNorm = 47.6061, GNorm = 0.5450, lr_0 = 6.5847e-04
Validation prc-auc = 0.344326
Validation auc = 0.798420
Epoch 7
Loss = 1.6822e-01, PNorm = 47.6796, GNorm = 0.2268, lr_0 = 6.4399e-04
Loss = 1.7139e-01, PNorm = 47.7381, GNorm = 0.2527, lr_0 = 6.2984e-04
Loss = 1.1615e-01, PNorm = 47.8086, GNorm = 0.5251, lr_0 = 6.1599e-04
Loss = 1.6734e-01, PNorm = 47.8223, GNorm = 0.7753, lr_0 = 6.0245e-04
Validation prc-auc = 0.323880
Validation auc = 0.743819
Epoch 8
Loss = 1.7548e-01, PNorm = 47.8624, GNorm = 0.2355, lr_0 = 5.8921e-04
Loss = 1.4097e-01, PNorm = 47.9235, GNorm = 0.3508, lr_0 = 5.7626e-04
Loss = 1.6343e-01, PNorm = 47.9703, GNorm = 0.4540, lr_0 = 5.6359e-04
Loss = 1.1905e-01, PNorm = 48.0042, GNorm = 0.2603, lr_0 = 5.5120e-04
Validation prc-auc = 0.376961
Validation auc = 0.821772
Epoch 9
Loss = 1.5102e-01, PNorm = 48.0457, GNorm = 0.3868, lr_0 = 5.3909e-04
Loss = 1.4522e-01, PNorm = 48.0936, GNorm = 0.4638, lr_0 = 5.2724e-04
Loss = 1.6923e-01, PNorm = 48.1525, GNorm = 0.4541, lr_0 = 5.1565e-04
Validation prc-auc = 0.329352
Validation auc = 0.707418
Epoch 10
Loss = 1.3228e-01, PNorm = 48.1976, GNorm = 0.5868, lr_0 = 5.0432e-04
Loss = 1.5232e-01, PNorm = 48.2608, GNorm = 0.6326, lr_0 = 4.9323e-04
Loss = 1.4961e-01, PNorm = 48.3019, GNorm = 0.3680, lr_0 = 4.8239e-04
Loss = 1.3541e-01, PNorm = 48.3398, GNorm = 0.3073, lr_0 = 4.7179e-04
Validation prc-auc = 0.325137
Validation auc = 0.752747
Epoch 11
Loss = 1.2685e-01, PNorm = 48.3807, GNorm = 0.2018, lr_0 = 4.6142e-04
Loss = 1.2328e-01, PNorm = 48.4441, GNorm = 0.5262, lr_0 = 4.5127e-04
Loss = 1.4039e-01, PNorm = 48.4652, GNorm = 0.2199, lr_0 = 4.4135e-04
Loss = 1.7477e-01, PNorm = 48.5063, GNorm = 0.4703, lr_0 = 4.3165e-04
Validation prc-auc = 0.310480
Validation auc = 0.715316
Epoch 12
Loss = 1.6723e-01, PNorm = 48.5715, GNorm = 0.8093, lr_0 = 4.2217e-04
Loss = 1.3701e-01, PNorm = 48.6218, GNorm = 0.5848, lr_0 = 4.1289e-04
Loss = 1.2482e-01, PNorm = 48.6701, GNorm = 0.2417, lr_0 = 4.0381e-04
Loss = 1.1096e-01, PNorm = 48.7057, GNorm = 0.2062, lr_0 = 3.9493e-04
Validation prc-auc = 0.296991
Validation auc = 0.688187
Epoch 13
Loss = 1.6348e-01, PNorm = 48.7415, GNorm = 0.6153, lr_0 = 3.8625e-04
Loss = 1.3024e-01, PNorm = 48.8143, GNorm = 0.3541, lr_0 = 3.7776e-04
Loss = 1.0257e-01, PNorm = 48.8570, GNorm = 0.4216, lr_0 = 3.6946e-04
Loss = 1.3466e-01, PNorm = 48.8957, GNorm = 0.7231, lr_0 = 3.6134e-04
Validation prc-auc = 0.313917
Validation auc = 0.716003
Epoch 14
Loss = 1.4715e-01, PNorm = 48.9425, GNorm = 0.2997, lr_0 = 3.5340e-04
Loss = 1.1250e-01, PNorm = 49.0022, GNorm = 0.3697, lr_0 = 3.4563e-04
Loss = 1.1988e-01, PNorm = 49.0401, GNorm = 0.5288, lr_0 = 3.3803e-04
Validation prc-auc = 0.307058
Validation auc = 0.700206
Epoch 15
Loss = 9.9204e-02, PNorm = 49.0691, GNorm = 0.2533, lr_0 = 3.3060e-04
Loss = 1.1232e-01, PNorm = 49.1092, GNorm = 0.3467, lr_0 = 3.2333e-04
Loss = 1.2502e-01, PNorm = 49.1515, GNorm = 0.4307, lr_0 = 3.1623e-04
Loss = 1.0081e-01, PNorm = 49.1860, GNorm = 0.2652, lr_0 = 3.0928e-04
Validation prc-auc = 0.320923
Validation auc = 0.762363
Epoch 16
Loss = 6.2875e-02, PNorm = 49.2272, GNorm = 0.1916, lr_0 = 3.0248e-04
Loss = 1.0328e-01, PNorm = 49.2674, GNorm = 0.2292, lr_0 = 2.9583e-04
Loss = 9.1364e-02, PNorm = 49.3005, GNorm = 1.4948, lr_0 = 2.8933e-04
Loss = 1.3069e-01, PNorm = 49.3444, GNorm = 0.3603, lr_0 = 2.8297e-04
Validation prc-auc = 0.330921
Validation auc = 0.758929
Epoch 17
Loss = 1.2283e-01, PNorm = 49.3826, GNorm = 0.4188, lr_0 = 2.7675e-04
Loss = 1.1209e-01, PNorm = 49.4287, GNorm = 0.3592, lr_0 = 2.7067e-04
Loss = 8.7092e-02, PNorm = 49.4574, GNorm = 0.3246, lr_0 = 2.6472e-04
Loss = 9.5870e-02, PNorm = 49.4973, GNorm = 0.2561, lr_0 = 2.5890e-04
Validation prc-auc = 0.318839
Validation auc = 0.744849
Epoch 18
Loss = 5.8987e-02, PNorm = 49.5369, GNorm = 0.5749, lr_0 = 2.5321e-04
Loss = 7.8174e-02, PNorm = 49.5657, GNorm = 0.8769, lr_0 = 2.4764e-04
Loss = 1.2470e-01, PNorm = 49.6070, GNorm = 1.0022, lr_0 = 2.4220e-04
Loss = 1.2801e-01, PNorm = 49.6488, GNorm = 1.0295, lr_0 = 2.3687e-04
Validation prc-auc = 0.293987
Validation auc = 0.661401
Epoch 19
Loss = 7.1643e-02, PNorm = 49.6653, GNorm = 0.4181, lr_0 = 2.3167e-04
Loss = 1.0547e-01, PNorm = 49.7016, GNorm = 0.6029, lr_0 = 2.2658e-04
Loss = 1.0576e-01, PNorm = 49.7296, GNorm = 0.4085, lr_0 = 2.2159e-04
Validation prc-auc = 0.328954
Validation auc = 0.688530
Epoch 20
Loss = 9.0035e-02, PNorm = 49.7670, GNorm = 0.4867, lr_0 = 2.1672e-04
Loss = 8.3257e-02, PNorm = 49.8005, GNorm = 0.2741, lr_0 = 2.1196e-04
Loss = 8.7645e-02, PNorm = 49.8364, GNorm = 0.5176, lr_0 = 2.0730e-04
Loss = 9.5644e-02, PNorm = 49.8692, GNorm = 0.3457, lr_0 = 2.0274e-04
Validation prc-auc = 0.308738
Validation auc = 0.725618
Epoch 21
Loss = 1.1929e-01, PNorm = 49.8844, GNorm = 0.8400, lr_0 = 1.9829e-04
Loss = 9.4278e-02, PNorm = 49.9137, GNorm = 0.3745, lr_0 = 1.9393e-04
Loss = 8.1153e-02, PNorm = 49.9521, GNorm = 0.4365, lr_0 = 1.8967e-04
Loss = 5.5407e-02, PNorm = 49.9823, GNorm = 1.0956, lr_0 = 1.8550e-04
Validation prc-auc = 0.338025
Validation auc = 0.791896
Epoch 22
Loss = 6.8472e-02, PNorm = 49.9946, GNorm = 0.5535, lr_0 = 1.8142e-04
Loss = 1.0092e-01, PNorm = 50.0258, GNorm = 0.3694, lr_0 = 1.7743e-04
Loss = 7.7378e-02, PNorm = 50.0523, GNorm = 0.4602, lr_0 = 1.7353e-04
Loss = 7.1762e-02, PNorm = 50.0673, GNorm = 0.2239, lr_0 = 1.6972e-04
Validation prc-auc = 0.330579
Validation auc = 0.777473
Epoch 23
Loss = 7.4146e-02, PNorm = 50.0928, GNorm = 0.1510, lr_0 = 1.6599e-04
Loss = 7.1111e-02, PNorm = 50.1136, GNorm = 0.5247, lr_0 = 1.6234e-04
Loss = 7.3215e-02, PNorm = 50.1386, GNorm = 0.9085, lr_0 = 1.5877e-04
Loss = 7.0853e-02, PNorm = 50.1483, GNorm = 1.2206, lr_0 = 1.5528e-04
Validation prc-auc = 0.324823
Validation auc = 0.740728
Epoch 24
Loss = 5.5312e-02, PNorm = 50.1858, GNorm = 0.4819, lr_0 = 1.5187e-04
Loss = 6.9287e-02, PNorm = 50.2001, GNorm = 0.7225, lr_0 = 1.4853e-04
Loss = 8.0715e-02, PNorm = 50.2187, GNorm = 0.3173, lr_0 = 1.4527e-04
Validation prc-auc = 0.312181
Validation auc = 0.700549
Epoch 25
Loss = 4.4219e-02, PNorm = 50.2382, GNorm = 0.8622, lr_0 = 1.4207e-04
Loss = 7.0450e-02, PNorm = 50.2568, GNorm = 0.8533, lr_0 = 1.3895e-04
Loss = 6.4960e-02, PNorm = 50.2760, GNorm = 0.6783, lr_0 = 1.3590e-04
Loss = 6.0925e-02, PNorm = 50.2944, GNorm = 0.3219, lr_0 = 1.3291e-04
Validation prc-auc = 0.297820
Validation auc = 0.678571
Epoch 26
Loss = 6.0124e-02, PNorm = 50.3127, GNorm = 0.7667, lr_0 = 1.2999e-04
Loss = 5.5612e-02, PNorm = 50.3273, GNorm = 0.7773, lr_0 = 1.2713e-04
Loss = 5.4713e-02, PNorm = 50.3423, GNorm = 0.4755, lr_0 = 1.2434e-04
Loss = 6.2622e-02, PNorm = 50.3555, GNorm = 0.8078, lr_0 = 1.2160e-04
Validation prc-auc = 0.316303
Validation auc = 0.707761
Epoch 27
Loss = 5.7480e-02, PNorm = 50.3761, GNorm = 0.2970, lr_0 = 1.1893e-04
Loss = 5.9374e-02, PNorm = 50.3954, GNorm = 0.4219, lr_0 = 1.1632e-04
Loss = 6.3797e-02, PNorm = 50.4103, GNorm = 0.5096, lr_0 = 1.1376e-04
Loss = 6.2816e-02, PNorm = 50.4235, GNorm = 0.7157, lr_0 = 1.1126e-04
Validation prc-auc = 0.274994
Validation auc = 0.667582
Epoch 28
Loss = 7.1082e-02, PNorm = 50.4299, GNorm = 0.3620, lr_0 = 1.0881e-04
Loss = 7.4902e-02, PNorm = 50.4484, GNorm = 0.4544, lr_0 = 1.0642e-04
Loss = 5.3736e-02, PNorm = 50.4651, GNorm = 0.8354, lr_0 = 1.0408e-04
Loss = 4.8442e-02, PNorm = 50.4714, GNorm = 0.8659, lr_0 = 1.0179e-04
Validation prc-auc = 0.312730
Validation auc = 0.728365
Epoch 29
Loss = 4.9897e-02, PNorm = 50.4869, GNorm = 0.1294, lr_0 = 1.0000e-04
Loss = 6.1578e-02, PNorm = 50.4934, GNorm = 0.5091, lr_0 = 1.0000e-04
Loss = 6.5938e-02, PNorm = 50.5084, GNorm = 0.5110, lr_0 = 1.0000e-04
Validation prc-auc = 0.309370
Validation auc = 0.723558
Model 0 best validation prc-auc = 0.441724 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.287714
Model 0 test auc = 0.726832
Ensemble test prc-auc = 0.287714
Ensemble test auc = 0.726832
Fold 21
Splitting data with seed 21
Total scaffolds = 1,115 | train scaffolds = 832 | val scaffolds = 145 | test scaffolds = 138
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.4569e-01, PNorm = 46.0441, GNorm = 2.0082, lr_0 = 2.3378e-04
Loss = 2.4316e-01, PNorm = 46.0597, GNorm = 0.7247, lr_0 = 3.5541e-04
Loss = 2.2874e-01, PNorm = 46.0803, GNorm = 0.3014, lr_0 = 4.7703e-04
Validation prc-auc = 0.128010
Validation auc = 0.551051
Epoch 1
Loss = 3.6030e-01, PNorm = 46.1144, GNorm = 0.6908, lr_0 = 6.1081e-04
Loss = 2.2780e-01, PNorm = 46.1548, GNorm = 0.4825, lr_0 = 7.3243e-04
Loss = 1.8973e-01, PNorm = 46.2030, GNorm = 0.3519, lr_0 = 8.5405e-04
Loss = 1.9500e-01, PNorm = 46.2641, GNorm = 0.5422, lr_0 = 9.7568e-04
Validation prc-auc = 0.226779
Validation auc = 0.836937
Epoch 2
Loss = 1.7964e-01, PNorm = 46.3262, GNorm = 0.1808, lr_0 = 9.8238e-04
Loss = 1.9528e-01, PNorm = 46.4119, GNorm = 0.3163, lr_0 = 9.6078e-04
Loss = 2.1491e-01, PNorm = 46.4771, GNorm = 0.4245, lr_0 = 9.3966e-04
Loss = 2.2010e-01, PNorm = 46.5348, GNorm = 0.3766, lr_0 = 9.1901e-04
Validation prc-auc = 0.282695
Validation auc = 0.837237
Epoch 3
Loss = 2.3731e-01, PNorm = 46.6158, GNorm = 0.6538, lr_0 = 8.9881e-04
Loss = 1.6634e-01, PNorm = 46.6834, GNorm = 0.3955, lr_0 = 8.7905e-04
Loss = 2.0916e-01, PNorm = 46.7373, GNorm = 0.2977, lr_0 = 8.5973e-04
Loss = 1.6459e-01, PNorm = 46.8217, GNorm = 0.2565, lr_0 = 8.4083e-04
Validation prc-auc = 0.318500
Validation auc = 0.875676
Epoch 4
Loss = 1.6616e-01, PNorm = 46.8861, GNorm = 0.2057, lr_0 = 8.2235e-04
Loss = 1.7126e-01, PNorm = 46.9551, GNorm = 0.5889, lr_0 = 8.0428e-04
Loss = 1.9751e-01, PNorm = 47.0128, GNorm = 0.9711, lr_0 = 7.8660e-04
Validation prc-auc = 0.295201
Validation auc = 0.896096
Epoch 5
Loss = 1.5806e-01, PNorm = 47.0961, GNorm = 0.6167, lr_0 = 7.6931e-04
Loss = 1.5499e-01, PNorm = 47.1823, GNorm = 0.6419, lr_0 = 7.5240e-04
Loss = 1.3169e-01, PNorm = 47.2460, GNorm = 0.2424, lr_0 = 7.3586e-04
Loss = 2.1284e-01, PNorm = 47.3304, GNorm = 0.2272, lr_0 = 7.1969e-04
Validation prc-auc = 0.337278
Validation auc = 0.902703
Epoch 6
Loss = 2.0479e-01, PNorm = 47.3979, GNorm = 0.3883, lr_0 = 7.0387e-04
Loss = 1.5537e-01, PNorm = 47.5106, GNorm = 0.2880, lr_0 = 6.8840e-04
Loss = 1.5220e-01, PNorm = 47.5725, GNorm = 1.1344, lr_0 = 6.7326e-04
Loss = 2.0161e-01, PNorm = 47.6292, GNorm = 0.2090, lr_0 = 6.5847e-04
Validation prc-auc = 0.430608
Validation auc = 0.888288
Epoch 7
Loss = 1.1025e-01, PNorm = 47.7385, GNorm = 0.5340, lr_0 = 6.4399e-04
Loss = 1.5160e-01, PNorm = 47.8253, GNorm = 0.4360, lr_0 = 6.2984e-04
Loss = 2.0775e-01, PNorm = 47.8727, GNorm = 0.5222, lr_0 = 6.1599e-04
Loss = 1.5396e-01, PNorm = 47.9465, GNorm = 0.4068, lr_0 = 6.0245e-04
Validation prc-auc = 0.503803
Validation auc = 0.929730
Epoch 8
Loss = 1.9270e-01, PNorm = 48.0197, GNorm = 0.5046, lr_0 = 5.8921e-04
Loss = 1.6016e-01, PNorm = 48.0843, GNorm = 0.4978, lr_0 = 5.7626e-04
Loss = 1.8057e-01, PNorm = 48.1430, GNorm = 0.4167, lr_0 = 5.6359e-04
Loss = 1.2562e-01, PNorm = 48.2219, GNorm = 0.3650, lr_0 = 5.5120e-04
Validation prc-auc = 0.411918
Validation auc = 0.924024
Epoch 9
Loss = 1.9644e-01, PNorm = 48.2554, GNorm = 0.6471, lr_0 = 5.3909e-04
Loss = 1.4052e-01, PNorm = 48.3414, GNorm = 0.1752, lr_0 = 5.2724e-04
Loss = 1.7596e-01, PNorm = 48.4069, GNorm = 0.2748, lr_0 = 5.1565e-04
Validation prc-auc = 0.460947
Validation auc = 0.881982
Epoch 10
Loss = 2.0040e-02, PNorm = 48.4562, GNorm = 0.2537, lr_0 = 5.0432e-04
Loss = 1.9093e-01, PNorm = 48.4933, GNorm = 0.7884, lr_0 = 4.9323e-04
Loss = 1.3107e-01, PNorm = 48.5538, GNorm = 0.2023, lr_0 = 4.8239e-04
Loss = 1.2721e-01, PNorm = 48.5994, GNorm = 0.2188, lr_0 = 4.7179e-04
Validation prc-auc = 0.462389
Validation auc = 0.882282
Epoch 11
Loss = 1.4193e-01, PNorm = 48.6544, GNorm = 0.1707, lr_0 = 4.6142e-04
Loss = 1.7259e-01, PNorm = 48.7000, GNorm = 0.4265, lr_0 = 4.5127e-04
Loss = 1.3326e-01, PNorm = 48.7516, GNorm = 0.2131, lr_0 = 4.4135e-04
Loss = 1.1537e-01, PNorm = 48.8019, GNorm = 0.2413, lr_0 = 4.3165e-04
Validation prc-auc = 0.436255
Validation auc = 0.863664
Epoch 12
Loss = 7.5676e-02, PNorm = 48.8455, GNorm = 0.4139, lr_0 = 4.2217e-04
Loss = 1.5969e-01, PNorm = 48.8830, GNorm = 0.3132, lr_0 = 4.1289e-04
Loss = 1.3243e-01, PNorm = 48.9213, GNorm = 0.8001, lr_0 = 4.0381e-04
Loss = 1.4080e-01, PNorm = 48.9687, GNorm = 0.6693, lr_0 = 3.9493e-04
Validation prc-auc = 0.453591
Validation auc = 0.867568
Epoch 13
Loss = 1.3029e-01, PNorm = 49.0077, GNorm = 0.9907, lr_0 = 3.8625e-04
Loss = 1.2885e-01, PNorm = 49.0432, GNorm = 0.3795, lr_0 = 3.7776e-04
Loss = 1.3271e-01, PNorm = 49.0804, GNorm = 0.2227, lr_0 = 3.6946e-04
Loss = 1.0930e-01, PNorm = 49.1294, GNorm = 0.4958, lr_0 = 3.6134e-04
Validation prc-auc = 0.439917
Validation auc = 0.849550
Epoch 14
Loss = 1.3078e-01, PNorm = 49.1842, GNorm = 1.1385, lr_0 = 3.5340e-04
Loss = 1.2862e-01, PNorm = 49.2221, GNorm = 0.4133, lr_0 = 3.4563e-04
Loss = 1.4004e-01, PNorm = 49.2629, GNorm = 0.6939, lr_0 = 3.3803e-04
Validation prc-auc = 0.416940
Validation auc = 0.855255
Epoch 15
Loss = 3.5724e-02, PNorm = 49.3216, GNorm = 0.1741, lr_0 = 3.3060e-04
Loss = 1.2289e-01, PNorm = 49.3692, GNorm = 0.4306, lr_0 = 3.2333e-04
Loss = 1.6745e-01, PNorm = 49.4062, GNorm = 0.5892, lr_0 = 3.1623e-04
Loss = 1.2311e-01, PNorm = 49.4479, GNorm = 0.1710, lr_0 = 3.0928e-04
Validation prc-auc = 0.435604
Validation auc = 0.843844
Epoch 16
Loss = 1.5396e-01, PNorm = 49.4817, GNorm = 0.7487, lr_0 = 3.0248e-04
Loss = 9.5036e-02, PNorm = 49.5098, GNorm = 0.5877, lr_0 = 2.9583e-04
Loss = 1.3507e-01, PNorm = 49.5406, GNorm = 0.5686, lr_0 = 2.8933e-04
Loss = 9.6301e-02, PNorm = 49.5769, GNorm = 0.6400, lr_0 = 2.8297e-04
Validation prc-auc = 0.454821
Validation auc = 0.847447
Epoch 17
Loss = 1.1977e-01, PNorm = 49.5924, GNorm = 0.4343, lr_0 = 2.7675e-04
Loss = 1.0619e-01, PNorm = 49.6350, GNorm = 0.3524, lr_0 = 2.7067e-04
Loss = 9.4580e-02, PNorm = 49.6643, GNorm = 0.7464, lr_0 = 2.6472e-04
Loss = 1.2344e-01, PNorm = 49.6887, GNorm = 0.4807, lr_0 = 2.5890e-04
Validation prc-auc = 0.473138
Validation auc = 0.840541
Epoch 18
Loss = 1.1843e-01, PNorm = 49.7161, GNorm = 0.4623, lr_0 = 2.5321e-04
Loss = 1.2158e-01, PNorm = 49.7462, GNorm = 0.8643, lr_0 = 2.4764e-04
Loss = 9.6603e-02, PNorm = 49.7743, GNorm = 0.6150, lr_0 = 2.4220e-04
Loss = 8.5747e-02, PNorm = 49.8044, GNorm = 0.3195, lr_0 = 2.3687e-04
Validation prc-auc = 0.553301
Validation auc = 0.843844
Epoch 19
Loss = 9.3581e-02, PNorm = 49.8307, GNorm = 0.7251, lr_0 = 2.3167e-04
Loss = 9.4089e-02, PNorm = 49.8523, GNorm = 1.3324, lr_0 = 2.2658e-04
Loss = 1.0218e-01, PNorm = 49.8787, GNorm = 0.7948, lr_0 = 2.2159e-04
Validation prc-auc = 0.411905
Validation auc = 0.836637
Epoch 20
Loss = 7.0356e-02, PNorm = 49.9055, GNorm = 0.4871, lr_0 = 2.1672e-04
Loss = 7.8403e-02, PNorm = 49.9329, GNorm = 0.3306, lr_0 = 2.1196e-04
Loss = 9.3850e-02, PNorm = 49.9542, GNorm = 0.2567, lr_0 = 2.0730e-04
Loss = 1.2206e-01, PNorm = 49.9821, GNorm = 1.7498, lr_0 = 2.0274e-04
Validation prc-auc = 0.449314
Validation auc = 0.841742
Epoch 21
Loss = 1.1993e-01, PNorm = 50.0015, GNorm = 0.4617, lr_0 = 1.9829e-04
Loss = 8.3113e-02, PNorm = 50.0216, GNorm = 0.2725, lr_0 = 1.9393e-04
Loss = 9.5467e-02, PNorm = 50.0459, GNorm = 0.5012, lr_0 = 1.8967e-04
Loss = 1.0981e-01, PNorm = 50.0624, GNorm = 0.4543, lr_0 = 1.8550e-04
Validation prc-auc = 0.435000
Validation auc = 0.841441
Epoch 22
Loss = 6.1629e-02, PNorm = 50.0900, GNorm = 0.5261, lr_0 = 1.8142e-04
Loss = 9.8932e-02, PNorm = 50.1209, GNorm = 0.9778, lr_0 = 1.7743e-04
Loss = 7.8527e-02, PNorm = 50.1350, GNorm = 0.7754, lr_0 = 1.7353e-04
Loss = 1.0033e-01, PNorm = 50.1521, GNorm = 0.8826, lr_0 = 1.6972e-04
Validation prc-auc = 0.424503
Validation auc = 0.842643
Epoch 23
Loss = 8.1572e-02, PNorm = 50.1731, GNorm = 0.5513, lr_0 = 1.6599e-04
Loss = 7.6023e-02, PNorm = 50.1951, GNorm = 0.6023, lr_0 = 1.6234e-04
Loss = 9.0268e-02, PNorm = 50.2140, GNorm = 0.7577, lr_0 = 1.5877e-04
Loss = 6.3572e-02, PNorm = 50.2328, GNorm = 1.0425, lr_0 = 1.5528e-04
Validation prc-auc = 0.429171
Validation auc = 0.836637
Epoch 24
Loss = 7.3960e-02, PNorm = 50.2507, GNorm = 0.3130, lr_0 = 1.5187e-04
Loss = 5.5851e-02, PNorm = 50.2704, GNorm = 0.2713, lr_0 = 1.4853e-04
Loss = 8.3002e-02, PNorm = 50.2919, GNorm = 0.2283, lr_0 = 1.4527e-04
Validation prc-auc = 0.413405
Validation auc = 0.840841
Epoch 25
Loss = 2.9594e-02, PNorm = 50.3024, GNorm = 0.2340, lr_0 = 1.4207e-04
Loss = 5.7191e-02, PNorm = 50.3212, GNorm = 0.3467, lr_0 = 1.3895e-04
Loss = 9.4024e-02, PNorm = 50.3344, GNorm = 0.3088, lr_0 = 1.3590e-04
Loss = 7.2969e-02, PNorm = 50.3515, GNorm = 1.0003, lr_0 = 1.3291e-04
Validation prc-auc = 0.423019
Validation auc = 0.839039
Epoch 26
Loss = 4.9499e-02, PNorm = 50.3544, GNorm = 0.9986, lr_0 = 1.2999e-04
Loss = 1.0422e-01, PNorm = 50.3781, GNorm = 0.8427, lr_0 = 1.2713e-04
Loss = 7.5498e-02, PNorm = 50.3890, GNorm = 0.7001, lr_0 = 1.2434e-04
Loss = 7.1840e-02, PNorm = 50.4077, GNorm = 0.6503, lr_0 = 1.2160e-04
Validation prc-auc = 0.419251
Validation auc = 0.841742
Epoch 27
Loss = 5.3775e-02, PNorm = 50.4203, GNorm = 0.2136, lr_0 = 1.1893e-04
Loss = 7.8411e-02, PNorm = 50.4346, GNorm = 0.5708, lr_0 = 1.1632e-04
Loss = 5.5014e-02, PNorm = 50.4479, GNorm = 0.6612, lr_0 = 1.1376e-04
Loss = 6.3764e-02, PNorm = 50.4583, GNorm = 0.9654, lr_0 = 1.1126e-04
Validation prc-auc = 0.433088
Validation auc = 0.839039
Epoch 28
Loss = 8.0522e-02, PNorm = 50.4681, GNorm = 0.5102, lr_0 = 1.0881e-04
Loss = 6.1709e-02, PNorm = 50.4812, GNorm = 0.3018, lr_0 = 1.0642e-04
Loss = 4.5113e-02, PNorm = 50.4936, GNorm = 0.6472, lr_0 = 1.0408e-04
Loss = 7.4072e-02, PNorm = 50.5014, GNorm = 0.4710, lr_0 = 1.0179e-04
Validation prc-auc = 0.451932
Validation auc = 0.843093
Epoch 29
Loss = 5.3294e-02, PNorm = 50.5161, GNorm = 0.3934, lr_0 = 1.0000e-04
Loss = 5.1341e-02, PNorm = 50.5297, GNorm = 0.6634, lr_0 = 1.0000e-04
Loss = 5.9604e-02, PNorm = 50.5369, GNorm = 0.3968, lr_0 = 1.0000e-04
Validation prc-auc = 0.393803
Validation auc = 0.831682
Model 0 best validation prc-auc = 0.553301 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.472399
Model 0 test auc = 0.716795
Ensemble test prc-auc = 0.472399
Ensemble test auc = 0.716795
Fold 22
Splitting data with seed 22
Total scaffolds = 1,115 | train scaffolds = 824 | val scaffolds = 145 | test scaffolds = 146
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.6782e-01, PNorm = 46.0431, GNorm = 0.9455, lr_0 = 2.3378e-04
Loss = 2.6610e-01, PNorm = 46.0582, GNorm = 2.1083, lr_0 = 3.5541e-04
Loss = 2.2370e-01, PNorm = 46.0802, GNorm = 0.4887, lr_0 = 4.7703e-04
Validation prc-auc = 0.421675
Validation auc = 0.762811
Epoch 1
Loss = 3.2977e-01, PNorm = 46.1042, GNorm = 0.2708, lr_0 = 6.1081e-04
Loss = 2.0830e-01, PNorm = 46.1395, GNorm = 0.1645, lr_0 = 7.3243e-04
Loss = 2.1934e-01, PNorm = 46.1763, GNorm = 0.2787, lr_0 = 8.5405e-04
Loss = 2.0487e-01, PNorm = 46.2276, GNorm = 0.4796, lr_0 = 9.7568e-04
Validation prc-auc = 0.486149
Validation auc = 0.785642
Epoch 2
Loss = 1.9359e-01, PNorm = 46.2844, GNorm = 0.2825, lr_0 = 9.8238e-04
Loss = 2.2187e-01, PNorm = 46.3549, GNorm = 0.9382, lr_0 = 9.6078e-04
Loss = 1.7609e-01, PNorm = 46.4313, GNorm = 0.2581, lr_0 = 9.3966e-04
Loss = 2.0310e-01, PNorm = 46.5059, GNorm = 0.4872, lr_0 = 9.1901e-04
Validation prc-auc = 0.455119
Validation auc = 0.774480
Epoch 3
Loss = 2.3965e-01, PNorm = 46.5679, GNorm = 0.2857, lr_0 = 8.9881e-04
Loss = 1.7150e-01, PNorm = 46.6582, GNorm = 0.4739, lr_0 = 8.7905e-04
Loss = 1.6529e-01, PNorm = 46.7239, GNorm = 0.2596, lr_0 = 8.5973e-04
Loss = 1.7039e-01, PNorm = 46.7850, GNorm = 0.4415, lr_0 = 8.4083e-04
Validation prc-auc = 0.528581
Validation auc = 0.787925
Epoch 4
Loss = 1.5311e-01, PNorm = 46.8678, GNorm = 0.6071, lr_0 = 8.2235e-04
Loss = 2.2341e-01, PNorm = 46.9385, GNorm = 0.3698, lr_0 = 8.0428e-04
Loss = 1.6518e-01, PNorm = 47.0175, GNorm = 0.4274, lr_0 = 7.8660e-04
Validation prc-auc = 0.537284
Validation auc = 0.820649
Epoch 5
Loss = 1.3816e-01, PNorm = 47.0897, GNorm = 0.2766, lr_0 = 7.6931e-04
Loss = 2.0526e-01, PNorm = 47.1417, GNorm = 0.5805, lr_0 = 7.5240e-04
Loss = 1.4783e-01, PNorm = 47.2129, GNorm = 0.2559, lr_0 = 7.3586e-04
Loss = 1.7485e-01, PNorm = 47.2634, GNorm = 0.8006, lr_0 = 7.1969e-04
Validation prc-auc = 0.560458
Validation auc = 0.811010
Epoch 6
Loss = 1.8133e-01, PNorm = 47.3426, GNorm = 0.7017, lr_0 = 7.0387e-04
Loss = 1.7168e-01, PNorm = 47.3841, GNorm = 0.2513, lr_0 = 6.8840e-04
Loss = 1.6080e-01, PNorm = 47.4440, GNorm = 0.7327, lr_0 = 6.7326e-04
Loss = 1.4340e-01, PNorm = 47.5125, GNorm = 0.7946, lr_0 = 6.5847e-04
Validation prc-auc = 0.517809
Validation auc = 0.791730
Epoch 7
Loss = 1.2887e-01, PNorm = 47.5693, GNorm = 0.3589, lr_0 = 6.4399e-04
Loss = 1.5173e-01, PNorm = 47.6335, GNorm = 0.4235, lr_0 = 6.2984e-04
Loss = 1.6065e-01, PNorm = 47.6981, GNorm = 0.3237, lr_0 = 6.1599e-04
Loss = 1.5197e-01, PNorm = 47.7523, GNorm = 0.2484, lr_0 = 6.0245e-04
Validation prc-auc = 0.522797
Validation auc = 0.827499
Epoch 8
Loss = 1.3350e-01, PNorm = 47.8036, GNorm = 0.5033, lr_0 = 5.8921e-04
Loss = 1.3941e-01, PNorm = 47.8734, GNorm = 0.3005, lr_0 = 5.7626e-04
Loss = 1.3796e-01, PNorm = 47.9114, GNorm = 0.2233, lr_0 = 5.6359e-04
Loss = 1.7000e-01, PNorm = 47.9555, GNorm = 0.2300, lr_0 = 5.5120e-04
Validation prc-auc = 0.503682
Validation auc = 0.807458
Epoch 9
Loss = 1.4308e-01, PNorm = 48.0087, GNorm = 0.4032, lr_0 = 5.3909e-04
Loss = 9.5391e-02, PNorm = 48.0670, GNorm = 0.8482, lr_0 = 5.2724e-04
Loss = 2.0611e-01, PNorm = 48.0963, GNorm = 0.2788, lr_0 = 5.1565e-04
Validation prc-auc = 0.479659
Validation auc = 0.771436
Epoch 10
Loss = 1.5171e-01, PNorm = 48.1603, GNorm = 0.2401, lr_0 = 5.0432e-04
Loss = 1.5695e-01, PNorm = 48.2154, GNorm = 0.3367, lr_0 = 4.9323e-04
Loss = 1.4579e-01, PNorm = 48.2710, GNorm = 0.9030, lr_0 = 4.8239e-04
Loss = 1.0744e-01, PNorm = 48.3153, GNorm = 0.4281, lr_0 = 4.7179e-04
Validation prc-auc = 0.523635
Validation auc = 0.785388
Epoch 11
Loss = 1.3869e-01, PNorm = 48.3515, GNorm = 0.3380, lr_0 = 4.6142e-04
Loss = 9.9306e-02, PNorm = 48.4079, GNorm = 0.2210, lr_0 = 4.5127e-04
Loss = 1.7786e-01, PNorm = 48.4326, GNorm = 0.4762, lr_0 = 4.4135e-04
Loss = 1.2963e-01, PNorm = 48.4947, GNorm = 0.4114, lr_0 = 4.3165e-04
Validation prc-auc = 0.479408
Validation auc = 0.773212
Epoch 12
Loss = 9.7884e-02, PNorm = 48.5351, GNorm = 0.5482, lr_0 = 4.2217e-04
Loss = 1.2189e-01, PNorm = 48.5771, GNorm = 0.3829, lr_0 = 4.1289e-04
Loss = 1.5015e-01, PNorm = 48.6070, GNorm = 0.3626, lr_0 = 4.0381e-04
Loss = 1.3115e-01, PNorm = 48.6475, GNorm = 0.2909, lr_0 = 3.9493e-04
Validation prc-auc = 0.517519
Validation auc = 0.811771
Epoch 13
Loss = 1.1439e-01, PNorm = 48.6971, GNorm = 0.6443, lr_0 = 3.8625e-04
Loss = 1.1081e-01, PNorm = 48.7457, GNorm = 0.3108, lr_0 = 3.7776e-04
Loss = 1.6354e-01, PNorm = 48.7548, GNorm = 0.2979, lr_0 = 3.6946e-04
Loss = 1.3429e-01, PNorm = 48.8028, GNorm = 0.4271, lr_0 = 3.6134e-04
Validation prc-auc = 0.455094
Validation auc = 0.818620
Epoch 14
Loss = 1.7238e-01, PNorm = 48.8306, GNorm = 0.3488, lr_0 = 3.5340e-04
Loss = 1.1272e-01, PNorm = 48.8921, GNorm = 0.3548, lr_0 = 3.4563e-04
Loss = 9.6669e-02, PNorm = 48.9207, GNorm = 0.3714, lr_0 = 3.3803e-04
Validation prc-auc = 0.548020
Validation auc = 0.794013
Epoch 15
Loss = 1.5280e-01, PNorm = 48.9578, GNorm = 0.4750, lr_0 = 3.3060e-04
Loss = 1.4038e-01, PNorm = 48.9782, GNorm = 0.5673, lr_0 = 3.2333e-04
Loss = 1.3584e-01, PNorm = 49.0062, GNorm = 0.5137, lr_0 = 3.1623e-04
Loss = 1.0361e-01, PNorm = 49.0421, GNorm = 0.5318, lr_0 = 3.0928e-04
Validation prc-auc = 0.534079
Validation auc = 0.815830
Epoch 16
Loss = 9.8746e-02, PNorm = 49.0827, GNorm = 0.7361, lr_0 = 3.0248e-04
Loss = 9.5042e-02, PNorm = 49.1142, GNorm = 0.2183, lr_0 = 2.9583e-04
Loss = 1.1756e-01, PNorm = 49.1401, GNorm = 0.5441, lr_0 = 2.8933e-04
Loss = 1.2617e-01, PNorm = 49.1656, GNorm = 0.5703, lr_0 = 2.8297e-04
Validation prc-auc = 0.525074
Validation auc = 0.811517
Epoch 17
Loss = 9.3954e-02, PNorm = 49.1975, GNorm = 0.6499, lr_0 = 2.7675e-04
Loss = 1.0146e-01, PNorm = 49.2272, GNorm = 0.1914, lr_0 = 2.7067e-04
Loss = 1.1060e-01, PNorm = 49.2494, GNorm = 0.2780, lr_0 = 2.6472e-04
Loss = 1.1295e-01, PNorm = 49.2887, GNorm = 0.2608, lr_0 = 2.5890e-04
Validation prc-auc = 0.541347
Validation auc = 0.811010
Epoch 18
Loss = 9.2715e-02, PNorm = 49.3192, GNorm = 0.2942, lr_0 = 2.5321e-04
Loss = 1.0379e-01, PNorm = 49.3564, GNorm = 0.6267, lr_0 = 2.4764e-04
Loss = 1.1838e-01, PNorm = 49.3784, GNorm = 0.3729, lr_0 = 2.4220e-04
Loss = 1.0146e-01, PNorm = 49.4149, GNorm = 0.2737, lr_0 = 2.3687e-04
Validation prc-auc = 0.538564
Validation auc = 0.805682
Epoch 19
Loss = 1.0447e-01, PNorm = 49.4461, GNorm = 0.2944, lr_0 = 2.3167e-04
Loss = 8.8958e-02, PNorm = 49.4603, GNorm = 0.3422, lr_0 = 2.2658e-04
Loss = 1.0968e-01, PNorm = 49.4897, GNorm = 0.8926, lr_0 = 2.2159e-04
Validation prc-auc = 0.527425
Validation auc = 0.799848
Epoch 20
Loss = 6.6845e-02, PNorm = 49.5193, GNorm = 0.4000, lr_0 = 2.1672e-04
Loss = 6.2824e-02, PNorm = 49.5480, GNorm = 0.6862, lr_0 = 2.1196e-04
Loss = 9.8570e-02, PNorm = 49.5712, GNorm = 0.4667, lr_0 = 2.0730e-04
Loss = 1.0343e-01, PNorm = 49.6000, GNorm = 0.5400, lr_0 = 2.0274e-04
Validation prc-auc = 0.488540
Validation auc = 0.791984
Epoch 21
Loss = 6.4507e-02, PNorm = 49.6100, GNorm = 0.7231, lr_0 = 1.9829e-04
Loss = 8.2657e-02, PNorm = 49.6305, GNorm = 0.4380, lr_0 = 1.9393e-04
Loss = 9.7792e-02, PNorm = 49.6621, GNorm = 0.4595, lr_0 = 1.8967e-04
Loss = 9.3851e-02, PNorm = 49.6849, GNorm = 0.5209, lr_0 = 1.8550e-04
Validation prc-auc = 0.468343
Validation auc = 0.809488
Epoch 22
Loss = 7.6328e-02, PNorm = 49.6987, GNorm = 0.4891, lr_0 = 1.8142e-04
Loss = 6.5779e-02, PNorm = 49.7294, GNorm = 0.2317, lr_0 = 1.7743e-04
Loss = 8.1999e-02, PNorm = 49.7496, GNorm = 0.5154, lr_0 = 1.7353e-04
Loss = 7.9646e-02, PNorm = 49.7645, GNorm = 1.2747, lr_0 = 1.6972e-04
Validation prc-auc = 0.516225
Validation auc = 0.799087
Epoch 23
Loss = 6.5629e-02, PNorm = 49.7840, GNorm = 0.4190, lr_0 = 1.6599e-04
Loss = 9.6331e-02, PNorm = 49.8079, GNorm = 0.3547, lr_0 = 1.6234e-04
Loss = 6.5168e-02, PNorm = 49.8278, GNorm = 0.7675, lr_0 = 1.5877e-04
Loss = 8.1699e-02, PNorm = 49.8367, GNorm = 1.3164, lr_0 = 1.5528e-04
Validation prc-auc = 0.502332
Validation auc = 0.787671
Epoch 24
Loss = 5.4010e-02, PNorm = 49.8658, GNorm = 0.2609, lr_0 = 1.5187e-04
Loss = 9.7606e-02, PNorm = 49.8758, GNorm = 0.9759, lr_0 = 1.4853e-04
Loss = 6.1867e-02, PNorm = 49.8920, GNorm = 0.2698, lr_0 = 1.4527e-04
Validation prc-auc = 0.509894
Validation auc = 0.789193
Epoch 25
Loss = 5.5314e-02, PNorm = 49.9102, GNorm = 0.3605, lr_0 = 1.4207e-04
Loss = 4.4467e-02, PNorm = 49.9336, GNorm = 0.6034, lr_0 = 1.3895e-04
Loss = 6.1799e-02, PNorm = 49.9480, GNorm = 0.9475, lr_0 = 1.3590e-04
Loss = 6.6292e-02, PNorm = 49.9590, GNorm = 1.2679, lr_0 = 1.3291e-04
Validation prc-auc = 0.512410
Validation auc = 0.769153
Epoch 26
Loss = 5.5130e-02, PNorm = 49.9751, GNorm = 0.2879, lr_0 = 1.2999e-04
Loss = 6.5472e-02, PNorm = 49.9956, GNorm = 0.3365, lr_0 = 1.2713e-04
Loss = 5.1213e-02, PNorm = 50.0160, GNorm = 0.4303, lr_0 = 1.2434e-04
Loss = 7.0891e-02, PNorm = 50.0262, GNorm = 0.6743, lr_0 = 1.2160e-04
Validation prc-auc = 0.430514
Validation auc = 0.776763
Epoch 27
Loss = 4.7855e-02, PNorm = 50.0386, GNorm = 0.1219, lr_0 = 1.1893e-04
Loss = 6.1219e-02, PNorm = 50.0498, GNorm = 0.8326, lr_0 = 1.1632e-04
Loss = 6.2223e-02, PNorm = 50.0578, GNorm = 0.4031, lr_0 = 1.1376e-04
Loss = 6.1911e-02, PNorm = 50.0742, GNorm = 0.4011, lr_0 = 1.1126e-04
Validation prc-auc = 0.520181
Validation auc = 0.785388
Epoch 28
Loss = 4.7331e-02, PNorm = 50.0920, GNorm = 0.8862, lr_0 = 1.0881e-04
Loss = 6.9337e-02, PNorm = 50.1041, GNorm = 0.4643, lr_0 = 1.0642e-04
Loss = 6.0135e-02, PNorm = 50.1143, GNorm = 0.8557, lr_0 = 1.0408e-04
Loss = 5.1135e-02, PNorm = 50.1242, GNorm = 0.1779, lr_0 = 1.0179e-04
Validation prc-auc = 0.521769
Validation auc = 0.767377
Epoch 29
Loss = 7.8594e-02, PNorm = 50.1358, GNorm = 1.2922, lr_0 = 1.0000e-04
Loss = 4.1239e-02, PNorm = 50.1496, GNorm = 0.7113, lr_0 = 1.0000e-04
Loss = 6.1212e-02, PNorm = 50.1612, GNorm = 0.5034, lr_0 = 1.0000e-04
Validation prc-auc = 0.506223
Validation auc = 0.790208
Model 0 best validation prc-auc = 0.560458 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.426701
Model 0 test auc = 0.813158
Ensemble test prc-auc = 0.426701
Ensemble test auc = 0.813158
Fold 23
Splitting data with seed 23
Total scaffolds = 1,115 | train scaffolds = 856 | val scaffolds = 156 | test scaffolds = 103
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.2626e-01, PNorm = 46.0443, GNorm = 0.9961, lr_0 = 2.3378e-04
Loss = 2.6352e-01, PNorm = 46.0594, GNorm = 0.3617, lr_0 = 3.5541e-04
Loss = 1.9246e-01, PNorm = 46.0863, GNorm = 0.6969, lr_0 = 4.7703e-04
Validation prc-auc = 0.253631
Validation auc = 0.689945
Epoch 1
Loss = 2.7207e-01, PNorm = 46.1098, GNorm = 0.2588, lr_0 = 6.1081e-04
Loss = 2.0782e-01, PNorm = 46.1479, GNorm = 0.4302, lr_0 = 7.3243e-04
Loss = 2.0673e-01, PNorm = 46.1932, GNorm = 0.8685, lr_0 = 8.5405e-04
Loss = 1.7714e-01, PNorm = 46.2578, GNorm = 0.2304, lr_0 = 9.7568e-04
Validation prc-auc = 0.279078
Validation auc = 0.763498
Epoch 2
Loss = 2.1271e-01, PNorm = 46.3380, GNorm = 0.4353, lr_0 = 9.8238e-04
Loss = 2.1436e-01, PNorm = 46.4015, GNorm = 0.3751, lr_0 = 9.6078e-04
Loss = 2.1398e-01, PNorm = 46.4690, GNorm = 0.2070, lr_0 = 9.3966e-04
Loss = 1.7008e-01, PNorm = 46.5381, GNorm = 0.4624, lr_0 = 9.1901e-04
Validation prc-auc = 0.306734
Validation auc = 0.784624
Epoch 3
Loss = 2.0599e-01, PNorm = 46.6027, GNorm = 1.0378, lr_0 = 8.9881e-04
Loss = 1.8063e-01, PNorm = 46.6634, GNorm = 0.6292, lr_0 = 8.7905e-04
Loss = 1.6913e-01, PNorm = 46.7437, GNorm = 0.3933, lr_0 = 8.5973e-04
Loss = 2.1200e-01, PNorm = 46.8065, GNorm = 0.5473, lr_0 = 8.4083e-04
Validation prc-auc = 0.412054
Validation auc = 0.811033
Epoch 4
Loss = 1.9768e-01, PNorm = 46.8483, GNorm = 0.2562, lr_0 = 8.2235e-04
Loss = 1.4096e-01, PNorm = 46.9171, GNorm = 0.2582, lr_0 = 8.0428e-04
Loss = 1.4238e-01, PNorm = 46.9756, GNorm = 0.7117, lr_0 = 7.8660e-04
Validation prc-auc = 0.366359
Validation auc = 0.780321
Epoch 5
Loss = 1.4749e-01, PNorm = 47.0162, GNorm = 0.2803, lr_0 = 7.6931e-04
Loss = 2.0804e-01, PNorm = 47.0829, GNorm = 0.4733, lr_0 = 7.5240e-04
Loss = 1.3774e-01, PNorm = 47.1443, GNorm = 0.5384, lr_0 = 7.3586e-04
Loss = 1.5397e-01, PNorm = 47.2048, GNorm = 0.4663, lr_0 = 7.1969e-04
Validation prc-auc = 0.407456
Validation auc = 0.806925
Epoch 6
Loss = 1.3121e-01, PNorm = 47.2706, GNorm = 0.4920, lr_0 = 7.0387e-04
Loss = 1.1751e-01, PNorm = 47.3198, GNorm = 0.5480, lr_0 = 6.8840e-04
Loss = 1.6936e-01, PNorm = 47.3820, GNorm = 0.2480, lr_0 = 6.7326e-04
Loss = 1.7745e-01, PNorm = 47.4384, GNorm = 0.2492, lr_0 = 6.5847e-04
Validation prc-auc = 0.489353
Validation auc = 0.822183
Epoch 7
Loss = 1.3084e-01, PNorm = 47.5051, GNorm = 0.3100, lr_0 = 6.4399e-04
Loss = 1.4340e-01, PNorm = 47.5837, GNorm = 1.1543, lr_0 = 6.2984e-04
Loss = 1.5298e-01, PNorm = 47.6311, GNorm = 0.1232, lr_0 = 6.1599e-04
Loss = 1.9666e-01, PNorm = 47.6521, GNorm = 0.2541, lr_0 = 6.0245e-04
Validation prc-auc = 0.454001
Validation auc = 0.801056
Epoch 8
Loss = 1.5659e-01, PNorm = 47.7398, GNorm = 0.2925, lr_0 = 5.8921e-04
Loss = 1.3564e-01, PNorm = 47.8095, GNorm = 0.3171, lr_0 = 5.7626e-04
Loss = 1.7717e-01, PNorm = 47.8582, GNorm = 0.4070, lr_0 = 5.6359e-04
Loss = 1.1648e-01, PNorm = 47.9271, GNorm = 0.3969, lr_0 = 5.5120e-04
Validation prc-auc = 0.477790
Validation auc = 0.829812
Epoch 9
Loss = 1.1208e-01, PNorm = 47.9751, GNorm = 0.2196, lr_0 = 5.3909e-04
Loss = 1.3521e-01, PNorm = 48.0077, GNorm = 0.2934, lr_0 = 5.2724e-04
Loss = 1.5355e-01, PNorm = 48.0396, GNorm = 0.1691, lr_0 = 5.1565e-04
Validation prc-auc = 0.485165
Validation auc = 0.855829
Epoch 10
Loss = 1.7560e-01, PNorm = 48.0864, GNorm = 0.7553, lr_0 = 5.0432e-04
Loss = 1.4174e-01, PNorm = 48.1262, GNorm = 0.4445, lr_0 = 4.9323e-04
Loss = 1.2889e-01, PNorm = 48.1808, GNorm = 0.2395, lr_0 = 4.8239e-04
Loss = 9.4258e-02, PNorm = 48.2239, GNorm = 0.1882, lr_0 = 4.7179e-04
Validation prc-auc = 0.459516
Validation auc = 0.828638
Epoch 11
Loss = 1.8291e-01, PNorm = 48.2444, GNorm = 1.0829, lr_0 = 4.6142e-04
Loss = 1.1750e-01, PNorm = 48.2964, GNorm = 0.2787, lr_0 = 4.5127e-04
Loss = 1.1758e-01, PNorm = 48.3239, GNorm = 0.3951, lr_0 = 4.4135e-04
Loss = 1.4147e-01, PNorm = 48.3704, GNorm = 0.8694, lr_0 = 4.3165e-04
Validation prc-auc = 0.498249
Validation auc = 0.849765
Epoch 12
Loss = 1.2389e-01, PNorm = 48.4224, GNorm = 0.5443, lr_0 = 4.2217e-04
Loss = 1.3098e-01, PNorm = 48.4594, GNorm = 1.0445, lr_0 = 4.1289e-04
Loss = 1.1617e-01, PNorm = 48.5059, GNorm = 0.3730, lr_0 = 4.0381e-04
Loss = 1.1985e-01, PNorm = 48.5477, GNorm = 0.3256, lr_0 = 3.9493e-04
Validation prc-auc = 0.477760
Validation auc = 0.822770
Epoch 13
Loss = 1.2759e-01, PNorm = 48.5741, GNorm = 0.3300, lr_0 = 3.8625e-04
Loss = 9.0805e-02, PNorm = 48.6168, GNorm = 0.8380, lr_0 = 3.7776e-04
Loss = 1.7485e-01, PNorm = 48.6368, GNorm = 0.8824, lr_0 = 3.6946e-04
Loss = 1.3248e-01, PNorm = 48.6982, GNorm = 0.5600, lr_0 = 3.6134e-04
Validation prc-auc = 0.454442
Validation auc = 0.805751
Epoch 14
Loss = 1.2635e-01, PNorm = 48.7319, GNorm = 0.2127, lr_0 = 3.5340e-04
Loss = 1.4738e-01, PNorm = 48.7669, GNorm = 0.4557, lr_0 = 3.4563e-04
Loss = 1.1812e-01, PNorm = 48.8239, GNorm = 0.4131, lr_0 = 3.3803e-04
Validation prc-auc = 0.531223
Validation auc = 0.831573
Epoch 15
Loss = 8.3589e-02, PNorm = 48.8501, GNorm = 0.3079, lr_0 = 3.3060e-04
Loss = 1.0906e-01, PNorm = 48.8764, GNorm = 0.2908, lr_0 = 3.2333e-04
Loss = 1.1006e-01, PNorm = 48.9170, GNorm = 0.1565, lr_0 = 3.1623e-04
Loss = 1.2778e-01, PNorm = 48.9367, GNorm = 0.3883, lr_0 = 3.0928e-04
Validation prc-auc = 0.443857
Validation auc = 0.791471
Epoch 16
Loss = 4.7508e-02, PNorm = 48.9686, GNorm = 0.2892, lr_0 = 3.0248e-04
Loss = 1.3389e-01, PNorm = 49.0058, GNorm = 0.7594, lr_0 = 2.9583e-04
Loss = 1.0155e-01, PNorm = 49.0439, GNorm = 0.2246, lr_0 = 2.8933e-04
Loss = 1.1571e-01, PNorm = 49.0769, GNorm = 0.3904, lr_0 = 2.8297e-04
Validation prc-auc = 0.522447
Validation auc = 0.829812
Epoch 17
Loss = 6.5360e-02, PNorm = 49.1044, GNorm = 0.1760, lr_0 = 2.7675e-04
Loss = 1.3549e-01, PNorm = 49.1289, GNorm = 0.4633, lr_0 = 2.7067e-04
Loss = 8.3606e-02, PNorm = 49.1662, GNorm = 0.5324, lr_0 = 2.6472e-04
Loss = 1.0212e-01, PNorm = 49.1944, GNorm = 0.2197, lr_0 = 2.5890e-04
Validation prc-auc = 0.514472
Validation auc = 0.822574
Epoch 18
Loss = 7.2950e-02, PNorm = 49.2265, GNorm = 0.6691, lr_0 = 2.5321e-04
Loss = 1.0573e-01, PNorm = 49.2468, GNorm = 0.5579, lr_0 = 2.4764e-04
Loss = 9.6165e-02, PNorm = 49.2704, GNorm = 0.5289, lr_0 = 2.4220e-04
Loss = 8.8697e-02, PNorm = 49.3065, GNorm = 0.6039, lr_0 = 2.3687e-04
Validation prc-auc = 0.492111
Validation auc = 0.809468
Epoch 19
Loss = 8.5217e-02, PNorm = 49.3398, GNorm = 0.4614, lr_0 = 2.3167e-04
Loss = 9.5302e-02, PNorm = 49.3741, GNorm = 0.6301, lr_0 = 2.2658e-04
Loss = 9.9141e-02, PNorm = 49.4035, GNorm = 0.4630, lr_0 = 2.2159e-04
Validation prc-auc = 0.488782
Validation auc = 0.821009
Epoch 20
Loss = 6.3988e-02, PNorm = 49.4298, GNorm = 0.2581, lr_0 = 2.1672e-04
Loss = 7.2674e-02, PNorm = 49.4509, GNorm = 0.7085, lr_0 = 2.1196e-04
Loss = 1.0921e-01, PNorm = 49.4762, GNorm = 0.2400, lr_0 = 2.0730e-04
Loss = 9.2390e-02, PNorm = 49.5071, GNorm = 0.3582, lr_0 = 2.0274e-04
Validation prc-auc = 0.497620
Validation auc = 0.816901
Epoch 21
Loss = 3.2806e-02, PNorm = 49.5431, GNorm = 0.4085, lr_0 = 1.9829e-04
Loss = 9.0155e-02, PNorm = 49.5588, GNorm = 0.5980, lr_0 = 1.9393e-04
Loss = 6.2453e-02, PNorm = 49.5898, GNorm = 0.3615, lr_0 = 1.8967e-04
Loss = 9.3238e-02, PNorm = 49.6122, GNorm = 0.4862, lr_0 = 1.8550e-04
Validation prc-auc = 0.490926
Validation auc = 0.790689
Epoch 22
Loss = 8.3366e-02, PNorm = 49.6397, GNorm = 0.6164, lr_0 = 1.8142e-04
Loss = 8.2078e-02, PNorm = 49.6637, GNorm = 1.4636, lr_0 = 1.7743e-04
Loss = 8.4772e-02, PNorm = 49.6853, GNorm = 0.3649, lr_0 = 1.7353e-04
Loss = 7.6891e-02, PNorm = 49.7135, GNorm = 0.2945, lr_0 = 1.6972e-04
Validation prc-auc = 0.500194
Validation auc = 0.800469
Epoch 23
Loss = 6.7054e-02, PNorm = 49.7313, GNorm = 0.7467, lr_0 = 1.6599e-04
Loss = 6.8263e-02, PNorm = 49.7523, GNorm = 0.5509, lr_0 = 1.6234e-04
Loss = 6.8187e-02, PNorm = 49.7735, GNorm = 0.7386, lr_0 = 1.5877e-04
Loss = 7.6220e-02, PNorm = 49.7940, GNorm = 0.7093, lr_0 = 1.5528e-04
Validation prc-auc = 0.516391
Validation auc = 0.812989
Epoch 24
Loss = 6.5457e-02, PNorm = 49.8102, GNorm = 0.6873, lr_0 = 1.5187e-04
Loss = 8.7559e-02, PNorm = 49.8359, GNorm = 0.8127, lr_0 = 1.4853e-04
Loss = 5.6711e-02, PNorm = 49.8592, GNorm = 0.6631, lr_0 = 1.4527e-04
Validation prc-auc = 0.511312
Validation auc = 0.794601
Epoch 25
Loss = 4.6854e-02, PNorm = 49.8765, GNorm = 0.6583, lr_0 = 1.4207e-04
Loss = 4.4272e-02, PNorm = 49.8899, GNorm = 0.3836, lr_0 = 1.3895e-04
Loss = 6.2987e-02, PNorm = 49.9132, GNorm = 1.1803, lr_0 = 1.3590e-04
Loss = 7.5531e-02, PNorm = 49.9277, GNorm = 0.8248, lr_0 = 1.3291e-04
Validation prc-auc = 0.517971
Validation auc = 0.792449
Epoch 26
Loss = 4.4354e-02, PNorm = 49.9479, GNorm = 0.3860, lr_0 = 1.2999e-04
Loss = 7.2496e-02, PNorm = 49.9618, GNorm = 2.2542, lr_0 = 1.2713e-04
Loss = 5.0001e-02, PNorm = 49.9787, GNorm = 0.3221, lr_0 = 1.2434e-04
Loss = 5.4824e-02, PNorm = 49.9919, GNorm = 0.5195, lr_0 = 1.2160e-04
Validation prc-auc = 0.515966
Validation auc = 0.807316
Epoch 27
Loss = 4.1468e-02, PNorm = 50.0061, GNorm = 0.3865, lr_0 = 1.1893e-04
Loss = 5.2433e-02, PNorm = 50.0225, GNorm = 2.0449, lr_0 = 1.1632e-04
Loss = 6.3797e-02, PNorm = 50.0347, GNorm = 0.4941, lr_0 = 1.1376e-04
Loss = 4.6504e-02, PNorm = 50.0474, GNorm = 0.5883, lr_0 = 1.1126e-04
Validation prc-auc = 0.510283
Validation auc = 0.788537
Epoch 28
Loss = 4.8062e-02, PNorm = 50.0641, GNorm = 0.3398, lr_0 = 1.0881e-04
Loss = 5.2710e-02, PNorm = 50.0745, GNorm = 0.3420, lr_0 = 1.0642e-04
Loss = 6.3152e-02, PNorm = 50.0913, GNorm = 0.1672, lr_0 = 1.0408e-04
Loss = 5.1904e-02, PNorm = 50.1015, GNorm = 0.6890, lr_0 = 1.0179e-04
Validation prc-auc = 0.517781
Validation auc = 0.781495
Epoch 29
Loss = 3.6545e-02, PNorm = 50.1175, GNorm = 0.2490, lr_0 = 1.0000e-04
Loss = 5.1641e-02, PNorm = 50.1282, GNorm = 0.2271, lr_0 = 1.0000e-04
Loss = 3.9924e-02, PNorm = 50.1398, GNorm = 0.8332, lr_0 = 1.0000e-04
Validation prc-auc = 0.482360
Validation auc = 0.789319
Model 0 best validation prc-auc = 0.531223 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.260567
Model 0 test auc = 0.678070
Ensemble test prc-auc = 0.260567
Ensemble test auc = 0.678070
Fold 24
Splitting data with seed 24
Total scaffolds = 1,115 | train scaffolds = 872 | val scaffolds = 140 | test scaffolds = 103
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.7131e-01, PNorm = 46.0436, GNorm = 0.2353, lr_0 = 2.3378e-04
Loss = 2.1876e-01, PNorm = 46.0622, GNorm = 0.6841, lr_0 = 3.5541e-04
Loss = 2.2544e-01, PNorm = 46.0813, GNorm = 0.5886, lr_0 = 4.7703e-04
Validation prc-auc = 0.387252
Validation auc = 0.823529
Epoch 1
Loss = 2.0352e-01, PNorm = 46.1166, GNorm = 0.7169, lr_0 = 6.1081e-04
Loss = 2.3953e-01, PNorm = 46.1530, GNorm = 0.6724, lr_0 = 7.3243e-04
Loss = 1.8116e-01, PNorm = 46.1965, GNorm = 0.2516, lr_0 = 8.5405e-04
Loss = 1.9607e-01, PNorm = 46.2536, GNorm = 0.8389, lr_0 = 9.7568e-04
Validation prc-auc = 0.535127
Validation auc = 0.870856
Epoch 2
Loss = 1.9531e-01, PNorm = 46.3033, GNorm = 0.5048, lr_0 = 9.8238e-04
Loss = 1.7120e-01, PNorm = 46.3777, GNorm = 0.2600, lr_0 = 9.6078e-04
Loss = 1.8211e-01, PNorm = 46.4335, GNorm = 0.4092, lr_0 = 9.3966e-04
Loss = 1.8729e-01, PNorm = 46.5128, GNorm = 0.4837, lr_0 = 9.1901e-04
Validation prc-auc = 0.512870
Validation auc = 0.881016
Epoch 3
Loss = 1.5939e-01, PNorm = 46.5681, GNorm = 0.2514, lr_0 = 8.9881e-04
Loss = 1.6281e-01, PNorm = 46.6501, GNorm = 0.3366, lr_0 = 8.7905e-04
Loss = 2.1172e-01, PNorm = 46.7293, GNorm = 0.7900, lr_0 = 8.5973e-04
Loss = 1.6660e-01, PNorm = 46.8215, GNorm = 0.2920, lr_0 = 8.4083e-04
Validation prc-auc = 0.458173
Validation auc = 0.872193
Epoch 4
Loss = 1.7731e-01, PNorm = 46.8860, GNorm = 0.6596, lr_0 = 8.2235e-04
Loss = 1.7863e-01, PNorm = 46.9632, GNorm = 0.3650, lr_0 = 8.0428e-04
Loss = 1.6260e-01, PNorm = 47.0639, GNorm = 0.1795, lr_0 = 7.8660e-04
Validation prc-auc = 0.536689
Validation auc = 0.881551
Epoch 5
Loss = 5.1620e-02, PNorm = 47.1220, GNorm = 0.1881, lr_0 = 7.6931e-04
Loss = 1.5447e-01, PNorm = 47.1656, GNorm = 0.5605, lr_0 = 7.5240e-04
Loss = 1.4454e-01, PNorm = 47.2560, GNorm = 0.5382, lr_0 = 7.3586e-04
Loss = 2.1189e-01, PNorm = 47.3249, GNorm = 0.5087, lr_0 = 7.1969e-04
Validation prc-auc = 0.502364
Validation auc = 0.835829
Epoch 6
Loss = 1.4744e-01, PNorm = 47.3749, GNorm = 0.3527, lr_0 = 7.0387e-04
Loss = 1.4419e-01, PNorm = 47.4186, GNorm = 0.4960, lr_0 = 6.8840e-04
Loss = 1.4960e-01, PNorm = 47.4889, GNorm = 0.4484, lr_0 = 6.7326e-04
Loss = 1.4810e-01, PNorm = 47.5353, GNorm = 0.3013, lr_0 = 6.5847e-04
Validation prc-auc = 0.561933
Validation auc = 0.894652
Epoch 7
Loss = 1.5633e-01, PNorm = 47.5967, GNorm = 0.4553, lr_0 = 6.4399e-04
Loss = 1.2486e-01, PNorm = 47.6601, GNorm = 0.8616, lr_0 = 6.2984e-04
Loss = 1.5221e-01, PNorm = 47.7140, GNorm = 0.6231, lr_0 = 6.1599e-04
Loss = 1.6313e-01, PNorm = 47.7700, GNorm = 0.4416, lr_0 = 6.0245e-04
Validation prc-auc = 0.506736
Validation auc = 0.828075
Epoch 8
Loss = 1.1884e-01, PNorm = 47.8198, GNorm = 0.1802, lr_0 = 5.8921e-04
Loss = 1.3551e-01, PNorm = 47.8880, GNorm = 0.2316, lr_0 = 5.7626e-04
Loss = 1.5459e-01, PNorm = 47.9232, GNorm = 0.4196, lr_0 = 5.6359e-04
Loss = 1.5540e-01, PNorm = 47.9638, GNorm = 0.2915, lr_0 = 5.5120e-04
Validation prc-auc = 0.516567
Validation auc = 0.868182
Epoch 9
Loss = 1.1376e-01, PNorm = 48.0134, GNorm = 0.4860, lr_0 = 5.3909e-04
Loss = 1.5110e-01, PNorm = 48.0530, GNorm = 0.7112, lr_0 = 5.2724e-04
Loss = 1.3435e-01, PNorm = 48.1176, GNorm = 0.2205, lr_0 = 5.1565e-04
Validation prc-auc = 0.529219
Validation auc = 0.881818
Epoch 10
Loss = 1.3731e-01, PNorm = 48.1479, GNorm = 0.4721, lr_0 = 5.0432e-04
Loss = 1.4345e-01, PNorm = 48.2038, GNorm = 0.3075, lr_0 = 4.9323e-04
Loss = 1.2172e-01, PNorm = 48.2489, GNorm = 0.3175, lr_0 = 4.8239e-04
Loss = 1.3508e-01, PNorm = 48.2822, GNorm = 0.3213, lr_0 = 4.7179e-04
Validation prc-auc = 0.494159
Validation auc = 0.855080
Epoch 11
Loss = 1.0028e-01, PNorm = 48.3255, GNorm = 0.6330, lr_0 = 4.6142e-04
Loss = 1.0168e-01, PNorm = 48.3789, GNorm = 0.5995, lr_0 = 4.5127e-04
Loss = 1.3137e-01, PNorm = 48.4186, GNorm = 0.3439, lr_0 = 4.4135e-04
Loss = 1.2108e-01, PNorm = 48.4560, GNorm = 0.3318, lr_0 = 4.3165e-04
Validation prc-auc = 0.519906
Validation auc = 0.844920
Epoch 12
Loss = 1.4142e-01, PNorm = 48.5166, GNorm = 0.3131, lr_0 = 4.2217e-04
Loss = 1.2051e-01, PNorm = 48.5784, GNorm = 0.7984, lr_0 = 4.1289e-04
Loss = 9.6526e-02, PNorm = 48.6295, GNorm = 0.2275, lr_0 = 4.0381e-04
Loss = 1.2946e-01, PNorm = 48.6526, GNorm = 0.4094, lr_0 = 3.9493e-04
Validation prc-auc = 0.488602
Validation auc = 0.890642
Epoch 13
Loss = 7.9986e-02, PNorm = 48.7110, GNorm = 0.1660, lr_0 = 3.8625e-04
Loss = 1.3797e-01, PNorm = 48.7516, GNorm = 0.3715, lr_0 = 3.7776e-04
Loss = 1.1955e-01, PNorm = 48.7991, GNorm = 0.6723, lr_0 = 3.6946e-04
Loss = 1.1743e-01, PNorm = 48.8422, GNorm = 0.6035, lr_0 = 3.6134e-04
Validation prc-auc = 0.525031
Validation auc = 0.890107
Epoch 14
Loss = 7.7148e-02, PNorm = 48.8826, GNorm = 0.3812, lr_0 = 3.5340e-04
Loss = 1.1798e-01, PNorm = 48.9195, GNorm = 0.8638, lr_0 = 3.4563e-04
Loss = 1.2412e-01, PNorm = 48.9585, GNorm = 0.7446, lr_0 = 3.3803e-04
Validation prc-auc = 0.462509
Validation auc = 0.839037
Epoch 15
Loss = 9.6484e-02, PNorm = 49.0084, GNorm = 0.2189, lr_0 = 3.3060e-04
Loss = 1.2223e-01, PNorm = 49.0533, GNorm = 0.5203, lr_0 = 3.2333e-04
Loss = 7.5654e-02, PNorm = 49.1022, GNorm = 0.5352, lr_0 = 3.1623e-04
Loss = 1.0303e-01, PNorm = 49.1347, GNorm = 0.1853, lr_0 = 3.0928e-04
Validation prc-auc = 0.496891
Validation auc = 0.850802
Epoch 16
Loss = 1.3287e-01, PNorm = 49.1718, GNorm = 0.3311, lr_0 = 3.0248e-04
Loss = 9.2234e-02, PNorm = 49.2051, GNorm = 0.1820, lr_0 = 2.9583e-04
Loss = 7.5504e-02, PNorm = 49.2440, GNorm = 0.1754, lr_0 = 2.8933e-04
Loss = 1.1370e-01, PNorm = 49.2776, GNorm = 0.5846, lr_0 = 2.8297e-04
Validation prc-auc = 0.404043
Validation auc = 0.781551
Epoch 17
Loss = 9.1951e-02, PNorm = 49.3169, GNorm = 0.5662, lr_0 = 2.7675e-04
Loss = 8.9017e-02, PNorm = 49.3446, GNorm = 0.8134, lr_0 = 2.7067e-04
Loss = 7.7272e-02, PNorm = 49.3899, GNorm = 0.4892, lr_0 = 2.6472e-04
Loss = 1.2057e-01, PNorm = 49.4130, GNorm = 0.8292, lr_0 = 2.5890e-04
Validation prc-auc = 0.380101
Validation auc = 0.775134
Epoch 18
Loss = 9.1609e-02, PNorm = 49.4487, GNorm = 1.0980, lr_0 = 2.5321e-04
Loss = 1.0497e-01, PNorm = 49.4736, GNorm = 0.4967, lr_0 = 2.4764e-04
Loss = 8.0985e-02, PNorm = 49.5003, GNorm = 0.5024, lr_0 = 2.4220e-04
Loss = 1.1005e-01, PNorm = 49.5427, GNorm = 0.3257, lr_0 = 2.3687e-04
Validation prc-auc = 0.329357
Validation auc = 0.737433
Epoch 19
Loss = 9.3319e-02, PNorm = 49.5793, GNorm = 0.6945, lr_0 = 2.3167e-04
Loss = 6.2476e-02, PNorm = 49.6198, GNorm = 0.9148, lr_0 = 2.2658e-04
Loss = 9.4556e-02, PNorm = 49.6418, GNorm = 0.6008, lr_0 = 2.2159e-04
Validation prc-auc = 0.376437
Validation auc = 0.751872
Epoch 20
Loss = 7.4649e-02, PNorm = 49.6683, GNorm = 0.6051, lr_0 = 2.1672e-04
Loss = 9.1273e-02, PNorm = 49.6887, GNorm = 0.5125, lr_0 = 2.1196e-04
Loss = 8.1326e-02, PNorm = 49.7116, GNorm = 0.2749, lr_0 = 2.0730e-04
Loss = 7.2401e-02, PNorm = 49.7410, GNorm = 0.7984, lr_0 = 2.0274e-04
Validation prc-auc = 0.407319
Validation auc = 0.786364
Epoch 21
Loss = 5.5675e-02, PNorm = 49.7594, GNorm = 0.4436, lr_0 = 1.9829e-04
Loss = 5.5320e-02, PNorm = 49.7865, GNorm = 0.4127, lr_0 = 1.9393e-04
Loss = 7.1459e-02, PNorm = 49.8095, GNorm = 0.9869, lr_0 = 1.8967e-04
Loss = 8.1926e-02, PNorm = 49.8405, GNorm = 0.6026, lr_0 = 1.8550e-04
Validation prc-auc = 0.391832
Validation auc = 0.759358
Epoch 22
Loss = 5.6399e-02, PNorm = 49.8603, GNorm = 0.2724, lr_0 = 1.8142e-04
Loss = 8.6134e-02, PNorm = 49.8827, GNorm = 0.2637, lr_0 = 1.7743e-04
Loss = 7.1259e-02, PNorm = 49.9012, GNorm = 0.1596, lr_0 = 1.7353e-04
Loss = 9.9503e-02, PNorm = 49.9239, GNorm = 0.4671, lr_0 = 1.6972e-04
Validation prc-auc = 0.417898
Validation auc = 0.776471
Epoch 23
Loss = 5.6969e-02, PNorm = 49.9559, GNorm = 0.4365, lr_0 = 1.6599e-04
Loss = 6.8791e-02, PNorm = 49.9698, GNorm = 0.4886, lr_0 = 1.6234e-04
Loss = 6.5847e-02, PNorm = 49.9896, GNorm = 0.2903, lr_0 = 1.5877e-04
Loss = 8.0438e-02, PNorm = 50.0082, GNorm = 0.8136, lr_0 = 1.5528e-04
Validation prc-auc = 0.389258
Validation auc = 0.779679
Epoch 24
Loss = 6.2119e-02, PNorm = 50.0240, GNorm = 0.4446, lr_0 = 1.5187e-04
Loss = 6.0302e-02, PNorm = 50.0420, GNorm = 0.5587, lr_0 = 1.4853e-04
Loss = 7.3049e-02, PNorm = 50.0669, GNorm = 0.3923, lr_0 = 1.4527e-04
Validation prc-auc = 0.368828
Validation auc = 0.759091
Epoch 25
Loss = 3.5622e-02, PNorm = 50.0766, GNorm = 0.2893, lr_0 = 1.4207e-04
Loss = 7.0558e-02, PNorm = 50.0899, GNorm = 0.2879, lr_0 = 1.3895e-04
Loss = 4.3349e-02, PNorm = 50.1084, GNorm = 0.7021, lr_0 = 1.3590e-04
Loss = 4.9770e-02, PNorm = 50.1263, GNorm = 0.4534, lr_0 = 1.3291e-04
Validation prc-auc = 0.404805
Validation auc = 0.781016
Epoch 26
Loss = 5.4806e-02, PNorm = 50.1403, GNorm = 0.5967, lr_0 = 1.2999e-04
Loss = 5.8693e-02, PNorm = 50.1575, GNorm = 0.5803, lr_0 = 1.2713e-04
Loss = 3.7127e-02, PNorm = 50.1712, GNorm = 0.4712, lr_0 = 1.2434e-04
Loss = 5.8205e-02, PNorm = 50.1843, GNorm = 0.4651, lr_0 = 1.2160e-04
Validation prc-auc = 0.305217
Validation auc = 0.704813
Epoch 27
Loss = 5.6882e-02, PNorm = 50.1974, GNorm = 0.8719, lr_0 = 1.1893e-04
Loss = 4.7795e-02, PNorm = 50.2120, GNorm = 0.4205, lr_0 = 1.1632e-04
Loss = 5.5451e-02, PNorm = 50.2220, GNorm = 0.2321, lr_0 = 1.1376e-04
Loss = 5.5647e-02, PNorm = 50.2371, GNorm = 0.7164, lr_0 = 1.1126e-04
Validation prc-auc = 0.333211
Validation auc = 0.704278
Epoch 28
Loss = 4.6589e-02, PNorm = 50.2499, GNorm = 0.7818, lr_0 = 1.0881e-04
Loss = 3.5734e-02, PNorm = 50.2605, GNorm = 0.5629, lr_0 = 1.0642e-04
Loss = 4.1912e-02, PNorm = 50.2709, GNorm = 0.6187, lr_0 = 1.0408e-04
Loss = 4.3996e-02, PNorm = 50.2808, GNorm = 0.6681, lr_0 = 1.0179e-04
Validation prc-auc = 0.346982
Validation auc = 0.733690
Epoch 29
Loss = 4.1139e-02, PNorm = 50.2940, GNorm = 0.5171, lr_0 = 1.0000e-04
Loss = 3.8302e-02, PNorm = 50.3040, GNorm = 0.4363, lr_0 = 1.0000e-04
Loss = 3.7644e-02, PNorm = 50.3186, GNorm = 0.2903, lr_0 = 1.0000e-04
Validation prc-auc = 0.311276
Validation auc = 0.673529
Model 0 best validation prc-auc = 0.561933 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.482664
Model 0 test auc = 0.692286
Ensemble test prc-auc = 0.482664
Ensemble test auc = 0.692286
Fold 25
Splitting data with seed 25
Total scaffolds = 1,115 | train scaffolds = 822 | val scaffolds = 152 | test scaffolds = 141
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.3517e-01, PNorm = 46.0448, GNorm = 1.2975, lr_0 = 2.3378e-04
Loss = 2.1789e-01, PNorm = 46.0571, GNorm = 0.9579, lr_0 = 3.5541e-04
Loss = 2.3178e-01, PNorm = 46.0811, GNorm = 0.3387, lr_0 = 4.7703e-04
Validation prc-auc = 0.193134
Validation auc = 0.754808
Epoch 1
Loss = 1.7228e-01, PNorm = 46.1101, GNorm = 0.3380, lr_0 = 6.1081e-04
Loss = 2.3055e-01, PNorm = 46.1400, GNorm = 0.6219, lr_0 = 7.3243e-04
Loss = 2.2168e-01, PNorm = 46.1826, GNorm = 0.4883, lr_0 = 8.5405e-04
Loss = 1.8187e-01, PNorm = 46.2268, GNorm = 0.1613, lr_0 = 9.7568e-04
Validation prc-auc = 0.357319
Validation auc = 0.723214
Epoch 2
Loss = 2.4585e-01, PNorm = 46.2870, GNorm = 0.8508, lr_0 = 9.8238e-04
Loss = 1.8983e-01, PNorm = 46.3665, GNorm = 0.3675, lr_0 = 9.6078e-04
Loss = 1.6188e-01, PNorm = 46.4652, GNorm = 0.2865, lr_0 = 9.3966e-04
Loss = 1.9326e-01, PNorm = 46.5496, GNorm = 0.2148, lr_0 = 9.1901e-04
Validation prc-auc = 0.425836
Validation auc = 0.789148
Epoch 3
Loss = 1.8343e-01, PNorm = 46.6230, GNorm = 2.1087, lr_0 = 8.9881e-04
Loss = 1.7444e-01, PNorm = 46.6800, GNorm = 0.2302, lr_0 = 8.7905e-04
Loss = 2.0514e-01, PNorm = 46.7554, GNorm = 0.2208, lr_0 = 8.5973e-04
Loss = 1.8133e-01, PNorm = 46.8557, GNorm = 0.5072, lr_0 = 8.4083e-04
Validation prc-auc = 0.413246
Validation auc = 0.766140
Epoch 4
Loss = 1.7208e-01, PNorm = 46.9427, GNorm = 0.4008, lr_0 = 8.2235e-04
Loss = 1.6374e-01, PNorm = 47.0362, GNorm = 0.4459, lr_0 = 8.0428e-04
Loss = 1.8259e-01, PNorm = 47.1085, GNorm = 0.2562, lr_0 = 7.8660e-04
Validation prc-auc = 0.584591
Validation auc = 0.812500
Epoch 5
Loss = 1.4035e-01, PNorm = 47.1876, GNorm = 0.1509, lr_0 = 7.6931e-04
Loss = 1.2315e-01, PNorm = 47.2660, GNorm = 0.2977, lr_0 = 7.5240e-04
Loss = 1.8451e-01, PNorm = 47.3332, GNorm = 0.4092, lr_0 = 7.3586e-04
Loss = 1.8065e-01, PNorm = 47.4055, GNorm = 0.3622, lr_0 = 7.1969e-04
Validation prc-auc = 0.579071
Validation auc = 0.785371
Epoch 6
Loss = 1.1684e-01, PNorm = 47.4576, GNorm = 0.2458, lr_0 = 7.0387e-04
Loss = 1.3458e-01, PNorm = 47.5315, GNorm = 0.3558, lr_0 = 6.8840e-04
Loss = 1.5572e-01, PNorm = 47.5965, GNorm = 0.3900, lr_0 = 6.7326e-04
Loss = 1.6790e-01, PNorm = 47.6453, GNorm = 0.2582, lr_0 = 6.5847e-04
Validation prc-auc = 0.646893
Validation auc = 0.795673
Epoch 7
Loss = 1.5963e-01, PNorm = 47.6847, GNorm = 0.4045, lr_0 = 6.4399e-04
Loss = 1.3777e-01, PNorm = 47.7532, GNorm = 0.4122, lr_0 = 6.2984e-04
Loss = 1.4662e-01, PNorm = 47.8369, GNorm = 1.2979, lr_0 = 6.1599e-04
Loss = 1.6603e-01, PNorm = 47.8693, GNorm = 0.1986, lr_0 = 6.0245e-04
Validation prc-auc = 0.578999
Validation auc = 0.817651
Epoch 8
Loss = 1.1721e-01, PNorm = 47.9255, GNorm = 0.3888, lr_0 = 5.8921e-04
Loss = 1.9117e-01, PNorm = 47.9793, GNorm = 0.4000, lr_0 = 5.7626e-04
Loss = 1.5183e-01, PNorm = 48.0459, GNorm = 0.1386, lr_0 = 5.6359e-04
Loss = 1.5458e-01, PNorm = 48.0836, GNorm = 0.2981, lr_0 = 5.5120e-04
Validation prc-auc = 0.624727
Validation auc = 0.793956
Epoch 9
Loss = 1.4003e-01, PNorm = 48.1398, GNorm = 0.3034, lr_0 = 5.3909e-04
Loss = 1.1524e-01, PNorm = 48.1876, GNorm = 0.2190, lr_0 = 5.2724e-04
Loss = 1.6007e-01, PNorm = 48.2266, GNorm = 1.5633, lr_0 = 5.1565e-04
Validation prc-auc = 0.560774
Validation auc = 0.799794
Epoch 10
Loss = 1.6543e-01, PNorm = 48.2818, GNorm = 0.5302, lr_0 = 5.0432e-04
Loss = 1.6543e-01, PNorm = 48.3299, GNorm = 0.4897, lr_0 = 4.9323e-04
Loss = 1.3074e-01, PNorm = 48.3932, GNorm = 0.4083, lr_0 = 4.8239e-04
Loss = 1.3008e-01, PNorm = 48.4413, GNorm = 0.3400, lr_0 = 4.7179e-04
Validation prc-auc = 0.644799
Validation auc = 0.801511
Epoch 11
Loss = 1.3272e-01, PNorm = 48.4772, GNorm = 0.5916, lr_0 = 4.6142e-04
Loss = 1.5922e-01, PNorm = 48.5090, GNorm = 0.3034, lr_0 = 4.5127e-04
Loss = 1.3336e-01, PNorm = 48.5603, GNorm = 0.5353, lr_0 = 4.4135e-04
Loss = 1.3235e-01, PNorm = 48.5993, GNorm = 0.2435, lr_0 = 4.3165e-04
Validation prc-auc = 0.656170
Validation auc = 0.792239
Epoch 12
Loss = 1.6980e-01, PNorm = 48.6350, GNorm = 0.2399, lr_0 = 4.2217e-04
Loss = 1.1944e-01, PNorm = 48.6774, GNorm = 0.3557, lr_0 = 4.1289e-04
Loss = 1.0221e-01, PNorm = 48.7327, GNorm = 0.5764, lr_0 = 4.0381e-04
Loss = 1.1917e-01, PNorm = 48.7671, GNorm = 0.4430, lr_0 = 3.9493e-04
Validation prc-auc = 0.612043
Validation auc = 0.800481
Epoch 13
Loss = 1.3531e-01, PNorm = 48.8028, GNorm = 0.2955, lr_0 = 3.8625e-04
Loss = 1.1480e-01, PNorm = 48.8571, GNorm = 0.6252, lr_0 = 3.7776e-04
Loss = 1.2339e-01, PNorm = 48.8943, GNorm = 0.7173, lr_0 = 3.6946e-04
Loss = 1.0875e-01, PNorm = 48.9343, GNorm = 0.3608, lr_0 = 3.6134e-04
Validation prc-auc = 0.638856
Validation auc = 0.787431
Epoch 14
Loss = 1.1011e-01, PNorm = 48.9609, GNorm = 0.2763, lr_0 = 3.5340e-04
Loss = 1.1965e-01, PNorm = 48.9982, GNorm = 0.2261, lr_0 = 3.4563e-04
Loss = 1.2003e-01, PNorm = 49.0377, GNorm = 0.2247, lr_0 = 3.3803e-04
Validation prc-auc = 0.582775
Validation auc = 0.800481
Epoch 15
Loss = 8.7831e-02, PNorm = 49.0777, GNorm = 0.4919, lr_0 = 3.3060e-04
Loss = 9.5893e-02, PNorm = 49.1140, GNorm = 0.9574, lr_0 = 3.2333e-04
Loss = 1.1076e-01, PNorm = 49.1580, GNorm = 0.3743, lr_0 = 3.1623e-04
Loss = 1.3110e-01, PNorm = 49.1982, GNorm = 0.7307, lr_0 = 3.0928e-04
Validation prc-auc = 0.619594
Validation auc = 0.793269
Epoch 16
Loss = 1.3422e-01, PNorm = 49.2442, GNorm = 0.8466, lr_0 = 3.0248e-04
Loss = 1.1122e-01, PNorm = 49.2816, GNorm = 0.6288, lr_0 = 2.9583e-04
Loss = 1.0061e-01, PNorm = 49.3118, GNorm = 0.2444, lr_0 = 2.8933e-04
Loss = 1.0814e-01, PNorm = 49.3468, GNorm = 0.2474, lr_0 = 2.8297e-04
Validation prc-auc = 0.538870
Validation auc = 0.790179
Epoch 17
Loss = 9.9379e-02, PNorm = 49.3736, GNorm = 0.3787, lr_0 = 2.7675e-04
Loss = 1.0184e-01, PNorm = 49.4041, GNorm = 0.3968, lr_0 = 2.7067e-04
Loss = 9.7493e-02, PNorm = 49.4396, GNorm = 0.2088, lr_0 = 2.6472e-04
Loss = 9.6522e-02, PNorm = 49.4737, GNorm = 0.5015, lr_0 = 2.5890e-04
Validation prc-auc = 0.595714
Validation auc = 0.778159
Epoch 18
Loss = 9.3898e-02, PNorm = 49.5056, GNorm = 0.5040, lr_0 = 2.5321e-04
Loss = 9.2960e-02, PNorm = 49.5363, GNorm = 0.6960, lr_0 = 2.4764e-04
Loss = 9.5954e-02, PNorm = 49.5615, GNorm = 0.8414, lr_0 = 2.4220e-04
Loss = 8.1711e-02, PNorm = 49.6000, GNorm = 0.4042, lr_0 = 2.3687e-04
Validation prc-auc = 0.575491
Validation auc = 0.791896
Epoch 19
Loss = 8.6512e-02, PNorm = 49.6248, GNorm = 0.4732, lr_0 = 2.3167e-04
Loss = 7.8989e-02, PNorm = 49.6623, GNorm = 0.7032, lr_0 = 2.2658e-04
Loss = 1.3798e-01, PNorm = 49.6694, GNorm = 0.7303, lr_0 = 2.2159e-04
Validation prc-auc = 0.542362
Validation auc = 0.793613
Epoch 20
Loss = 8.3915e-02, PNorm = 49.7041, GNorm = 0.2385, lr_0 = 2.1672e-04
Loss = 8.2619e-02, PNorm = 49.7368, GNorm = 0.4096, lr_0 = 2.1196e-04
Loss = 7.1750e-02, PNorm = 49.7672, GNorm = 0.2923, lr_0 = 2.0730e-04
Loss = 7.2994e-02, PNorm = 49.7913, GNorm = 0.2424, lr_0 = 2.0274e-04
Validation prc-auc = 0.538451
Validation auc = 0.792582
Epoch 21
Loss = 9.4521e-02, PNorm = 49.8168, GNorm = 0.1983, lr_0 = 1.9829e-04
Loss = 7.3198e-02, PNorm = 49.8375, GNorm = 0.2612, lr_0 = 1.9393e-04
Loss = 8.5663e-02, PNorm = 49.8604, GNorm = 0.3124, lr_0 = 1.8967e-04
Loss = 9.4870e-02, PNorm = 49.8788, GNorm = 0.9302, lr_0 = 1.8550e-04
Validation prc-auc = 0.530298
Validation auc = 0.795330
Epoch 22
Loss = 1.0091e-01, PNorm = 49.9057, GNorm = 0.6764, lr_0 = 1.8142e-04
Loss = 7.9670e-02, PNorm = 49.9315, GNorm = 0.2823, lr_0 = 1.7743e-04
Loss = 7.4807e-02, PNorm = 49.9612, GNorm = 0.4734, lr_0 = 1.7353e-04
Loss = 6.4394e-02, PNorm = 49.9765, GNorm = 0.5587, lr_0 = 1.6972e-04
Validation prc-auc = 0.508814
Validation auc = 0.794299
Epoch 23
Loss = 7.7714e-02, PNorm = 49.9951, GNorm = 0.7928, lr_0 = 1.6599e-04
Loss = 6.8038e-02, PNorm = 50.0135, GNorm = 0.9513, lr_0 = 1.6234e-04
Loss = 7.7955e-02, PNorm = 50.0308, GNorm = 0.5133, lr_0 = 1.5877e-04
Loss = 6.3218e-02, PNorm = 50.0475, GNorm = 0.3638, lr_0 = 1.5528e-04
Validation prc-auc = 0.454590
Validation auc = 0.787431
Epoch 24
Loss = 7.1372e-02, PNorm = 50.0776, GNorm = 1.0626, lr_0 = 1.5187e-04
Loss = 6.4639e-02, PNorm = 50.0924, GNorm = 0.7168, lr_0 = 1.4853e-04
Loss = 6.1347e-02, PNorm = 50.1126, GNorm = 0.7713, lr_0 = 1.4527e-04
Validation prc-auc = 0.480938
Validation auc = 0.793613
Epoch 25
Loss = 5.4559e-02, PNorm = 50.1271, GNorm = 0.5863, lr_0 = 1.4207e-04
Loss = 4.8653e-02, PNorm = 50.1443, GNorm = 0.5100, lr_0 = 1.3895e-04
Loss = 5.4302e-02, PNorm = 50.1629, GNorm = 0.4562, lr_0 = 1.3590e-04
Loss = 6.5395e-02, PNorm = 50.1767, GNorm = 0.2060, lr_0 = 1.3291e-04
Validation prc-auc = 0.516663
Validation auc = 0.790522
Epoch 26
Loss = 6.4548e-02, PNorm = 50.1943, GNorm = 0.4915, lr_0 = 1.2999e-04
Loss = 4.2696e-02, PNorm = 50.2118, GNorm = 0.3272, lr_0 = 1.2713e-04
Loss = 5.7187e-02, PNorm = 50.2225, GNorm = 0.4702, lr_0 = 1.2434e-04
Loss = 6.4917e-02, PNorm = 50.2406, GNorm = 0.6031, lr_0 = 1.2160e-04
Validation prc-auc = 0.455555
Validation auc = 0.791552
Epoch 27
Loss = 6.1788e-02, PNorm = 50.2480, GNorm = 0.8225, lr_0 = 1.1893e-04
Loss = 5.3022e-02, PNorm = 50.2683, GNorm = 0.1016, lr_0 = 1.1632e-04
Loss = 6.6674e-02, PNorm = 50.2809, GNorm = 0.5965, lr_0 = 1.1376e-04
Loss = 5.8130e-02, PNorm = 50.2946, GNorm = 0.2358, lr_0 = 1.1126e-04
Validation prc-auc = 0.483359
Validation auc = 0.787431
Epoch 28
Loss = 3.4831e-02, PNorm = 50.3088, GNorm = 0.4719, lr_0 = 1.0881e-04
Loss = 5.4487e-02, PNorm = 50.3258, GNorm = 0.1712, lr_0 = 1.0642e-04
Loss = 5.5001e-02, PNorm = 50.3325, GNorm = 0.8202, lr_0 = 1.0408e-04
Loss = 5.9370e-02, PNorm = 50.3441, GNorm = 0.3568, lr_0 = 1.0179e-04
Validation prc-auc = 0.471354
Validation auc = 0.790179
Epoch 29
Loss = 5.8813e-02, PNorm = 50.3579, GNorm = 0.5854, lr_0 = 1.0000e-04
Loss = 3.8134e-02, PNorm = 50.3698, GNorm = 0.5909, lr_0 = 1.0000e-04
Loss = 4.6028e-02, PNorm = 50.3844, GNorm = 0.2903, lr_0 = 1.0000e-04
Validation prc-auc = 0.460661
Validation auc = 0.782967
Model 0 best validation prc-auc = 0.656170 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.468104
Model 0 test auc = 0.811718
Ensemble test prc-auc = 0.468104
Ensemble test auc = 0.811718
Fold 26
Splitting data with seed 26
Total scaffolds = 1,115 | train scaffolds = 855 | val scaffolds = 124 | test scaffolds = 136
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.4255e-01, PNorm = 46.0441, GNorm = 0.8820, lr_0 = 2.3378e-04
Loss = 2.9306e-01, PNorm = 46.0605, GNorm = 0.4315, lr_0 = 3.5541e-04
Loss = 2.3541e-01, PNorm = 46.0835, GNorm = 0.2367, lr_0 = 4.7703e-04
Validation prc-auc = 0.400346
Validation auc = 0.846616
Epoch 1
Loss = 1.5111e-01, PNorm = 46.1182, GNorm = 0.6665, lr_0 = 6.1081e-04
Loss = 2.3903e-01, PNorm = 46.1456, GNorm = 0.3038, lr_0 = 7.3243e-04
Loss = 2.1319e-01, PNorm = 46.1828, GNorm = 0.5236, lr_0 = 8.5405e-04
Loss = 2.0685e-01, PNorm = 46.2463, GNorm = 0.5185, lr_0 = 9.7568e-04
Validation prc-auc = 0.577482
Validation auc = 0.856441
Epoch 2
Loss = 1.5182e-01, PNorm = 46.3168, GNorm = 0.5629, lr_0 = 9.8238e-04
Loss = 2.4029e-01, PNorm = 46.3872, GNorm = 0.1539, lr_0 = 9.6078e-04
Loss = 2.0317e-01, PNorm = 46.4740, GNorm = 0.2928, lr_0 = 9.3966e-04
Loss = 2.0361e-01, PNorm = 46.5621, GNorm = 0.5457, lr_0 = 9.1901e-04
Validation prc-auc = 0.538876
Validation auc = 0.831332
Epoch 3
Loss = 2.2460e-01, PNorm = 46.6379, GNorm = 0.3624, lr_0 = 8.9881e-04
Loss = 1.8838e-01, PNorm = 46.7156, GNorm = 0.3195, lr_0 = 8.7905e-04
Loss = 1.6135e-01, PNorm = 46.8221, GNorm = 1.0691, lr_0 = 8.5973e-04
Loss = 1.7951e-01, PNorm = 46.8889, GNorm = 0.2587, lr_0 = 8.4083e-04
Validation prc-auc = 0.560159
Validation auc = 0.897380
Epoch 4
Loss = 1.5756e-01, PNorm = 46.9703, GNorm = 0.4012, lr_0 = 8.2235e-04
Loss = 1.6095e-01, PNorm = 47.0522, GNorm = 0.3657, lr_0 = 8.0428e-04
Loss = 1.6006e-01, PNorm = 47.1387, GNorm = 0.1423, lr_0 = 7.8660e-04
Validation prc-auc = 0.546687
Validation auc = 0.866812
Epoch 5
Loss = 1.2167e-01, PNorm = 47.2148, GNorm = 0.2772, lr_0 = 7.6931e-04
Loss = 1.7095e-01, PNorm = 47.2853, GNorm = 0.2199, lr_0 = 7.5240e-04
Loss = 1.7318e-01, PNorm = 47.3470, GNorm = 0.3383, lr_0 = 7.3586e-04
Loss = 1.6937e-01, PNorm = 47.4216, GNorm = 0.1649, lr_0 = 7.1969e-04
Validation prc-auc = 0.565679
Validation auc = 0.881004
Epoch 6
Loss = 1.7007e-01, PNorm = 47.4964, GNorm = 0.2244, lr_0 = 7.0387e-04
Loss = 1.8207e-01, PNorm = 47.5684, GNorm = 1.3361, lr_0 = 6.8840e-04
Loss = 1.3966e-01, PNorm = 47.6583, GNorm = 0.1485, lr_0 = 6.7326e-04
Loss = 1.4370e-01, PNorm = 47.6913, GNorm = 0.2175, lr_0 = 6.5847e-04
Validation prc-auc = 0.531149
Validation auc = 0.892467
Epoch 7
Loss = 1.4686e-01, PNorm = 47.7481, GNorm = 0.3025, lr_0 = 6.4399e-04
Loss = 1.4251e-01, PNorm = 47.8021, GNorm = 0.3549, lr_0 = 6.2984e-04
Loss = 1.5582e-01, PNorm = 47.8619, GNorm = 0.2460, lr_0 = 6.1599e-04
Loss = 1.4418e-01, PNorm = 47.8960, GNorm = 0.8979, lr_0 = 6.0245e-04
Validation prc-auc = 0.566432
Validation auc = 0.883734
Epoch 8
Loss = 1.6593e-01, PNorm = 47.9492, GNorm = 0.2233, lr_0 = 5.8921e-04
Loss = 1.5524e-01, PNorm = 47.9928, GNorm = 0.3934, lr_0 = 5.7626e-04
Loss = 1.7958e-01, PNorm = 48.0313, GNorm = 0.3179, lr_0 = 5.6359e-04
Loss = 9.5611e-02, PNorm = 48.0763, GNorm = 0.7070, lr_0 = 5.5120e-04
Validation prc-auc = 0.516172
Validation auc = 0.885371
Epoch 9
Loss = 1.3548e-01, PNorm = 48.1058, GNorm = 0.2076, lr_0 = 5.3909e-04
Loss = 1.3562e-01, PNorm = 48.1476, GNorm = 0.5867, lr_0 = 5.2724e-04
Loss = 1.2797e-01, PNorm = 48.1965, GNorm = 0.4385, lr_0 = 5.1565e-04
Validation prc-auc = 0.588347
Validation auc = 0.900655
Epoch 10
Loss = 1.4703e-01, PNorm = 48.2240, GNorm = 0.5137, lr_0 = 5.0432e-04
Loss = 1.3960e-01, PNorm = 48.2763, GNorm = 0.2312, lr_0 = 4.9323e-04
Loss = 9.3836e-02, PNorm = 48.3317, GNorm = 0.2747, lr_0 = 4.8239e-04
Loss = 1.5323e-01, PNorm = 48.3813, GNorm = 0.2219, lr_0 = 4.7179e-04
Validation prc-auc = 0.565900
Validation auc = 0.898472
Epoch 11
Loss = 5.8118e-02, PNorm = 48.4110, GNorm = 0.3282, lr_0 = 4.6142e-04
Loss = 1.4101e-01, PNorm = 48.4494, GNorm = 0.3239, lr_0 = 4.5127e-04
Loss = 1.4233e-01, PNorm = 48.5071, GNorm = 0.5182, lr_0 = 4.4135e-04
Loss = 1.2759e-01, PNorm = 48.5483, GNorm = 0.2586, lr_0 = 4.3165e-04
Validation prc-auc = 0.536997
Validation auc = 0.898472
Epoch 12
Loss = 8.8584e-02, PNorm = 48.5933, GNorm = 1.0277, lr_0 = 4.2217e-04
Loss = 9.6431e-02, PNorm = 48.6240, GNorm = 0.2544, lr_0 = 4.1289e-04
Loss = 1.4969e-01, PNorm = 48.6753, GNorm = 0.5910, lr_0 = 4.0381e-04
Loss = 1.4291e-01, PNorm = 48.7139, GNorm = 0.2949, lr_0 = 3.9493e-04
Validation prc-auc = 0.564027
Validation auc = 0.896288
Epoch 13
Loss = 1.1956e-01, PNorm = 48.7612, GNorm = 0.5625, lr_0 = 3.8625e-04
Loss = 1.1584e-01, PNorm = 48.7994, GNorm = 0.6503, lr_0 = 3.7776e-04
Loss = 1.1359e-01, PNorm = 48.8329, GNorm = 0.3008, lr_0 = 3.6946e-04
Loss = 1.4038e-01, PNorm = 48.8746, GNorm = 0.6344, lr_0 = 3.6134e-04
Validation prc-auc = 0.560940
Validation auc = 0.903384
Epoch 14
Loss = 1.1753e-01, PNorm = 48.9104, GNorm = 0.4189, lr_0 = 3.5340e-04
Loss = 1.5475e-01, PNorm = 48.9550, GNorm = 0.3628, lr_0 = 3.4563e-04
Loss = 8.6347e-02, PNorm = 48.9973, GNorm = 0.4446, lr_0 = 3.3803e-04
Validation prc-auc = 0.552446
Validation auc = 0.890284
Epoch 15
Loss = 8.6286e-02, PNorm = 49.0303, GNorm = 0.3590, lr_0 = 3.3060e-04
Loss = 1.2731e-01, PNorm = 49.0687, GNorm = 0.2034, lr_0 = 3.2333e-04
Loss = 9.9090e-02, PNorm = 49.0980, GNorm = 0.4477, lr_0 = 3.1623e-04
Loss = 1.0953e-01, PNorm = 49.1187, GNorm = 0.4219, lr_0 = 3.0928e-04
Validation prc-auc = 0.539977
Validation auc = 0.888100
Epoch 16
Loss = 1.2093e-01, PNorm = 49.1488, GNorm = 0.7177, lr_0 = 3.0248e-04
Loss = 1.0368e-01, PNorm = 49.1822, GNorm = 0.4991, lr_0 = 2.9583e-04
Loss = 7.5388e-02, PNorm = 49.2184, GNorm = 0.4140, lr_0 = 2.8933e-04
Loss = 1.3826e-01, PNorm = 49.2405, GNorm = 0.5294, lr_0 = 2.8297e-04
Validation prc-auc = 0.482942
Validation auc = 0.875000
Epoch 17
Loss = 1.2836e-01, PNorm = 49.2696, GNorm = 0.3387, lr_0 = 2.7675e-04
Loss = 1.2078e-01, PNorm = 49.3036, GNorm = 0.6862, lr_0 = 2.7067e-04
Loss = 1.0682e-01, PNorm = 49.3305, GNorm = 0.2836, lr_0 = 2.6472e-04
Loss = 7.6138e-02, PNorm = 49.3567, GNorm = 0.4713, lr_0 = 2.5890e-04
Validation prc-auc = 0.483690
Validation auc = 0.903384
Epoch 18
Loss = 7.6686e-02, PNorm = 49.3910, GNorm = 0.3805, lr_0 = 2.5321e-04
Loss = 1.0874e-01, PNorm = 49.4195, GNorm = 0.5180, lr_0 = 2.4764e-04
Loss = 8.9373e-02, PNorm = 49.4526, GNorm = 0.2306, lr_0 = 2.4220e-04
Loss = 1.0184e-01, PNorm = 49.4778, GNorm = 0.5437, lr_0 = 2.3687e-04
Validation prc-auc = 0.550021
Validation auc = 0.898472
Epoch 19
Loss = 9.0589e-02, PNorm = 49.5009, GNorm = 0.3472, lr_0 = 2.3167e-04
Loss = 8.5169e-02, PNorm = 49.5283, GNorm = 0.2549, lr_0 = 2.2658e-04
Loss = 8.4113e-02, PNorm = 49.5525, GNorm = 0.2666, lr_0 = 2.2159e-04
Validation prc-auc = 0.372644
Validation auc = 0.884279
Epoch 20
Loss = 4.8145e-02, PNorm = 49.5765, GNorm = 0.3360, lr_0 = 2.1672e-04
Loss = 7.8788e-02, PNorm = 49.6076, GNorm = 1.1195, lr_0 = 2.1196e-04
Loss = 1.0556e-01, PNorm = 49.6360, GNorm = 0.9547, lr_0 = 2.0730e-04
Loss = 1.0010e-01, PNorm = 49.6684, GNorm = 0.3322, lr_0 = 2.0274e-04
Validation prc-auc = 0.313866
Validation auc = 0.879367
Epoch 21
Loss = 5.1024e-02, PNorm = 49.6864, GNorm = 0.2619, lr_0 = 1.9829e-04
Loss = 9.1857e-02, PNorm = 49.7184, GNorm = 0.4967, lr_0 = 1.9393e-04
Loss = 8.9799e-02, PNorm = 49.7387, GNorm = 0.2972, lr_0 = 1.8967e-04
Loss = 7.1759e-02, PNorm = 49.7661, GNorm = 0.4314, lr_0 = 1.8550e-04
Validation prc-auc = 0.242606
Validation auc = 0.836245
Epoch 22
Loss = 8.1634e-02, PNorm = 49.7807, GNorm = 0.2920, lr_0 = 1.8142e-04
Loss = 7.7138e-02, PNorm = 49.8096, GNorm = 0.2761, lr_0 = 1.7743e-04
Loss = 7.5784e-02, PNorm = 49.8268, GNorm = 0.4651, lr_0 = 1.7353e-04
Loss = 1.0152e-01, PNorm = 49.8441, GNorm = 0.4530, lr_0 = 1.6972e-04
Validation prc-auc = 0.370042
Validation auc = 0.876638
Epoch 23
Loss = 4.9031e-02, PNorm = 49.8620, GNorm = 0.5111, lr_0 = 1.6599e-04
Loss = 8.4184e-02, PNorm = 49.8831, GNorm = 0.4162, lr_0 = 1.6234e-04
Loss = 1.0620e-01, PNorm = 49.9024, GNorm = 0.9910, lr_0 = 1.5877e-04
Loss = 7.8236e-02, PNorm = 49.9299, GNorm = 0.5092, lr_0 = 1.5528e-04
Validation prc-auc = 0.353893
Validation auc = 0.883188
Epoch 24
Loss = 5.9728e-02, PNorm = 49.9494, GNorm = 0.2509, lr_0 = 1.5187e-04
Loss = 5.8441e-02, PNorm = 49.9679, GNorm = 1.0345, lr_0 = 1.4853e-04
Loss = 9.5849e-02, PNorm = 49.9819, GNorm = 0.4385, lr_0 = 1.4527e-04
Validation prc-auc = 0.267053
Validation auc = 0.861354
Epoch 25
Loss = 6.9314e-02, PNorm = 50.0004, GNorm = 0.9192, lr_0 = 1.4207e-04
Loss = 5.8308e-02, PNorm = 50.0191, GNorm = 0.5281, lr_0 = 1.3895e-04
Loss = 7.5837e-02, PNorm = 50.0363, GNorm = 0.4661, lr_0 = 1.3590e-04
Loss = 7.5145e-02, PNorm = 50.0565, GNorm = 0.8000, lr_0 = 1.3291e-04
Validation prc-auc = 0.225573
Validation auc = 0.878821
Epoch 26
Loss = 5.9658e-02, PNorm = 50.0682, GNorm = 0.4069, lr_0 = 1.2999e-04
Loss = 6.4189e-02, PNorm = 50.0826, GNorm = 0.3616, lr_0 = 1.2713e-04
Loss = 5.1509e-02, PNorm = 50.0999, GNorm = 0.2542, lr_0 = 1.2434e-04
Loss = 5.2956e-02, PNorm = 50.1118, GNorm = 0.5163, lr_0 = 1.2160e-04
Validation prc-auc = 0.264735
Validation auc = 0.853712
Epoch 27
Loss = 6.4543e-02, PNorm = 50.1290, GNorm = 1.6960, lr_0 = 1.1893e-04
Loss = 7.4848e-02, PNorm = 50.1415, GNorm = 0.5826, lr_0 = 1.1632e-04
Loss = 5.2155e-02, PNorm = 50.1576, GNorm = 0.3746, lr_0 = 1.1376e-04
Loss = 5.8834e-02, PNorm = 50.1693, GNorm = 1.0557, lr_0 = 1.1126e-04
Validation prc-auc = 0.352654
Validation auc = 0.885371
Epoch 28
Loss = 4.2309e-02, PNorm = 50.1870, GNorm = 0.0980, lr_0 = 1.0881e-04
Loss = 6.5479e-02, PNorm = 50.1939, GNorm = 0.3478, lr_0 = 1.0642e-04
Loss = 6.6595e-02, PNorm = 50.2091, GNorm = 1.0044, lr_0 = 1.0408e-04
Loss = 5.6530e-02, PNorm = 50.2226, GNorm = 0.2118, lr_0 = 1.0179e-04
Validation prc-auc = 0.224143
Validation auc = 0.877729
Epoch 29
Loss = 4.8874e-02, PNorm = 50.2356, GNorm = 0.9111, lr_0 = 1.0000e-04
Loss = 6.1413e-02, PNorm = 50.2453, GNorm = 0.7262, lr_0 = 1.0000e-04
Loss = 4.5423e-02, PNorm = 50.2603, GNorm = 0.7288, lr_0 = 1.0000e-04
Validation prc-auc = 0.332845
Validation auc = 0.867904
Model 0 best validation prc-auc = 0.588347 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.505191
Model 0 test auc = 0.715213
Ensemble test prc-auc = 0.505191
Ensemble test auc = 0.715213
Fold 27
Splitting data with seed 27
Total scaffolds = 1,115 | train scaffolds = 862 | val scaffolds = 130 | test scaffolds = 123
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.5074e-01, PNorm = 46.0437, GNorm = 0.3263, lr_0 = 2.3378e-04
Loss = 2.5139e-01, PNorm = 46.0610, GNorm = 0.3001, lr_0 = 3.5541e-04
Loss = 1.9282e-01, PNorm = 46.0851, GNorm = 0.6527, lr_0 = 4.7703e-04
Validation prc-auc = 0.083058
Validation auc = 0.658150
Epoch 1
Loss = 2.3140e-01, PNorm = 46.1165, GNorm = 0.4041, lr_0 = 6.1081e-04
Loss = 2.0945e-01, PNorm = 46.1531, GNorm = 0.2785, lr_0 = 7.3243e-04
Loss = 2.5644e-01, PNorm = 46.1847, GNorm = 0.4887, lr_0 = 8.5405e-04
Loss = 2.0459e-01, PNorm = 46.2564, GNorm = 0.3560, lr_0 = 9.7568e-04
Validation prc-auc = 0.192807
Validation auc = 0.747137
Epoch 2
Loss = 1.6705e-01, PNorm = 46.3378, GNorm = 0.2397, lr_0 = 9.8238e-04
Loss = 1.7756e-01, PNorm = 46.4193, GNorm = 0.2466, lr_0 = 9.6078e-04
Loss = 2.3671e-01, PNorm = 46.4822, GNorm = 0.2731, lr_0 = 9.3966e-04
Loss = 2.0722e-01, PNorm = 46.5446, GNorm = 0.3843, lr_0 = 9.1901e-04
Validation prc-auc = 0.172136
Validation auc = 0.687665
Epoch 3
Loss = 1.8885e-01, PNorm = 46.6316, GNorm = 0.5269, lr_0 = 8.9881e-04
Loss = 1.8686e-01, PNorm = 46.7149, GNorm = 0.3154, lr_0 = 8.7905e-04
Loss = 1.9588e-01, PNorm = 46.7875, GNorm = 0.4209, lr_0 = 8.5973e-04
Loss = 1.9253e-01, PNorm = 46.8450, GNorm = 0.6772, lr_0 = 8.4083e-04
Validation prc-auc = 0.210424
Validation auc = 0.748458
Epoch 4
Loss = 1.4943e-01, PNorm = 46.9567, GNorm = 0.1562, lr_0 = 8.2235e-04
Loss = 1.5772e-01, PNorm = 47.0096, GNorm = 0.3909, lr_0 = 8.0428e-04
Loss = 2.0893e-01, PNorm = 47.1020, GNorm = 0.2151, lr_0 = 7.8660e-04
Validation prc-auc = 0.219575
Validation auc = 0.741410
Epoch 5
Loss = 1.3256e-01, PNorm = 47.1832, GNorm = 0.7179, lr_0 = 7.6931e-04
Loss = 1.5603e-01, PNorm = 47.2661, GNorm = 0.4618, lr_0 = 7.5240e-04
Loss = 1.8927e-01, PNorm = 47.3120, GNorm = 0.3787, lr_0 = 7.3586e-04
Loss = 1.8666e-01, PNorm = 47.3844, GNorm = 0.2565, lr_0 = 7.1969e-04
Validation prc-auc = 0.278473
Validation auc = 0.766960
Epoch 6
Loss = 9.7509e-02, PNorm = 47.4726, GNorm = 0.6455, lr_0 = 7.0387e-04
Loss = 2.0263e-01, PNorm = 47.5412, GNorm = 0.7666, lr_0 = 6.8840e-04
Loss = 1.7056e-01, PNorm = 47.5968, GNorm = 0.3153, lr_0 = 6.7326e-04
Loss = 1.5656e-01, PNorm = 47.6720, GNorm = 1.1600, lr_0 = 6.5847e-04
Validation prc-auc = 0.289446
Validation auc = 0.751542
Epoch 7
Loss = 1.1497e-01, PNorm = 47.7250, GNorm = 0.2430, lr_0 = 6.4399e-04
Loss = 1.2725e-01, PNorm = 47.8007, GNorm = 0.4721, lr_0 = 6.2984e-04
Loss = 1.0963e-01, PNorm = 47.8819, GNorm = 0.5422, lr_0 = 6.1599e-04
Loss = 2.5440e-01, PNorm = 47.9175, GNorm = 0.6250, lr_0 = 6.0245e-04
Validation prc-auc = 0.342835
Validation auc = 0.726872
Epoch 8
Loss = 1.4965e-01, PNorm = 48.0044, GNorm = 0.3402, lr_0 = 5.8921e-04
Loss = 1.6048e-01, PNorm = 48.0737, GNorm = 0.6588, lr_0 = 5.7626e-04
Loss = 1.2243e-01, PNorm = 48.1443, GNorm = 0.5923, lr_0 = 5.6359e-04
Loss = 1.6924e-01, PNorm = 48.1827, GNorm = 0.3112, lr_0 = 5.5120e-04
Validation prc-auc = 0.316133
Validation auc = 0.757269
Epoch 9
Loss = 1.6491e-01, PNorm = 48.2292, GNorm = 0.4711, lr_0 = 5.3909e-04
Loss = 1.4187e-01, PNorm = 48.2813, GNorm = 0.4343, lr_0 = 5.2724e-04
Loss = 1.6213e-01, PNorm = 48.3399, GNorm = 0.6734, lr_0 = 5.1565e-04
Validation prc-auc = 0.231819
Validation auc = 0.728194
Epoch 10
Loss = 8.1170e-02, PNorm = 48.4077, GNorm = 0.3055, lr_0 = 5.0432e-04
Loss = 1.3751e-01, PNorm = 48.4498, GNorm = 0.1528, lr_0 = 4.9323e-04
Loss = 1.2898e-01, PNorm = 48.5082, GNorm = 0.1914, lr_0 = 4.8239e-04
Loss = 1.9442e-01, PNorm = 48.5555, GNorm = 0.3487, lr_0 = 4.7179e-04
Validation prc-auc = 0.412341
Validation auc = 0.731718
Epoch 11
Loss = 1.7026e-01, PNorm = 48.5911, GNorm = 0.2316, lr_0 = 4.6142e-04
Loss = 1.1457e-01, PNorm = 48.6499, GNorm = 0.2316, lr_0 = 4.5127e-04
Loss = 1.5964e-01, PNorm = 48.6948, GNorm = 0.3895, lr_0 = 4.4135e-04
Loss = 1.2479e-01, PNorm = 48.7509, GNorm = 0.6127, lr_0 = 4.3165e-04
Validation prc-auc = 0.375379
Validation auc = 0.736564
Epoch 12
Loss = 1.3509e-01, PNorm = 48.7916, GNorm = 0.3654, lr_0 = 4.2217e-04
Loss = 1.3634e-01, PNorm = 48.8482, GNorm = 0.2000, lr_0 = 4.1289e-04
Loss = 1.1671e-01, PNorm = 48.9140, GNorm = 0.5065, lr_0 = 4.0381e-04
Loss = 1.1615e-01, PNorm = 48.9532, GNorm = 0.2894, lr_0 = 3.9493e-04
Validation prc-auc = 0.232388
Validation auc = 0.709692
Epoch 13
Loss = 6.9482e-02, PNorm = 49.0023, GNorm = 0.2416, lr_0 = 3.8625e-04
Loss = 1.7043e-01, PNorm = 49.0461, GNorm = 0.4887, lr_0 = 3.7776e-04
Loss = 1.2792e-01, PNorm = 49.0828, GNorm = 0.4462, lr_0 = 3.6946e-04
Loss = 1.0611e-01, PNorm = 49.1423, GNorm = 0.9182, lr_0 = 3.6134e-04
Validation prc-auc = 0.288749
Validation auc = 0.724670
Epoch 14
Loss = 1.1583e-01, PNorm = 49.1942, GNorm = 0.2740, lr_0 = 3.5340e-04
Loss = 1.1554e-01, PNorm = 49.2453, GNorm = 1.0764, lr_0 = 3.4563e-04
Loss = 1.1617e-01, PNorm = 49.2863, GNorm = 0.6058, lr_0 = 3.3803e-04
Validation prc-auc = 0.274108
Validation auc = 0.713656
Epoch 15
Loss = 1.2402e-01, PNorm = 49.3216, GNorm = 0.3896, lr_0 = 3.3060e-04
Loss = 1.2191e-01, PNorm = 49.3897, GNorm = 0.7789, lr_0 = 3.2333e-04
Loss = 1.3995e-01, PNorm = 49.4285, GNorm = 0.7063, lr_0 = 3.1623e-04
Loss = 8.6650e-02, PNorm = 49.4649, GNorm = 0.6922, lr_0 = 3.0928e-04
Validation prc-auc = 0.385843
Validation auc = 0.730396
Epoch 16
Loss = 1.2036e-01, PNorm = 49.5030, GNorm = 1.0007, lr_0 = 3.0248e-04
Loss = 1.0845e-01, PNorm = 49.5379, GNorm = 0.5046, lr_0 = 2.9583e-04
Loss = 1.0929e-01, PNorm = 49.5941, GNorm = 0.3219, lr_0 = 2.8933e-04
Loss = 1.2632e-01, PNorm = 49.6192, GNorm = 0.4663, lr_0 = 2.8297e-04
Validation prc-auc = 0.302390
Validation auc = 0.729075
Epoch 17
Loss = 1.0444e-01, PNorm = 49.6753, GNorm = 0.2851, lr_0 = 2.7675e-04
Loss = 9.6424e-02, PNorm = 49.7115, GNorm = 0.4336, lr_0 = 2.7067e-04
Loss = 9.2857e-02, PNorm = 49.7425, GNorm = 0.2874, lr_0 = 2.6472e-04
Loss = 1.0220e-01, PNorm = 49.7731, GNorm = 0.5645, lr_0 = 2.5890e-04
Validation prc-auc = 0.254899
Validation auc = 0.735242
Epoch 18
Loss = 9.6452e-02, PNorm = 49.8132, GNorm = 1.2669, lr_0 = 2.5321e-04
Loss = 7.4995e-02, PNorm = 49.8305, GNorm = 5.4553, lr_0 = 2.4764e-04
Loss = 1.4757e-01, PNorm = 49.8678, GNorm = 0.8064, lr_0 = 2.4220e-04
Loss = 9.9839e-02, PNorm = 49.9058, GNorm = 0.2770, lr_0 = 2.3687e-04
Validation prc-auc = 0.438763
Validation auc = 0.705286
Epoch 19
Loss = 1.0453e-01, PNorm = 49.9380, GNorm = 0.3350, lr_0 = 2.3167e-04
Loss = 1.0798e-01, PNorm = 49.9698, GNorm = 0.4208, lr_0 = 2.2658e-04
Loss = 8.1076e-02, PNorm = 49.9986, GNorm = 0.4934, lr_0 = 2.2159e-04
Validation prc-auc = 0.274409
Validation auc = 0.722907
Epoch 20
Loss = 9.8646e-02, PNorm = 50.0216, GNorm = 0.4658, lr_0 = 2.1672e-04
Loss = 9.5002e-02, PNorm = 50.0551, GNorm = 1.0862, lr_0 = 2.1196e-04
Loss = 1.0382e-01, PNorm = 50.0796, GNorm = 0.8569, lr_0 = 2.0730e-04
Loss = 5.7813e-02, PNorm = 50.1107, GNorm = 0.9728, lr_0 = 2.0274e-04
Validation prc-auc = 0.479700
Validation auc = 0.739207
Epoch 21
Loss = 1.1930e-01, PNorm = 50.1271, GNorm = 0.4978, lr_0 = 1.9829e-04
Loss = 9.0099e-02, PNorm = 50.1591, GNorm = 0.6422, lr_0 = 1.9393e-04
Loss = 9.3405e-02, PNorm = 50.1800, GNorm = 1.0806, lr_0 = 1.8967e-04
Loss = 7.3079e-02, PNorm = 50.2096, GNorm = 0.6701, lr_0 = 1.8550e-04
Validation prc-auc = 0.257553
Validation auc = 0.714097
Epoch 22
Loss = 7.2762e-02, PNorm = 50.2325, GNorm = 0.7005, lr_0 = 1.8142e-04
Loss = 8.4317e-02, PNorm = 50.2463, GNorm = 0.4506, lr_0 = 1.7743e-04
Loss = 6.6454e-02, PNorm = 50.2797, GNorm = 0.9280, lr_0 = 1.7353e-04
Loss = 6.9249e-02, PNorm = 50.2922, GNorm = 0.3526, lr_0 = 1.6972e-04
Validation prc-auc = 0.210986
Validation auc = 0.718502
Epoch 23
Loss = 5.3435e-02, PNorm = 50.3111, GNorm = 0.6298, lr_0 = 1.6599e-04
Loss = 4.7311e-02, PNorm = 50.3288, GNorm = 0.3778, lr_0 = 1.6234e-04
Loss = 7.4727e-02, PNorm = 50.3438, GNorm = 1.1177, lr_0 = 1.5877e-04
Loss = 8.3769e-02, PNorm = 50.3661, GNorm = 0.8555, lr_0 = 1.5528e-04
Validation prc-auc = 0.255325
Validation auc = 0.714978
Epoch 24
Loss = 6.8504e-02, PNorm = 50.3841, GNorm = 0.5785, lr_0 = 1.5187e-04
Loss = 4.5629e-02, PNorm = 50.4071, GNorm = 0.2906, lr_0 = 1.4853e-04
Loss = 5.7876e-02, PNorm = 50.4222, GNorm = 0.7152, lr_0 = 1.4527e-04
Validation prc-auc = 0.250343
Validation auc = 0.721145
Epoch 25
Loss = 4.7845e-02, PNorm = 50.4332, GNorm = 0.4046, lr_0 = 1.4207e-04
Loss = 7.8915e-02, PNorm = 50.4556, GNorm = 0.7948, lr_0 = 1.3895e-04
Loss = 5.1028e-02, PNorm = 50.4741, GNorm = 0.7591, lr_0 = 1.3590e-04
Loss = 4.0963e-02, PNorm = 50.4896, GNorm = 0.2274, lr_0 = 1.3291e-04
Validation prc-auc = 0.252964
Validation auc = 0.714978
Epoch 26
Loss = 7.7494e-02, PNorm = 50.5033, GNorm = 0.5662, lr_0 = 1.2999e-04
Loss = 6.0419e-02, PNorm = 50.5177, GNorm = 0.9229, lr_0 = 1.2713e-04
Loss = 4.0698e-02, PNorm = 50.5311, GNorm = 0.4187, lr_0 = 1.2434e-04
Loss = 4.6485e-02, PNorm = 50.5450, GNorm = 0.6219, lr_0 = 1.2160e-04
Validation prc-auc = 0.246111
Validation auc = 0.730396
Epoch 27
Loss = 2.8398e-02, PNorm = 50.5642, GNorm = 0.1049, lr_0 = 1.1893e-04
Loss = 7.1170e-02, PNorm = 50.5743, GNorm = 0.5423, lr_0 = 1.1632e-04
Loss = 6.4467e-02, PNorm = 50.5908, GNorm = 0.3220, lr_0 = 1.1376e-04
Loss = 4.0368e-02, PNorm = 50.6058, GNorm = 0.2022, lr_0 = 1.1126e-04
Validation prc-auc = 0.214501
Validation auc = 0.717181
Epoch 28
Loss = 4.6871e-02, PNorm = 50.6140, GNorm = 0.3675, lr_0 = 1.0881e-04
Loss = 5.2779e-02, PNorm = 50.6284, GNorm = 0.6236, lr_0 = 1.0642e-04
Loss = 5.4164e-02, PNorm = 50.6416, GNorm = 0.1139, lr_0 = 1.0408e-04
Loss = 3.1270e-02, PNorm = 50.6516, GNorm = 0.3955, lr_0 = 1.0179e-04
Validation prc-auc = 0.251507
Validation auc = 0.724229
Epoch 29
Loss = 4.9405e-02, PNorm = 50.6627, GNorm = 0.4709, lr_0 = 1.0000e-04
Loss = 3.1725e-02, PNorm = 50.6787, GNorm = 0.0992, lr_0 = 1.0000e-04
Loss = 3.9305e-02, PNorm = 50.6840, GNorm = 0.9082, lr_0 = 1.0000e-04
Validation prc-auc = 0.194955
Validation auc = 0.716740
Model 0 best validation prc-auc = 0.479700 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.442634
Model 0 test auc = 0.796581
Ensemble test prc-auc = 0.442634
Ensemble test auc = 0.796581
Fold 28
Splitting data with seed 28
Total scaffolds = 1,115 | train scaffolds = 839 | val scaffolds = 114 | test scaffolds = 162
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.4224e-01, PNorm = 46.0443, GNorm = 1.4039, lr_0 = 2.3378e-04
Loss = 2.5028e-01, PNorm = 46.0579, GNorm = 0.4724, lr_0 = 3.5541e-04
Loss = 1.7409e-01, PNorm = 46.0808, GNorm = 0.2960, lr_0 = 4.7703e-04
Validation prc-auc = 0.242734
Validation auc = 0.800802
Epoch 1
Loss = 2.6578e-01, PNorm = 46.1091, GNorm = 0.5559, lr_0 = 6.1081e-04
Loss = 1.7239e-01, PNorm = 46.1490, GNorm = 1.1488, lr_0 = 7.3243e-04
Loss = 2.1488e-01, PNorm = 46.1783, GNorm = 0.2670, lr_0 = 8.5405e-04
Loss = 2.0775e-01, PNorm = 46.2250, GNorm = 0.3291, lr_0 = 9.7568e-04
Validation prc-auc = 0.334638
Validation auc = 0.825134
Epoch 2
Loss = 2.0940e-01, PNorm = 46.2770, GNorm = 0.2062, lr_0 = 9.8238e-04
Loss = 1.9617e-01, PNorm = 46.3309, GNorm = 0.6087, lr_0 = 9.6078e-04
Loss = 1.9947e-01, PNorm = 46.3865, GNorm = 0.6297, lr_0 = 9.3966e-04
Loss = 1.8056e-01, PNorm = 46.4736, GNorm = 0.2753, lr_0 = 9.1901e-04
Validation prc-auc = 0.388063
Validation auc = 0.867112
Epoch 3
Loss = 1.9074e-01, PNorm = 46.5351, GNorm = 0.3786, lr_0 = 8.9881e-04
Loss = 1.7915e-01, PNorm = 46.6221, GNorm = 0.3052, lr_0 = 8.7905e-04
Loss = 1.5466e-01, PNorm = 46.6960, GNorm = 0.4571, lr_0 = 8.5973e-04
Loss = 2.0191e-01, PNorm = 46.7511, GNorm = 0.4186, lr_0 = 8.4083e-04
Validation prc-auc = 0.369213
Validation auc = 0.867647
Epoch 4
Loss = 1.6683e-01, PNorm = 46.8677, GNorm = 0.2700, lr_0 = 8.2235e-04
Loss = 1.7980e-01, PNorm = 46.9560, GNorm = 0.1522, lr_0 = 8.0428e-04
Loss = 1.7120e-01, PNorm = 47.0237, GNorm = 0.3806, lr_0 = 7.8660e-04
Validation prc-auc = 0.407324
Validation auc = 0.877005
Epoch 5
Loss = 5.5954e-02, PNorm = 47.0986, GNorm = 0.3855, lr_0 = 7.6931e-04
Loss = 1.8567e-01, PNorm = 47.1722, GNorm = 0.5753, lr_0 = 7.5240e-04
Loss = 1.8932e-01, PNorm = 47.2265, GNorm = 0.7587, lr_0 = 7.3586e-04
Loss = 1.5185e-01, PNorm = 47.3105, GNorm = 0.1984, lr_0 = 7.1969e-04
Validation prc-auc = 0.452306
Validation auc = 0.889037
Epoch 6
Loss = 2.6568e-01, PNorm = 47.3774, GNorm = 0.3984, lr_0 = 7.0387e-04
Loss = 1.2539e-01, PNorm = 47.4428, GNorm = 0.3643, lr_0 = 6.8840e-04
Loss = 1.9100e-01, PNorm = 47.5015, GNorm = 0.3919, lr_0 = 6.7326e-04
Loss = 1.4273e-01, PNorm = 47.5883, GNorm = 0.3982, lr_0 = 6.5847e-04
Validation prc-auc = 0.390696
Validation auc = 0.881283
Epoch 7
Loss = 1.3733e-01, PNorm = 47.6628, GNorm = 0.8274, lr_0 = 6.4399e-04
Loss = 1.4272e-01, PNorm = 47.7472, GNorm = 0.4256, lr_0 = 6.2984e-04
Loss = 1.5886e-01, PNorm = 47.8070, GNorm = 0.4146, lr_0 = 6.1599e-04
Loss = 1.6534e-01, PNorm = 47.8621, GNorm = 0.2689, lr_0 = 6.0245e-04
Validation prc-auc = 0.434809
Validation auc = 0.901070
Epoch 8
Loss = 1.9233e-01, PNorm = 47.9129, GNorm = 0.6000, lr_0 = 5.8921e-04
Loss = 1.3996e-01, PNorm = 47.9812, GNorm = 0.4299, lr_0 = 5.7626e-04
Loss = 1.2994e-01, PNorm = 48.0294, GNorm = 0.6467, lr_0 = 5.6359e-04
Loss = 1.3846e-01, PNorm = 48.0645, GNorm = 0.2099, lr_0 = 5.5120e-04
Validation prc-auc = 0.448635
Validation auc = 0.892513
Epoch 9
Loss = 1.4823e-01, PNorm = 48.1069, GNorm = 0.2901, lr_0 = 5.3909e-04
Loss = 1.4634e-01, PNorm = 48.1547, GNorm = 0.2887, lr_0 = 5.2724e-04
Loss = 1.2791e-01, PNorm = 48.1974, GNorm = 0.8322, lr_0 = 5.1565e-04
Validation prc-auc = 0.461030
Validation auc = 0.879144
Epoch 10
Loss = 1.0489e-01, PNorm = 48.2411, GNorm = 0.3725, lr_0 = 5.0432e-04
Loss = 1.3997e-01, PNorm = 48.2929, GNorm = 0.4186, lr_0 = 4.9323e-04
Loss = 1.4591e-01, PNorm = 48.3427, GNorm = 0.4195, lr_0 = 4.8239e-04
Loss = 1.2444e-01, PNorm = 48.3867, GNorm = 0.3097, lr_0 = 4.7179e-04
Validation prc-auc = 0.481675
Validation auc = 0.903209
Epoch 11
Loss = 1.2321e-01, PNorm = 48.4359, GNorm = 0.2602, lr_0 = 4.6142e-04
Loss = 1.3519e-01, PNorm = 48.5164, GNorm = 0.4030, lr_0 = 4.5127e-04
Loss = 1.4203e-01, PNorm = 48.5765, GNorm = 0.7966, lr_0 = 4.4135e-04
Loss = 1.2215e-01, PNorm = 48.6067, GNorm = 0.4841, lr_0 = 4.3165e-04
Validation prc-auc = 0.491454
Validation auc = 0.902941
Epoch 12
Loss = 1.3366e-01, PNorm = 48.6492, GNorm = 0.9786, lr_0 = 4.2217e-04
Loss = 1.5235e-01, PNorm = 48.7058, GNorm = 0.2019, lr_0 = 4.1289e-04
Loss = 9.3500e-02, PNorm = 48.7627, GNorm = 0.8518, lr_0 = 4.0381e-04
Loss = 1.3896e-01, PNorm = 48.8013, GNorm = 0.1420, lr_0 = 3.9493e-04
Validation prc-auc = 0.490357
Validation auc = 0.890107
Epoch 13
Loss = 1.3529e-01, PNorm = 48.8340, GNorm = 0.3570, lr_0 = 3.8625e-04
Loss = 1.0166e-01, PNorm = 48.8923, GNorm = 0.2168, lr_0 = 3.7776e-04
Loss = 1.5148e-01, PNorm = 48.9351, GNorm = 0.9918, lr_0 = 3.6946e-04
Loss = 1.1043e-01, PNorm = 48.9815, GNorm = 1.0234, lr_0 = 3.6134e-04
Validation prc-auc = 0.516004
Validation auc = 0.911230
Epoch 14
Loss = 1.1729e-01, PNorm = 49.0156, GNorm = 0.1988, lr_0 = 3.5340e-04
Loss = 1.2302e-01, PNorm = 49.0723, GNorm = 0.3826, lr_0 = 3.4563e-04
Loss = 1.2277e-01, PNorm = 49.0934, GNorm = 0.3597, lr_0 = 3.3803e-04
Validation prc-auc = 0.499436
Validation auc = 0.882353
Epoch 15
Loss = 2.2832e-01, PNorm = 49.1418, GNorm = 0.6670, lr_0 = 3.3060e-04
Loss = 1.0819e-01, PNorm = 49.1819, GNorm = 0.3473, lr_0 = 3.2333e-04
Loss = 1.1885e-01, PNorm = 49.2289, GNorm = 0.2776, lr_0 = 3.1623e-04
Loss = 9.7024e-02, PNorm = 49.2687, GNorm = 0.8981, lr_0 = 3.0928e-04
Validation prc-auc = 0.548906
Validation auc = 0.883155
Epoch 16
Loss = 3.3466e-02, PNorm = 49.3071, GNorm = 0.2817, lr_0 = 3.0248e-04
Loss = 9.1204e-02, PNorm = 49.3302, GNorm = 0.5002, lr_0 = 2.9583e-04
Loss = 1.1459e-01, PNorm = 49.3575, GNorm = 0.3846, lr_0 = 2.8933e-04
Loss = 1.2229e-01, PNorm = 49.3983, GNorm = 0.4569, lr_0 = 2.8297e-04
Validation prc-auc = 0.569505
Validation auc = 0.895722
Epoch 17
Loss = 8.8240e-02, PNorm = 49.4276, GNorm = 0.3782, lr_0 = 2.7675e-04
Loss = 1.0062e-01, PNorm = 49.4678, GNorm = 0.4237, lr_0 = 2.7067e-04
Loss = 1.0989e-01, PNorm = 49.5046, GNorm = 0.4851, lr_0 = 2.6472e-04
Loss = 1.2665e-01, PNorm = 49.5306, GNorm = 0.3630, lr_0 = 2.5890e-04
Validation prc-auc = 0.520527
Validation auc = 0.891979
Epoch 18
Loss = 1.3436e-01, PNorm = 49.5652, GNorm = 0.3670, lr_0 = 2.5321e-04
Loss = 8.1926e-02, PNorm = 49.5992, GNorm = 0.4161, lr_0 = 2.4764e-04
Loss = 9.6747e-02, PNorm = 49.6277, GNorm = 0.3168, lr_0 = 2.4220e-04
Loss = 1.1038e-01, PNorm = 49.6662, GNorm = 0.4266, lr_0 = 2.3687e-04
Validation prc-auc = 0.553772
Validation auc = 0.874866
Epoch 19
Loss = 7.6756e-02, PNorm = 49.6938, GNorm = 0.3272, lr_0 = 2.3167e-04
Loss = 1.1424e-01, PNorm = 49.7209, GNorm = 0.6996, lr_0 = 2.2658e-04
Loss = 5.9854e-02, PNorm = 49.7497, GNorm = 0.5888, lr_0 = 2.2159e-04
Validation prc-auc = 0.514775
Validation auc = 0.857487
Epoch 20
Loss = 1.4279e-01, PNorm = 49.7687, GNorm = 0.5120, lr_0 = 2.1672e-04
Loss = 6.8459e-02, PNorm = 49.8026, GNorm = 0.6367, lr_0 = 2.1196e-04
Loss = 9.3916e-02, PNorm = 49.8285, GNorm = 0.6042, lr_0 = 2.0730e-04
Loss = 9.3293e-02, PNorm = 49.8758, GNorm = 0.8164, lr_0 = 2.0274e-04
Validation prc-auc = 0.630173
Validation auc = 0.890909
Epoch 21
Loss = 9.4977e-02, PNorm = 49.8795, GNorm = 0.4824, lr_0 = 1.9829e-04
Loss = 9.1608e-02, PNorm = 49.9102, GNorm = 0.3951, lr_0 = 1.9393e-04
Loss = 7.7740e-02, PNorm = 49.9375, GNorm = 0.4175, lr_0 = 1.8967e-04
Loss = 6.8147e-02, PNorm = 49.9640, GNorm = 0.3368, lr_0 = 1.8550e-04
Validation prc-auc = 0.510957
Validation auc = 0.856684
Epoch 22
Loss = 6.6582e-02, PNorm = 49.9796, GNorm = 0.2091, lr_0 = 1.8142e-04
Loss = 6.3939e-02, PNorm = 50.0032, GNorm = 0.4645, lr_0 = 1.7743e-04
Loss = 8.6052e-02, PNorm = 50.0198, GNorm = 0.7479, lr_0 = 1.7353e-04
Loss = 9.9171e-02, PNorm = 50.0426, GNorm = 0.7268, lr_0 = 1.6972e-04
Validation prc-auc = 0.593440
Validation auc = 0.841176
Epoch 23
Loss = 6.0228e-02, PNorm = 50.0693, GNorm = 0.8102, lr_0 = 1.6599e-04
Loss = 7.5912e-02, PNorm = 50.0836, GNorm = 0.2442, lr_0 = 1.6234e-04
Loss = 8.3415e-02, PNorm = 50.1035, GNorm = 0.6167, lr_0 = 1.5877e-04
Loss = 6.8276e-02, PNorm = 50.1264, GNorm = 0.4991, lr_0 = 1.5528e-04
Validation prc-auc = 0.570751
Validation auc = 0.820588
Epoch 24
Loss = 6.4580e-02, PNorm = 50.1423, GNorm = 0.8250, lr_0 = 1.5187e-04
Loss = 9.5539e-02, PNorm = 50.1639, GNorm = 1.0952, lr_0 = 1.4853e-04
Loss = 5.0966e-02, PNorm = 50.1848, GNorm = 0.9478, lr_0 = 1.4527e-04
Validation prc-auc = 0.590477
Validation auc = 0.842246
Epoch 25
Loss = 1.8678e-02, PNorm = 50.2024, GNorm = 0.2103, lr_0 = 1.4207e-04
Loss = 5.8510e-02, PNorm = 50.2176, GNorm = 0.4815, lr_0 = 1.3895e-04
Loss = 8.6525e-02, PNorm = 50.2433, GNorm = 0.4772, lr_0 = 1.3590e-04
Loss = 6.9628e-02, PNorm = 50.2567, GNorm = 0.8270, lr_0 = 1.3291e-04
Validation prc-auc = 0.537732
Validation auc = 0.835829
Epoch 26
Loss = 4.9205e-02, PNorm = 50.2752, GNorm = 0.2968, lr_0 = 1.2999e-04
Loss = 5.0072e-02, PNorm = 50.2977, GNorm = 0.6704, lr_0 = 1.2713e-04
Loss = 9.6793e-02, PNorm = 50.3103, GNorm = 0.5412, lr_0 = 1.2434e-04
Loss = 4.6915e-02, PNorm = 50.3280, GNorm = 0.2772, lr_0 = 1.2160e-04
Validation prc-auc = 0.609044
Validation auc = 0.825668
Epoch 27
Loss = 8.3024e-02, PNorm = 50.3390, GNorm = 0.7025, lr_0 = 1.1893e-04
Loss = 5.4327e-02, PNorm = 50.3554, GNorm = 0.3094, lr_0 = 1.1632e-04
Loss = 5.4933e-02, PNorm = 50.3670, GNorm = 0.4356, lr_0 = 1.1376e-04
Loss = 7.3167e-02, PNorm = 50.3807, GNorm = 0.7632, lr_0 = 1.1126e-04
Validation prc-auc = 0.559558
Validation auc = 0.833422
Epoch 28
Loss = 8.6176e-02, PNorm = 50.4006, GNorm = 0.4337, lr_0 = 1.0881e-04
Loss = 6.0362e-02, PNorm = 50.4100, GNorm = 0.8460, lr_0 = 1.0642e-04
Loss = 5.5436e-02, PNorm = 50.4274, GNorm = 0.9097, lr_0 = 1.0408e-04
Loss = 4.9867e-02, PNorm = 50.4362, GNorm = 0.5863, lr_0 = 1.0179e-04
Validation prc-auc = 0.554874
Validation auc = 0.839840
Epoch 29
Loss = 4.4162e-02, PNorm = 50.4492, GNorm = 0.1769, lr_0 = 1.0000e-04
Loss = 4.8430e-02, PNorm = 50.4574, GNorm = 0.3699, lr_0 = 1.0000e-04
Loss = 5.1734e-02, PNorm = 50.4722, GNorm = 0.1768, lr_0 = 1.0000e-04
Validation prc-auc = 0.574167
Validation auc = 0.805882
Model 0 best validation prc-auc = 0.630173 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.671304
Model 0 test auc = 0.803379
Ensemble test prc-auc = 0.671304
Ensemble test auc = 0.803379
Fold 29
Splitting data with seed 29
Total scaffolds = 1,115 | train scaffolds = 862 | val scaffolds = 145 | test scaffolds = 108
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 281 | target average = 0.028470


Scaffold 1
Task 0: count = 213 | target average = 0.014085


Scaffold 2
Task 0: count = 50 | target average = 0.000000


Scaffold 3
Task 0: count = 26 | target average = 0.000000


Scaffold 4
Task 0: count = 21 | target average = 0.000000


Scaffold 5
Task 0: count = 19 | target average = 0.000000


Scaffold 6
Task 0: count = 17 | target average = 0.000000


Scaffold 7
Task 0: count = 16 | target average = 0.000000


Scaffold 8
Task 0: count = 14 | target average = 0.000000


Scaffold 9
Task 0: count = 14 | target average = 0.000000


Class sizes
class 0: 93.98%, 1: 6.02%
Total size = 2,374 | train size = 1,899 | val size = 237 | test size = 238
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.05, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=900, bias=False)
        (W_h): Linear(in_features=900, out_features=900, bias=False)
        (W_o): Linear(in_features=1033, out_features=900, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 1,874,001
Epoch 0
Loss = 3.3649e-01, PNorm = 46.0445, GNorm = 1.9174, lr_0 = 2.3378e-04
Loss = 2.4042e-01, PNorm = 46.0601, GNorm = 0.3827, lr_0 = 3.5541e-04
Loss = 2.6024e-01, PNorm = 46.0829, GNorm = 0.6166, lr_0 = 4.7703e-04
Validation prc-auc = 0.153624
Validation auc = 0.553086
Epoch 1
Loss = 1.2538e-01, PNorm = 46.1183, GNorm = 0.1492, lr_0 = 6.1081e-04
Loss = 1.8587e-01, PNorm = 46.1385, GNorm = 0.2907, lr_0 = 7.3243e-04
Loss = 2.2642e-01, PNorm = 46.1786, GNorm = 0.5424, lr_0 = 8.5405e-04
Loss = 1.9419e-01, PNorm = 46.2330, GNorm = 0.8719, lr_0 = 9.7568e-04
Validation prc-auc = 0.149540
Validation auc = 0.593474
Epoch 2
Loss = 1.9937e-01, PNorm = 46.3051, GNorm = 0.4154, lr_0 = 9.8238e-04
Loss = 2.0305e-01, PNorm = 46.4039, GNorm = 0.2602, lr_0 = 9.6078e-04
Loss = 2.5411e-01, PNorm = 46.4841, GNorm = 0.2653, lr_0 = 9.3966e-04
Loss = 1.7626e-01, PNorm = 46.5681, GNorm = 0.6343, lr_0 = 9.1901e-04
Validation prc-auc = 0.211372
Validation auc = 0.667372
Epoch 3
Loss = 1.9025e-01, PNorm = 46.6283, GNorm = 0.6603, lr_0 = 8.9881e-04
Loss = 2.0395e-01, PNorm = 46.6881, GNorm = 0.2601, lr_0 = 8.7905e-04
Loss = 1.5877e-01, PNorm = 46.7791, GNorm = 0.6093, lr_0 = 8.5973e-04
Loss = 1.7091e-01, PNorm = 46.8451, GNorm = 0.3558, lr_0 = 8.4083e-04
Validation prc-auc = 0.206733
Validation auc = 0.658025
Epoch 4
Loss = 1.4130e-01, PNorm = 46.9047, GNorm = 0.7013, lr_0 = 8.2235e-04
Loss = 1.8852e-01, PNorm = 46.9755, GNorm = 0.3603, lr_0 = 8.0428e-04
Loss = 1.6753e-01, PNorm = 47.0550, GNorm = 0.3472, lr_0 = 7.8660e-04
Validation prc-auc = 0.245705
Validation auc = 0.676014
Epoch 5
Loss = 2.3099e-01, PNorm = 47.1177, GNorm = 0.7964, lr_0 = 7.6931e-04
Loss = 1.5567e-01, PNorm = 47.1752, GNorm = 0.4489, lr_0 = 7.5240e-04
Loss = 1.4504e-01, PNorm = 47.2345, GNorm = 0.2582, lr_0 = 7.3586e-04
Loss = 1.7244e-01, PNorm = 47.2939, GNorm = 1.7033, lr_0 = 7.1969e-04
Validation prc-auc = 0.298121
Validation auc = 0.686243
Epoch 6
Loss = 1.7944e-01, PNorm = 47.3687, GNorm = 0.2263, lr_0 = 7.0387e-04
Loss = 1.5764e-01, PNorm = 47.4379, GNorm = 0.6004, lr_0 = 6.8840e-04
Loss = 1.7114e-01, PNorm = 47.5154, GNorm = 0.3145, lr_0 = 6.7326e-04
Loss = 1.8775e-01, PNorm = 47.5966, GNorm = 1.1701, lr_0 = 6.5847e-04
Validation prc-auc = 0.250221
Validation auc = 0.651499
Epoch 7
Loss = 1.6723e-01, PNorm = 47.6573, GNorm = 0.3849, lr_0 = 6.4399e-04
Loss = 1.3114e-01, PNorm = 47.7219, GNorm = 0.2190, lr_0 = 6.2984e-04
Loss = 1.5827e-01, PNorm = 47.7779, GNorm = 0.2684, lr_0 = 6.1599e-04
Loss = 1.5549e-01, PNorm = 47.8410, GNorm = 0.3337, lr_0 = 6.0245e-04
Validation prc-auc = 0.263170
Validation auc = 0.658554
Epoch 8
Loss = 1.2167e-01, PNorm = 47.9027, GNorm = 0.3963, lr_0 = 5.8921e-04
Loss = 1.1908e-01, PNorm = 47.9658, GNorm = 0.3333, lr_0 = 5.7626e-04
Loss = 1.6337e-01, PNorm = 48.0003, GNorm = 1.0579, lr_0 = 5.6359e-04
Loss = 1.3786e-01, PNorm = 48.0605, GNorm = 0.2126, lr_0 = 5.5120e-04
Validation prc-auc = 0.233573
Validation auc = 0.647795
Epoch 9
Loss = 1.1428e-01, PNorm = 48.1169, GNorm = 0.4069, lr_0 = 5.3909e-04
Loss = 1.5846e-01, PNorm = 48.1603, GNorm = 0.1659, lr_0 = 5.2724e-04
Loss = 1.1555e-01, PNorm = 48.2159, GNorm = 0.7307, lr_0 = 5.1565e-04
Validation prc-auc = 0.282500
Validation auc = 0.665785
Epoch 10
Loss = 1.0611e-01, PNorm = 48.2694, GNorm = 0.2144, lr_0 = 5.0432e-04
Loss = 1.2638e-01, PNorm = 48.2966, GNorm = 0.5455, lr_0 = 4.9323e-04
Loss = 1.3507e-01, PNorm = 48.3364, GNorm = 0.6877, lr_0 = 4.8239e-04
Loss = 1.7093e-01, PNorm = 48.3797, GNorm = 0.2506, lr_0 = 4.7179e-04
Validation prc-auc = 0.332220
Validation auc = 0.673545
Epoch 11
Loss = 2.3201e-01, PNorm = 48.4098, GNorm = 0.6710, lr_0 = 4.6142e-04
Loss = 9.3585e-02, PNorm = 48.4535, GNorm = 0.2435, lr_0 = 4.5127e-04
Loss = 1.5086e-01, PNorm = 48.4819, GNorm = 0.7438, lr_0 = 4.4135e-04
Loss = 1.0783e-01, PNorm = 48.5175, GNorm = 0.7113, lr_0 = 4.3165e-04
Validation prc-auc = 0.371048
Validation auc = 0.665961
Epoch 12
Loss = 1.0358e-01, PNorm = 48.5310, GNorm = 0.1469, lr_0 = 4.2217e-04
Loss = 1.1610e-01, PNorm = 48.5660, GNorm = 0.4405, lr_0 = 4.1289e-04
Loss = 1.4350e-01, PNorm = 48.5936, GNorm = 0.8907, lr_0 = 4.0381e-04
Loss = 1.0593e-01, PNorm = 48.6300, GNorm = 0.2011, lr_0 = 3.9493e-04
Validation prc-auc = 0.363541
Validation auc = 0.658907
Epoch 13
Loss = 7.8788e-02, PNorm = 48.6635, GNorm = 0.4097, lr_0 = 3.8625e-04
Loss = 1.1881e-01, PNorm = 48.7017, GNorm = 0.3266, lr_0 = 3.7776e-04
Loss = 1.1756e-01, PNorm = 48.7311, GNorm = 0.3587, lr_0 = 3.6946e-04
Loss = 1.4103e-01, PNorm = 48.7567, GNorm = 0.2849, lr_0 = 3.6134e-04
Validation prc-auc = 0.332683
Validation auc = 0.664374
Epoch 14
Loss = 1.1024e-01, PNorm = 48.7821, GNorm = 0.4855, lr_0 = 3.5340e-04
Loss = 8.5895e-02, PNorm = 48.8162, GNorm = 0.3180, lr_0 = 3.4563e-04
Loss = 1.2055e-01, PNorm = 48.8455, GNorm = 0.5935, lr_0 = 3.3803e-04
Validation prc-auc = 0.377601
Validation auc = 0.664550
Epoch 15
Loss = 3.3218e-02, PNorm = 48.8725, GNorm = 0.3197, lr_0 = 3.3060e-04
Loss = 9.8710e-02, PNorm = 48.9097, GNorm = 0.1938, lr_0 = 3.2333e-04
Loss = 1.2235e-01, PNorm = 48.9355, GNorm = 0.7343, lr_0 = 3.1623e-04
Loss = 9.4969e-02, PNorm = 48.9585, GNorm = 0.4898, lr_0 = 3.0928e-04
Validation prc-auc = 0.274461
Validation auc = 0.644444
Epoch 16
Loss = 9.9398e-02, PNorm = 48.9812, GNorm = 0.4649, lr_0 = 3.0248e-04
Loss = 1.1294e-01, PNorm = 49.0265, GNorm = 0.2346, lr_0 = 2.9583e-04
Loss = 1.0537e-01, PNorm = 49.0584, GNorm = 0.3514, lr_0 = 2.8933e-04
Loss = 1.1294e-01, PNorm = 49.0823, GNorm = 0.2456, lr_0 = 2.8297e-04
Validation prc-auc = 0.367565
Validation auc = 0.670723
Epoch 17
Loss = 8.4740e-02, PNorm = 49.1094, GNorm = 0.2589, lr_0 = 2.7675e-04
Loss = 1.4629e-01, PNorm = 49.1376, GNorm = 0.6941, lr_0 = 2.7067e-04
Loss = 7.2378e-02, PNorm = 49.1705, GNorm = 0.2382, lr_0 = 2.6472e-04
Loss = 9.1470e-02, PNorm = 49.1901, GNorm = 0.4566, lr_0 = 2.5890e-04
Validation prc-auc = 0.404836
Validation auc = 0.674780
Epoch 18
Loss = 8.5195e-02, PNorm = 49.2219, GNorm = 0.6504, lr_0 = 2.5321e-04
Loss = 6.3537e-02, PNorm = 49.2403, GNorm = 0.2221, lr_0 = 2.4764e-04
Loss = 1.3498e-01, PNorm = 49.2573, GNorm = 0.7710, lr_0 = 2.4220e-04
Loss = 1.0488e-01, PNorm = 49.2859, GNorm = 0.4318, lr_0 = 2.3687e-04
Validation prc-auc = 0.402594
Validation auc = 0.675309
Epoch 19
Loss = 8.9168e-02, PNorm = 49.3153, GNorm = 0.2364, lr_0 = 2.3167e-04
Loss = 8.0032e-02, PNorm = 49.3514, GNorm = 0.2867, lr_0 = 2.2658e-04
Loss = 1.0088e-01, PNorm = 49.3709, GNorm = 0.3883, lr_0 = 2.2159e-04
Validation prc-auc = 0.393316
Validation auc = 0.683245
Epoch 20
Loss = 1.1071e-01, PNorm = 49.3888, GNorm = 0.2778, lr_0 = 2.1672e-04
Loss = 8.9910e-02, PNorm = 49.4101, GNorm = 0.3026, lr_0 = 2.1196e-04
Loss = 7.7816e-02, PNorm = 49.4317, GNorm = 0.3782, lr_0 = 2.0730e-04
Loss = 7.6205e-02, PNorm = 49.4622, GNorm = 0.1841, lr_0 = 2.0274e-04
Validation prc-auc = 0.371620
Validation auc = 0.669489
Epoch 21
Loss = 6.2383e-02, PNorm = 49.4781, GNorm = 0.3615, lr_0 = 1.9829e-04
Loss = 7.9061e-02, PNorm = 49.5048, GNorm = 0.7184, lr_0 = 1.9393e-04
Loss = 9.1514e-02, PNorm = 49.5313, GNorm = 0.5819, lr_0 = 1.8967e-04
Loss = 8.9546e-02, PNorm = 49.5445, GNorm = 1.1189, lr_0 = 1.8550e-04
Validation prc-auc = 0.400575
Validation auc = 0.677249
Epoch 22
Loss = 7.4702e-02, PNorm = 49.5737, GNorm = 0.2746, lr_0 = 1.8142e-04
Loss = 6.5323e-02, PNorm = 49.5927, GNorm = 0.1543, lr_0 = 1.7743e-04
Loss = 5.5484e-02, PNorm = 49.6108, GNorm = 0.7098, lr_0 = 1.7353e-04
Loss = 1.0917e-01, PNorm = 49.6236, GNorm = 0.5933, lr_0 = 1.6972e-04
Validation prc-auc = 0.408482
Validation auc = 0.669312
Epoch 23
Loss = 8.2735e-02, PNorm = 49.6482, GNorm = 0.2810, lr_0 = 1.6599e-04
Loss = 9.4965e-02, PNorm = 49.6662, GNorm = 0.5181, lr_0 = 1.6234e-04
Loss = 6.1330e-02, PNorm = 49.6924, GNorm = 0.5363, lr_0 = 1.5877e-04
Loss = 6.8446e-02, PNorm = 49.7133, GNorm = 0.4919, lr_0 = 1.5528e-04
Validation prc-auc = 0.397861
Validation auc = 0.682011
Epoch 24
Loss = 5.1554e-02, PNorm = 49.7280, GNorm = 0.2900, lr_0 = 1.5187e-04
Loss = 7.8438e-02, PNorm = 49.7412, GNorm = 0.4787, lr_0 = 1.4853e-04
Loss = 8.1040e-02, PNorm = 49.7549, GNorm = 0.3266, lr_0 = 1.4527e-04
Validation prc-auc = 0.358777
Validation auc = 0.680423
Epoch 25
Loss = 9.9712e-02, PNorm = 49.7701, GNorm = 0.7134, lr_0 = 1.4207e-04
Loss = 6.2265e-02, PNorm = 49.7902, GNorm = 0.3666, lr_0 = 1.3895e-04
Loss = 6.7481e-02, PNorm = 49.8038, GNorm = 0.4782, lr_0 = 1.3590e-04
Loss = 6.0761e-02, PNorm = 49.8231, GNorm = 0.9343, lr_0 = 1.3291e-04
Validation prc-auc = 0.377620
Validation auc = 0.671429
Epoch 26
Loss = 3.2956e-02, PNorm = 49.8419, GNorm = 0.2327, lr_0 = 1.2999e-04
Loss = 6.0754e-02, PNorm = 49.8593, GNorm = 0.8892, lr_0 = 1.2713e-04
Loss = 7.6672e-02, PNorm = 49.8759, GNorm = 0.7092, lr_0 = 1.2434e-04
Loss = 5.7292e-02, PNorm = 49.8918, GNorm = 0.2013, lr_0 = 1.2160e-04
Validation prc-auc = 0.339022
Validation auc = 0.665961
Epoch 27
Loss = 7.6835e-02, PNorm = 49.9047, GNorm = 0.6403, lr_0 = 1.1893e-04
Loss = 4.4714e-02, PNorm = 49.9218, GNorm = 1.1524, lr_0 = 1.1632e-04
Loss = 5.3290e-02, PNorm = 49.9306, GNorm = 0.3437, lr_0 = 1.1376e-04
Loss = 6.2129e-02, PNorm = 49.9472, GNorm = 0.2237, lr_0 = 1.1126e-04
Validation prc-auc = 0.361647
Validation auc = 0.669841
Epoch 28
Loss = 5.5286e-02, PNorm = 49.9543, GNorm = 0.4641, lr_0 = 1.0881e-04
Loss = 6.5621e-02, PNorm = 49.9678, GNorm = 1.0731, lr_0 = 1.0642e-04
Loss = 6.4262e-02, PNorm = 49.9751, GNorm = 0.4480, lr_0 = 1.0408e-04
Loss = 5.0861e-02, PNorm = 49.9909, GNorm = 0.2086, lr_0 = 1.0179e-04
Validation prc-auc = 0.375694
Validation auc = 0.678307
Epoch 29
Loss = 5.4873e-02, PNorm = 50.0067, GNorm = 1.1016, lr_0 = 1.0000e-04
Loss = 5.8030e-02, PNorm = 50.0217, GNorm = 0.4581, lr_0 = 1.0000e-04
Loss = 4.6936e-02, PNorm = 50.0314, GNorm = 0.3645, lr_0 = 1.0000e-04
Validation prc-auc = 0.344156
Validation auc = 0.663492
Model 0 best validation prc-auc = 0.408482 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 test prc-auc = 0.360616
Model 0 test auc = 0.844828
Ensemble test prc-auc = 0.360616
Ensemble test auc = 0.844828
30-fold cross validation
	Seed 0 ==> test prc-auc = 0.545332
	Seed 0 ==> test auc = 0.843658
	Seed 1 ==> test prc-auc = 0.447143
	Seed 1 ==> test auc = 0.800106
	Seed 2 ==> test prc-auc = 0.393380
	Seed 2 ==> test auc = 0.795723
	Seed 3 ==> test prc-auc = 0.448054
	Seed 3 ==> test auc = 0.791456
	Seed 4 ==> test prc-auc = 0.487867
	Seed 4 ==> test auc = 0.866071
	Seed 5 ==> test prc-auc = 0.606067
	Seed 5 ==> test auc = 0.846916
	Seed 6 ==> test prc-auc = 0.468469
	Seed 6 ==> test auc = 0.810248
	Seed 7 ==> test prc-auc = 0.452467
	Seed 7 ==> test auc = 0.802365
	Seed 8 ==> test prc-auc = 0.313540
	Seed 8 ==> test auc = 0.716228
	Seed 9 ==> test prc-auc = 0.561773
	Seed 9 ==> test auc = 0.859557
	Seed 10 ==> test prc-auc = 0.462790
	Seed 10 ==> test auc = 0.882818
	Seed 11 ==> test prc-auc = 0.691745
	Seed 11 ==> test auc = 0.973820
	Seed 12 ==> test prc-auc = 0.375430
	Seed 12 ==> test auc = 0.815689
	Seed 13 ==> test prc-auc = 0.455225
	Seed 13 ==> test auc = 0.721380
	Seed 14 ==> test prc-auc = 0.302903
	Seed 14 ==> test auc = 0.648161
	Seed 15 ==> test prc-auc = 0.175001
	Seed 15 ==> test auc = 0.682018
	Seed 16 ==> test prc-auc = 0.295104
	Seed 16 ==> test auc = 0.717183
	Seed 17 ==> test prc-auc = 0.587767
	Seed 17 ==> test auc = 0.713189
	Seed 18 ==> test prc-auc = 0.510540
	Seed 18 ==> test auc = 0.696429
	Seed 19 ==> test prc-auc = 0.224715
	Seed 19 ==> test auc = 0.771930
	Seed 20 ==> test prc-auc = 0.287714
	Seed 20 ==> test auc = 0.726832
	Seed 21 ==> test prc-auc = 0.472399
	Seed 21 ==> test auc = 0.716795
	Seed 22 ==> test prc-auc = 0.426701
	Seed 22 ==> test auc = 0.813158
	Seed 23 ==> test prc-auc = 0.260567
	Seed 23 ==> test auc = 0.678070
	Seed 24 ==> test prc-auc = 0.482664
	Seed 24 ==> test auc = 0.692286
	Seed 25 ==> test prc-auc = 0.468104
	Seed 25 ==> test auc = 0.811718
	Seed 26 ==> test prc-auc = 0.505191
	Seed 26 ==> test auc = 0.715213
	Seed 27 ==> test prc-auc = 0.442634
	Seed 27 ==> test auc = 0.796581
	Seed 28 ==> test prc-auc = 0.671304
	Seed 28 ==> test auc = 0.803379
	Seed 29 ==> test prc-auc = 0.360616
	Seed 29 ==> test auc = 0.844828
Overall test prc-auc = 0.439440 +/- 0.122445
Overall test auc = 0.778460 +/- 0.073026
Elapsed time = 2:22:55

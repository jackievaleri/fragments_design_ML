Command line
python /home/felixjwong/miniconda3/envs/chemprop/bin/chemprop_train --data_path final_tox_primary/primary_tox_full.csv --dataset_type classification --config_path final_tox_primary/opt.json --save_dir final_tox_primary/train/checkpoints4 --ensemble_size 1 --features_generator rdkit_2d_normalized --no_features_scaling --seed 4
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'final_tox_primary/opt.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'final_tox_primary/primary_tox_full.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'ensemble_size': 1,
 'epochs': 30,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'final_tox_primary/train/checkpoints4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['\ufeffSMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['TOXICITY'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 4
Class sizes
TOXICITY 0: 91.50%, 1: 8.50%
Total size = 39,312 | train size = 31,449 | val size = 3,931 | test size = 3,932
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35, inplace=False)
    (4): Linear(in_features=1600, out_features=1600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35, inplace=False)
    (7): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 11,014,401
Epoch 0
Loss = 3.5922e-01, PNorm = 82.6356, GNorm = 0.8100, lr_0 = 1.0788e-04
Loss = 2.8844e-01, PNorm = 82.6431, GNorm = 0.8384, lr_0 = 1.1505e-04
Loss = 2.8948e-01, PNorm = 82.6514, GNorm = 0.6396, lr_0 = 1.2221e-04
Loss = 2.8678e-01, PNorm = 82.6578, GNorm = 0.7926, lr_0 = 1.2938e-04
Loss = 2.5405e-01, PNorm = 82.6646, GNorm = 0.7917, lr_0 = 1.3654e-04
Loss = 2.2132e-01, PNorm = 82.6716, GNorm = 0.6681, lr_0 = 1.4371e-04
Loss = 3.2098e-01, PNorm = 82.6762, GNorm = 0.8750, lr_0 = 1.5088e-04
Loss = 2.9216e-01, PNorm = 82.6838, GNorm = 0.7020, lr_0 = 1.5804e-04
Loss = 2.7658e-01, PNorm = 82.6927, GNorm = 0.6845, lr_0 = 1.6521e-04
Loss = 2.1067e-01, PNorm = 82.7009, GNorm = 0.7785, lr_0 = 1.7237e-04
Loss = 3.0482e-01, PNorm = 82.7090, GNorm = 0.6949, lr_0 = 1.7954e-04
Loss = 2.5978e-01, PNorm = 82.7170, GNorm = 1.2569, lr_0 = 1.8670e-04
Loss = 3.2569e-01, PNorm = 82.7259, GNorm = 0.9975, lr_0 = 1.9387e-04
Loss = 2.6213e-01, PNorm = 82.7386, GNorm = 0.6777, lr_0 = 2.0104e-04
Loss = 3.0009e-01, PNorm = 82.7476, GNorm = 1.0408, lr_0 = 2.0820e-04
Loss = 2.8938e-01, PNorm = 82.7596, GNorm = 0.6645, lr_0 = 2.1537e-04
Loss = 3.2658e-01, PNorm = 82.7727, GNorm = 0.7158, lr_0 = 2.2253e-04
Loss = 2.7221e-01, PNorm = 82.7851, GNorm = 0.7350, lr_0 = 2.2970e-04
Loss = 2.9042e-01, PNorm = 82.8009, GNorm = 0.6374, lr_0 = 2.3686e-04
Loss = 2.2525e-01, PNorm = 82.8178, GNorm = 0.7731, lr_0 = 2.4403e-04
Loss = 3.1047e-01, PNorm = 82.8260, GNorm = 0.9054, lr_0 = 2.5119e-04
Loss = 2.8874e-01, PNorm = 82.8406, GNorm = 0.8665, lr_0 = 2.5836e-04
Loss = 2.9426e-01, PNorm = 82.8533, GNorm = 0.7145, lr_0 = 2.6553e-04
Loss = 2.4604e-01, PNorm = 82.8676, GNorm = 0.7185, lr_0 = 2.7269e-04
Loss = 2.9185e-01, PNorm = 82.8795, GNorm = 1.2988, lr_0 = 2.7986e-04
Loss = 2.5975e-01, PNorm = 82.8949, GNorm = 0.5872, lr_0 = 2.8702e-04
Loss = 2.9986e-01, PNorm = 82.9095, GNorm = 0.7931, lr_0 = 2.9419e-04
Loss = 2.6114e-01, PNorm = 82.9269, GNorm = 0.6116, lr_0 = 3.0135e-04
Loss = 3.2182e-01, PNorm = 82.9429, GNorm = 0.5668, lr_0 = 3.0852e-04
Loss = 2.9738e-01, PNorm = 82.9554, GNorm = 0.7197, lr_0 = 3.1568e-04
Loss = 2.5552e-01, PNorm = 82.9761, GNorm = 0.4411, lr_0 = 3.2285e-04
Loss = 2.7620e-01, PNorm = 82.9868, GNorm = 0.6280, lr_0 = 3.3002e-04
Loss = 2.2587e-01, PNorm = 83.0020, GNorm = 0.4205, lr_0 = 3.3718e-04
Loss = 2.3834e-01, PNorm = 83.0140, GNorm = 0.4806, lr_0 = 3.4435e-04
Loss = 2.8707e-01, PNorm = 83.0255, GNorm = 0.6515, lr_0 = 3.5151e-04
Loss = 2.7781e-01, PNorm = 83.0470, GNorm = 0.4580, lr_0 = 3.5868e-04
Loss = 2.9952e-01, PNorm = 83.0605, GNorm = 0.6594, lr_0 = 3.6584e-04
Loss = 2.3426e-01, PNorm = 83.0813, GNorm = 0.4993, lr_0 = 3.7301e-04
Loss = 2.5764e-01, PNorm = 83.0971, GNorm = 0.8770, lr_0 = 3.8018e-04
Loss = 2.6184e-01, PNorm = 83.1186, GNorm = 0.8304, lr_0 = 3.8734e-04
Loss = 3.2593e-01, PNorm = 83.1352, GNorm = 0.7003, lr_0 = 3.9451e-04
Loss = 2.6062e-01, PNorm = 83.1584, GNorm = 0.8033, lr_0 = 4.0167e-04
Loss = 2.6378e-01, PNorm = 83.1713, GNorm = 0.5366, lr_0 = 4.0884e-04
Loss = 2.2851e-01, PNorm = 83.1887, GNorm = 0.8372, lr_0 = 4.1600e-04
Loss = 2.2452e-01, PNorm = 83.1999, GNorm = 0.4301, lr_0 = 4.2317e-04
Loss = 3.0745e-01, PNorm = 83.2122, GNorm = 0.6297, lr_0 = 4.3033e-04
Loss = 2.8584e-01, PNorm = 83.2289, GNorm = 0.4255, lr_0 = 4.3750e-04
Loss = 2.8185e-01, PNorm = 83.2466, GNorm = 0.5195, lr_0 = 4.4467e-04
Loss = 2.8221e-01, PNorm = 83.2698, GNorm = 0.4841, lr_0 = 4.5183e-04
Loss = 2.4505e-01, PNorm = 83.2971, GNorm = 0.4657, lr_0 = 4.5900e-04
Loss = 2.5815e-01, PNorm = 83.3281, GNorm = 0.6039, lr_0 = 4.6616e-04
Loss = 2.8499e-01, PNorm = 83.3660, GNorm = 0.9390, lr_0 = 4.7333e-04
Loss = 2.0953e-01, PNorm = 83.4080, GNorm = 0.8130, lr_0 = 4.8049e-04
Loss = 3.0200e-01, PNorm = 83.4375, GNorm = 0.5959, lr_0 = 4.8766e-04
Loss = 2.3499e-01, PNorm = 83.4677, GNorm = 0.4296, lr_0 = 4.9482e-04
Loss = 2.7420e-01, PNorm = 83.4994, GNorm = 0.3933, lr_0 = 5.0199e-04
Loss = 2.8031e-01, PNorm = 83.5228, GNorm = 0.5033, lr_0 = 5.0916e-04
Loss = 3.1145e-01, PNorm = 83.5542, GNorm = 0.6052, lr_0 = 5.1632e-04
Loss = 2.5951e-01, PNorm = 83.5780, GNorm = 0.4983, lr_0 = 5.2349e-04
Loss = 2.9604e-01, PNorm = 83.6098, GNorm = 0.9751, lr_0 = 5.3065e-04
Loss = 2.8671e-01, PNorm = 83.6489, GNorm = 0.4787, lr_0 = 5.3782e-04
Loss = 2.6274e-01, PNorm = 83.6830, GNorm = 0.4234, lr_0 = 5.4498e-04
Validation auc = 0.777599
Epoch 1
Loss = 2.3773e-01, PNorm = 83.7294, GNorm = 0.4932, lr_0 = 5.5287e-04
Loss = 2.8811e-01, PNorm = 83.7826, GNorm = 0.4704, lr_0 = 5.6003e-04
Loss = 2.5085e-01, PNorm = 83.8298, GNorm = 0.7873, lr_0 = 5.6720e-04
Loss = 2.9077e-01, PNorm = 83.8896, GNorm = 0.6664, lr_0 = 5.7436e-04
Loss = 2.8912e-01, PNorm = 83.9295, GNorm = 1.4251, lr_0 = 5.8153e-04
Loss = 2.8292e-01, PNorm = 83.9627, GNorm = 0.5352, lr_0 = 5.8869e-04
Loss = 2.7459e-01, PNorm = 84.0021, GNorm = 0.6168, lr_0 = 5.9586e-04
Loss = 2.8563e-01, PNorm = 84.0398, GNorm = 0.4264, lr_0 = 6.0303e-04
Loss = 2.6208e-01, PNorm = 84.0756, GNorm = 0.4295, lr_0 = 6.1019e-04
Loss = 1.7256e-01, PNorm = 84.1326, GNorm = 0.3478, lr_0 = 6.1736e-04
Loss = 2.3731e-01, PNorm = 84.1929, GNorm = 0.3503, lr_0 = 6.2452e-04
Loss = 2.5015e-01, PNorm = 84.2433, GNorm = 0.5132, lr_0 = 6.3169e-04
Loss = 2.9837e-01, PNorm = 84.3136, GNorm = 0.9291, lr_0 = 6.3885e-04
Loss = 2.4890e-01, PNorm = 84.3694, GNorm = 0.5748, lr_0 = 6.4602e-04
Loss = 2.8400e-01, PNorm = 84.4143, GNorm = 0.3980, lr_0 = 6.5318e-04
Loss = 3.1549e-01, PNorm = 84.4688, GNorm = 0.5219, lr_0 = 6.6035e-04
Loss = 2.5030e-01, PNorm = 84.5481, GNorm = 0.4315, lr_0 = 6.6752e-04
Loss = 2.3788e-01, PNorm = 84.6527, GNorm = 0.4281, lr_0 = 6.7468e-04
Loss = 2.5312e-01, PNorm = 84.7506, GNorm = 0.3481, lr_0 = 6.8185e-04
Loss = 2.5944e-01, PNorm = 84.8263, GNorm = 0.4818, lr_0 = 6.8901e-04
Loss = 2.9577e-01, PNorm = 84.8781, GNorm = 0.3978, lr_0 = 6.9618e-04
Loss = 2.8071e-01, PNorm = 84.9376, GNorm = 0.8053, lr_0 = 7.0334e-04
Loss = 2.6976e-01, PNorm = 85.0011, GNorm = 0.9418, lr_0 = 7.1051e-04
Loss = 2.5527e-01, PNorm = 85.0665, GNorm = 1.7230, lr_0 = 7.1768e-04
Loss = 2.5819e-01, PNorm = 85.1444, GNorm = 0.5132, lr_0 = 7.2484e-04
Loss = 2.4102e-01, PNorm = 85.2170, GNorm = 0.3798, lr_0 = 7.3201e-04
Loss = 2.4867e-01, PNorm = 85.2880, GNorm = 0.6474, lr_0 = 7.3917e-04
Loss = 2.0185e-01, PNorm = 85.3720, GNorm = 0.4167, lr_0 = 7.4634e-04
Loss = 2.9054e-01, PNorm = 85.4548, GNorm = 0.7320, lr_0 = 7.5350e-04
Loss = 2.8175e-01, PNorm = 85.5726, GNorm = 0.4865, lr_0 = 7.6067e-04
Loss = 2.8091e-01, PNorm = 85.6756, GNorm = 0.5578, lr_0 = 7.6783e-04
Loss = 2.9660e-01, PNorm = 85.7543, GNorm = 0.4072, lr_0 = 7.7500e-04
Loss = 2.5529e-01, PNorm = 85.8317, GNorm = 0.4514, lr_0 = 7.8217e-04

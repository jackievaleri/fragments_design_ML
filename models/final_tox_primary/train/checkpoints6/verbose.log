Command line
python /home/felixjwong/miniconda3/envs/chemprop/bin/chemprop_train --data_path final_tox_primary/primary_tox_full.csv --dataset_type classification --config_path final_tox_primary/opt.json --save_dir final_tox_primary/train/checkpoints6 --ensemble_size 1 --features_generator rdkit_2d_normalized --no_features_scaling --seed 6
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'final_tox_primary/opt.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'final_tox_primary/primary_tox_full.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'ensemble_size': 1,
 'epochs': 30,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'final_tox_primary/train/checkpoints6',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 6,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['\ufeffSMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['TOXICITY'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 6
Class sizes
TOXICITY 0: 91.50%, 1: 8.50%
Total size = 39,312 | train size = 31,449 | val size = 3,931 | test size = 3,932
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35, inplace=False)
    (4): Linear(in_features=1600, out_features=1600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35, inplace=False)
    (7): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 11,014,401
Epoch 0
Loss = 3.6987e-01, PNorm = 82.6345, GNorm = 1.2124, lr_0 = 1.0788e-04
Loss = 3.1839e-01, PNorm = 82.6415, GNorm = 1.0327, lr_0 = 1.1505e-04
Loss = 3.2843e-01, PNorm = 82.6498, GNorm = 0.9648, lr_0 = 1.2221e-04
Loss = 3.2972e-01, PNorm = 82.6559, GNorm = 0.7867, lr_0 = 1.2938e-04
Loss = 3.0264e-01, PNorm = 82.6634, GNorm = 0.6255, lr_0 = 1.3654e-04
Loss = 3.1200e-01, PNorm = 82.6701, GNorm = 0.7626, lr_0 = 1.4371e-04
Loss = 2.8818e-01, PNorm = 82.6763, GNorm = 0.7239, lr_0 = 1.5088e-04
Loss = 2.6107e-01, PNorm = 82.6846, GNorm = 0.8679, lr_0 = 1.5804e-04
Loss = 2.7563e-01, PNorm = 82.6916, GNorm = 1.0857, lr_0 = 1.6521e-04
Loss = 2.5077e-01, PNorm = 82.7013, GNorm = 1.0140, lr_0 = 1.7237e-04
Loss = 3.5702e-01, PNorm = 82.7095, GNorm = 0.6975, lr_0 = 1.7954e-04
Loss = 2.4784e-01, PNorm = 82.7198, GNorm = 0.6210, lr_0 = 1.8670e-04
Loss = 2.6303e-01, PNorm = 82.7296, GNorm = 0.7552, lr_0 = 1.9387e-04
Loss = 2.5006e-01, PNorm = 82.7400, GNorm = 0.6310, lr_0 = 2.0104e-04
Loss = 3.0628e-01, PNorm = 82.7504, GNorm = 1.4540, lr_0 = 2.0820e-04
Loss = 2.5632e-01, PNorm = 82.7641, GNorm = 0.8821, lr_0 = 2.1537e-04
Loss = 2.5173e-01, PNorm = 82.7740, GNorm = 1.0350, lr_0 = 2.2253e-04
Loss = 2.1358e-01, PNorm = 82.7871, GNorm = 1.4554, lr_0 = 2.2970e-04
Loss = 2.7810e-01, PNorm = 82.7996, GNorm = 1.9109, lr_0 = 2.3686e-04
Loss = 2.9089e-01, PNorm = 82.8125, GNorm = 0.8430, lr_0 = 2.4403e-04
Loss = 2.0463e-01, PNorm = 82.8255, GNorm = 0.6726, lr_0 = 2.5119e-04
Loss = 1.9809e-01, PNorm = 82.8371, GNorm = 0.5114, lr_0 = 2.5836e-04
Loss = 2.0542e-01, PNorm = 82.8494, GNorm = 0.4742, lr_0 = 2.6553e-04
Loss = 2.5876e-01, PNorm = 82.8625, GNorm = 0.6010, lr_0 = 2.7269e-04
Loss = 2.9100e-01, PNorm = 82.8754, GNorm = 1.5601, lr_0 = 2.7986e-04
Loss = 2.7985e-01, PNorm = 82.8892, GNorm = 0.6850, lr_0 = 2.8702e-04
Loss = 3.0171e-01, PNorm = 82.9063, GNorm = 0.6231, lr_0 = 2.9419e-04
Loss = 2.4300e-01, PNorm = 82.9252, GNorm = 0.8721, lr_0 = 3.0135e-04
Loss = 2.8040e-01, PNorm = 82.9376, GNorm = 0.6309, lr_0 = 3.0852e-04
Loss = 2.5378e-01, PNorm = 82.9580, GNorm = 0.5686, lr_0 = 3.1568e-04
Loss = 2.6396e-01, PNorm = 82.9719, GNorm = 0.6561, lr_0 = 3.2285e-04
Loss = 2.6821e-01, PNorm = 82.9901, GNorm = 0.7546, lr_0 = 3.3002e-04
Loss = 2.7760e-01, PNorm = 83.0105, GNorm = 0.8789, lr_0 = 3.3718e-04
Loss = 2.5436e-01, PNorm = 83.0312, GNorm = 0.7541, lr_0 = 3.4435e-04
Loss = 3.0145e-01, PNorm = 83.0564, GNorm = 1.5326, lr_0 = 3.5151e-04
Loss = 2.4662e-01, PNorm = 83.0808, GNorm = 0.8601, lr_0 = 3.5868e-04
Loss = 2.4080e-01, PNorm = 83.0960, GNorm = 0.5302, lr_0 = 3.6584e-04
Loss = 2.6291e-01, PNorm = 83.1154, GNorm = 0.5597, lr_0 = 3.7301e-04
Loss = 2.6855e-01, PNorm = 83.1382, GNorm = 0.5165, lr_0 = 3.8018e-04
Loss = 3.0492e-01, PNorm = 83.1533, GNorm = 0.5377, lr_0 = 3.8734e-04
Loss = 2.8335e-01, PNorm = 83.1712, GNorm = 0.7552, lr_0 = 3.9451e-04
Loss = 2.7431e-01, PNorm = 83.1935, GNorm = 0.9436, lr_0 = 4.0167e-04
Loss = 2.6491e-01, PNorm = 83.2131, GNorm = 0.5850, lr_0 = 4.0884e-04
Loss = 2.6211e-01, PNorm = 83.2313, GNorm = 0.5200, lr_0 = 4.1600e-04
Loss = 2.1587e-01, PNorm = 83.2502, GNorm = 0.9450, lr_0 = 4.2317e-04
Loss = 2.3408e-01, PNorm = 83.2698, GNorm = 0.5627, lr_0 = 4.3033e-04
Loss = 2.6138e-01, PNorm = 83.2883, GNorm = 0.5157, lr_0 = 4.3750e-04
Loss = 2.9445e-01, PNorm = 83.3081, GNorm = 0.6989, lr_0 = 4.4467e-04
Loss = 2.8539e-01, PNorm = 83.3324, GNorm = 0.7632, lr_0 = 4.5183e-04
Loss = 2.6825e-01, PNorm = 83.3567, GNorm = 0.8229, lr_0 = 4.5900e-04
Loss = 2.9521e-01, PNorm = 83.3869, GNorm = 0.4983, lr_0 = 4.6616e-04
Loss = 2.7428e-01, PNorm = 83.4096, GNorm = 0.7258, lr_0 = 4.7333e-04
Loss = 2.9303e-01, PNorm = 83.4364, GNorm = 0.4459, lr_0 = 4.8049e-04
Loss = 2.9711e-01, PNorm = 83.4617, GNorm = 0.6272, lr_0 = 4.8766e-04
Loss = 2.6761e-01, PNorm = 83.4869, GNorm = 0.8408, lr_0 = 4.9482e-04
Loss = 2.9407e-01, PNorm = 83.5141, GNorm = 0.6227, lr_0 = 5.0199e-04
Loss = 2.5711e-01, PNorm = 83.5519, GNorm = 0.4430, lr_0 = 5.0916e-04
Loss = 2.3618e-01, PNorm = 83.5758, GNorm = 0.7310, lr_0 = 5.1632e-04
Loss = 2.4330e-01, PNorm = 83.6000, GNorm = 0.5309, lr_0 = 5.2349e-04
Loss = 2.4125e-01, PNorm = 83.6170, GNorm = 0.8118, lr_0 = 5.3065e-04
Loss = 2.9645e-01, PNorm = 83.6412, GNorm = 0.7796, lr_0 = 5.3782e-04
Loss = 2.8261e-01, PNorm = 83.6659, GNorm = 0.8451, lr_0 = 5.4498e-04
Validation auc = 0.777078
Epoch 1
Loss = 2.9820e-01, PNorm = 83.7028, GNorm = 0.5698, lr_0 = 5.5287e-04
Loss = 2.8092e-01, PNorm = 83.7444, GNorm = 0.7989, lr_0 = 5.6003e-04
Loss = 2.4726e-01, PNorm = 83.7864, GNorm = 0.4305, lr_0 = 5.6720e-04
Loss = 2.8466e-01, PNorm = 83.8257, GNorm = 0.4875, lr_0 = 5.7436e-04
Loss = 2.4472e-01, PNorm = 83.8678, GNorm = 0.4674, lr_0 = 5.8153e-04
Loss = 2.4640e-01, PNorm = 83.9194, GNorm = 0.9067, lr_0 = 5.8869e-04
Loss = 2.8400e-01, PNorm = 83.9704, GNorm = 0.4512, lr_0 = 5.9586e-04
Loss = 2.6589e-01, PNorm = 84.0237, GNorm = 0.7412, lr_0 = 6.0303e-04
Loss = 3.0692e-01, PNorm = 84.0821, GNorm = 0.6861, lr_0 = 6.1019e-04
Loss = 2.7335e-01, PNorm = 84.1509, GNorm = 0.4384, lr_0 = 6.1736e-04
Loss = 2.5429e-01, PNorm = 84.2283, GNorm = 0.4192, lr_0 = 6.2452e-04
Loss = 2.5946e-01, PNorm = 84.2914, GNorm = 0.6082, lr_0 = 6.3169e-04
Loss = 2.5787e-01, PNorm = 84.3631, GNorm = 0.4641, lr_0 = 6.3885e-04
Loss = 1.8380e-01, PNorm = 84.4257, GNorm = 0.5926, lr_0 = 6.4602e-04
Loss = 2.1903e-01, PNorm = 84.4709, GNorm = 0.6854, lr_0 = 6.5318e-04
Loss = 2.8956e-01, PNorm = 84.5188, GNorm = 0.4416, lr_0 = 6.6035e-04
Loss = 1.9090e-01, PNorm = 84.5736, GNorm = 0.3962, lr_0 = 6.6752e-04
Loss = 2.7510e-01, PNorm = 84.6170, GNorm = 0.6160, lr_0 = 6.7468e-04
Loss = 2.6512e-01, PNorm = 84.6684, GNorm = 0.5264, lr_0 = 6.8185e-04
Loss = 2.5662e-01, PNorm = 84.7209, GNorm = 0.6272, lr_0 = 6.8901e-04
Loss = 2.4078e-01, PNorm = 84.7807, GNorm = 0.5457, lr_0 = 6.9618e-04
Loss = 2.6987e-01, PNorm = 84.8534, GNorm = 0.3607, lr_0 = 7.0334e-04
Loss = 3.0168e-01, PNorm = 84.9189, GNorm = 0.5172, lr_0 = 7.1051e-04
Loss = 3.0251e-01, PNorm = 84.9775, GNorm = 0.3630, lr_0 = 7.1768e-04
Loss = 3.0316e-01, PNorm = 85.0406, GNorm = 1.0906, lr_0 = 7.2484e-04
Loss = 2.1597e-01, PNorm = 85.1202, GNorm = 0.5740, lr_0 = 7.3201e-04
Loss = 2.5795e-01, PNorm = 85.1983, GNorm = 0.4913, lr_0 = 7.3917e-04
Loss = 2.6645e-01, PNorm = 85.2717, GNorm = 1.4385, lr_0 = 7.4634e-04
Loss = 3.0723e-01, PNorm = 85.3317, GNorm = 0.6094, lr_0 = 7.5350e-04
Loss = 3.1131e-01, PNorm = 85.3900, GNorm = 0.4926, lr_0 = 7.6067e-04
Loss = 2.5878e-01, PNorm = 85.4486, GNorm = 0.5443, lr_0 = 7.6783e-04
Loss = 3.0004e-01, PNorm = 85.5021, GNorm = 0.9308, lr_0 = 7.7500e-04
Loss = 2.7400e-01, PNorm = 85.5624, GNorm = 0.5912, lr_0 = 7.8217e-04
Loss = 2.7068e-01, PNorm = 85.6407, GNorm = 0.4002, lr_0 = 7.8933e-04
Loss = 2.5556e-01, PNorm = 85.7064, GNorm = 0.6156, lr_0 = 7.9650e-04
Loss = 2.3898e-01, PNorm = 85.7759, GNorm = 0.7123, lr_0 = 8.0366e-04
Loss = 2.9256e-01, PNorm = 85.8659, GNorm = 0.3740, lr_0 = 8.1083e-04
Loss = 2.4258e-01, PNorm = 85.9642, GNorm = 0.7518, lr_0 = 8.1799e-04
Loss = 2.5400e-01, PNorm = 86.0734, GNorm = 0.3696, lr_0 = 8.2516e-04
Loss = 2.7169e-01, PNorm = 86.1574, GNorm = 0.9089, lr_0 = 8.3232e-04
Loss = 2.3871e-01, PNorm = 86.2381, GNorm = 0.4652, lr_0 = 8.3949e-04
Loss = 2.1879e-01, PNorm = 86.3168, GNorm = 0.4437, lr_0 = 8.4666e-04
Loss = 2.8416e-01, PNorm = 86.3856, GNorm = 0.8542, lr_0 = 8.5382e-04
Loss = 3.0302e-01, PNorm = 86.4793, GNorm = 0.6432, lr_0 = 8.6099e-04
Loss = 2.3870e-01, PNorm = 86.5737, GNorm = 0.4332, lr_0 = 8.6815e-04
Loss = 2.6082e-01, PNorm = 86.6614, GNorm = 0.9073, lr_0 = 8.7532e-04
Loss = 2.7817e-01, PNorm = 86.7254, GNorm = 0.4613, lr_0 = 8.8248e-04
Loss = 3.0438e-01, PNorm = 86.8488, GNorm = 0.5695, lr_0 = 8.8965e-04
Loss = 2.4711e-01, PNorm = 86.9446, GNorm = 0.4182, lr_0 = 8.9682e-04
Loss = 2.7091e-01, PNorm = 87.0490, GNorm = 0.3519, lr_0 = 9.0398e-04
Loss = 2.5311e-01, PNorm = 87.1455, GNorm = 0.6655, lr_0 = 9.1115e-04
Loss = 2.4616e-01, PNorm = 87.2467, GNorm = 0.5378, lr_0 = 9.1831e-04
Loss = 2.1435e-01, PNorm = 87.3420, GNorm = 0.4617, lr_0 = 9.2548e-04
Loss = 2.7927e-01, PNorm = 87.4366, GNorm = 1.0668, lr_0 = 9.3264e-04
Loss = 2.2502e-01, PNorm = 87.5470, GNorm = 0.4981, lr_0 = 9.3981e-04
Loss = 2.5115e-01, PNorm = 87.6409, GNorm = 0.3638, lr_0 = 9.4697e-04
Loss = 2.4993e-01, PNorm = 87.7198, GNorm = 0.4002, lr_0 = 9.5414e-04
Loss = 2.1714e-01, PNorm = 87.8240, GNorm = 0.6832, lr_0 = 9.6131e-04
Loss = 2.1756e-01, PNorm = 87.8918, GNorm = 0.3143, lr_0 = 9.6847e-04
Loss = 2.4513e-01, PNorm = 87.9717, GNorm = 0.6026, lr_0 = 9.7564e-04
Loss = 2.4351e-01, PNorm = 88.0633, GNorm = 0.8704, lr_0 = 9.8280e-04
Loss = 2.6108e-01, PNorm = 88.1637, GNorm = 0.4859, lr_0 = 9.8997e-04
Loss = 2.6427e-01, PNorm = 88.2779, GNorm = 0.3664, lr_0 = 9.9713e-04
Validation auc = 0.790294
Epoch 2
Loss = 4.0569e-01, PNorm = 88.3776, GNorm = 1.1607, lr_0 = 9.9921e-04
Loss = 2.4694e-01, PNorm = 88.4987, GNorm = 0.2708, lr_0 = 9.9791e-04
Loss = 2.7786e-01, PNorm = 88.5601, GNorm = 0.4500, lr_0 = 9.9660e-04
Loss = 2.8855e-01, PNorm = 88.6384, GNorm = 0.4955, lr_0 = 9.9530e-04
Loss = 2.8648e-01, PNorm = 88.7103, GNorm = 0.4745, lr_0 = 9.9399e-04

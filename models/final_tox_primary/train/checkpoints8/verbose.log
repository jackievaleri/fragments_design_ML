Command line
python /home/felixjwong/miniconda3/envs/chemprop/bin/chemprop_train --data_path final_tox_primary/primary_tox_full.csv --dataset_type classification --config_path final_tox_primary/opt.json --save_dir final_tox_primary/train/checkpoints8 --ensemble_size 1 --features_generator rdkit_2d_normalized --no_features_scaling --seed 8
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': 'final_tox_primary/opt.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'final_tox_primary/primary_tox_full.csv',
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'ensemble_size': 1,
 'epochs': 30,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'final_tox_primary/train/checkpoints8',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 8,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['\ufeffSMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['TOXICITY'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 8
Class sizes
TOXICITY 0: 91.50%, 1: 8.50%
Total size = 39,312 | train size = 31,449 | val size = 3,931 | test size = 3,932
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.35, inplace=False)
    (4): Linear(in_features=1600, out_features=1600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.35, inplace=False)
    (7): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 11,014,401
Epoch 0
Loss = 3.8368e-01, PNorm = 82.6349, GNorm = 0.9621, lr_0 = 1.0788e-04
Loss = 3.2703e-01, PNorm = 82.6428, GNorm = 1.1360, lr_0 = 1.1505e-04
Loss = 3.0540e-01, PNorm = 82.6499, GNorm = 0.8853, lr_0 = 1.2221e-04
Loss = 2.9091e-01, PNorm = 82.6562, GNorm = 0.7499, lr_0 = 1.2938e-04
Loss = 2.6335e-01, PNorm = 82.6631, GNorm = 0.9682, lr_0 = 1.3654e-04
Loss = 2.8663e-01, PNorm = 82.6687, GNorm = 0.7661, lr_0 = 1.4371e-04
Loss = 2.8517e-01, PNorm = 82.6756, GNorm = 0.9631, lr_0 = 1.5088e-04
Loss = 2.7523e-01, PNorm = 82.6836, GNorm = 0.8208, lr_0 = 1.5804e-04
Loss = 2.7984e-01, PNorm = 82.6912, GNorm = 1.1411, lr_0 = 1.6521e-04
Loss = 3.0909e-01, PNorm = 82.7002, GNorm = 0.8879, lr_0 = 1.7237e-04
Loss = 2.6231e-01, PNorm = 82.7094, GNorm = 0.8322, lr_0 = 1.7954e-04
Loss = 2.8218e-01, PNorm = 82.7211, GNorm = 1.1740, lr_0 = 1.8670e-04
Loss = 2.7866e-01, PNorm = 82.7329, GNorm = 0.6775, lr_0 = 1.9387e-04
Loss = 3.1211e-01, PNorm = 82.7405, GNorm = 0.8437, lr_0 = 2.0104e-04
Loss = 2.5547e-01, PNorm = 82.7523, GNorm = 0.5990, lr_0 = 2.0820e-04
Loss = 2.3353e-01, PNorm = 82.7601, GNorm = 0.7832, lr_0 = 2.1537e-04
Loss = 2.5494e-01, PNorm = 82.7697, GNorm = 0.9958, lr_0 = 2.2253e-04
Loss = 2.8239e-01, PNorm = 82.7791, GNorm = 0.8268, lr_0 = 2.2970e-04
Loss = 2.6267e-01, PNorm = 82.7912, GNorm = 0.6673, lr_0 = 2.3686e-04
Loss = 2.9061e-01, PNorm = 82.8006, GNorm = 0.9668, lr_0 = 2.4403e-04
Loss = 3.0516e-01, PNorm = 82.8143, GNorm = 0.6518, lr_0 = 2.5119e-04
Loss = 2.4358e-01, PNorm = 82.8274, GNorm = 0.7720, lr_0 = 2.5836e-04
Loss = 2.4986e-01, PNorm = 82.8423, GNorm = 0.7281, lr_0 = 2.6553e-04
Loss = 2.8323e-01, PNorm = 82.8565, GNorm = 1.3634, lr_0 = 2.7269e-04
Loss = 2.9160e-01, PNorm = 82.8725, GNorm = 1.0645, lr_0 = 2.7986e-04
Loss = 2.6308e-01, PNorm = 82.8895, GNorm = 0.6357, lr_0 = 2.8702e-04
Loss = 2.6971e-01, PNorm = 82.9085, GNorm = 0.5541, lr_0 = 2.9419e-04
Loss = 2.6296e-01, PNorm = 82.9236, GNorm = 0.6877, lr_0 = 3.0135e-04
Loss = 2.4921e-01, PNorm = 82.9407, GNorm = 0.5528, lr_0 = 3.0852e-04
Loss = 2.6253e-01, PNorm = 82.9584, GNorm = 0.6494, lr_0 = 3.1568e-04
Loss = 2.9566e-01, PNorm = 82.9766, GNorm = 0.6815, lr_0 = 3.2285e-04
Loss = 2.5961e-01, PNorm = 82.9981, GNorm = 0.5890, lr_0 = 3.3002e-04
Loss = 2.6547e-01, PNorm = 83.0192, GNorm = 0.8916, lr_0 = 3.3718e-04
Loss = 3.0992e-01, PNorm = 83.0420, GNorm = 0.6935, lr_0 = 3.4435e-04
Loss = 2.5430e-01, PNorm = 83.0679, GNorm = 0.7182, lr_0 = 3.5151e-04
Loss = 2.7892e-01, PNorm = 83.0909, GNorm = 0.8782, lr_0 = 3.5868e-04
Loss = 2.3194e-01, PNorm = 83.1155, GNorm = 0.7125, lr_0 = 3.6584e-04
Loss = 2.9343e-01, PNorm = 83.1362, GNorm = 0.8059, lr_0 = 3.7301e-04
Loss = 2.6579e-01, PNorm = 83.1556, GNorm = 0.5815, lr_0 = 3.8018e-04
Loss = 2.5349e-01, PNorm = 83.1764, GNorm = 0.9766, lr_0 = 3.8734e-04
Loss = 2.4800e-01, PNorm = 83.1946, GNorm = 0.6597, lr_0 = 3.9451e-04
Loss = 2.4970e-01, PNorm = 83.2166, GNorm = 0.5409, lr_0 = 4.0167e-04
Loss = 2.6670e-01, PNorm = 83.2396, GNorm = 1.0027, lr_0 = 4.0884e-04
Loss = 2.3830e-01, PNorm = 83.2632, GNorm = 0.5449, lr_0 = 4.1600e-04
Loss = 2.6323e-01, PNorm = 83.2840, GNorm = 0.6164, lr_0 = 4.2317e-04
Loss = 2.4038e-01, PNorm = 83.3075, GNorm = 0.5930, lr_0 = 4.3033e-04
Loss = 2.7553e-01, PNorm = 83.3303, GNorm = 0.8735, lr_0 = 4.3750e-04
Loss = 2.7573e-01, PNorm = 83.3559, GNorm = 0.8470, lr_0 = 4.4467e-04
Loss = 2.6845e-01, PNorm = 83.3736, GNorm = 0.7416, lr_0 = 4.5183e-04
Loss = 2.5249e-01, PNorm = 83.4005, GNorm = 0.4005, lr_0 = 4.5900e-04
Loss = 3.0003e-01, PNorm = 83.4266, GNorm = 0.8374, lr_0 = 4.6616e-04
Loss = 2.5484e-01, PNorm = 83.4517, GNorm = 0.5728, lr_0 = 4.7333e-04
Loss = 3.1856e-01, PNorm = 83.4801, GNorm = 0.5376, lr_0 = 4.8049e-04
Loss = 3.0301e-01, PNorm = 83.5057, GNorm = 0.8544, lr_0 = 4.8766e-04
Loss = 2.6975e-01, PNorm = 83.5414, GNorm = 0.9235, lr_0 = 4.9482e-04
Loss = 3.2970e-01, PNorm = 83.5648, GNorm = 0.6113, lr_0 = 5.0199e-04
Loss = 2.7139e-01, PNorm = 83.5873, GNorm = 0.6980, lr_0 = 5.0916e-04
Loss = 2.6610e-01, PNorm = 83.6177, GNorm = 1.1014, lr_0 = 5.1632e-04
Loss = 2.6461e-01, PNorm = 83.6411, GNorm = 0.5257, lr_0 = 5.2349e-04
Loss = 2.6215e-01, PNorm = 83.6671, GNorm = 0.5334, lr_0 = 5.3065e-04
Loss = 2.5880e-01, PNorm = 83.6977, GNorm = 0.5419, lr_0 = 5.3782e-04
Loss = 3.0200e-01, PNorm = 83.7234, GNorm = 0.4652, lr_0 = 5.4498e-04
Validation auc = 0.777897
Epoch 1
Loss = 1.9614e-01, PNorm = 83.7572, GNorm = 0.4439, lr_0 = 5.5287e-04
Loss = 2.8773e-01, PNorm = 83.7853, GNorm = 0.5517, lr_0 = 5.6003e-04
Loss = 2.5797e-01, PNorm = 83.8282, GNorm = 0.3757, lr_0 = 5.6720e-04
Loss = 2.3837e-01, PNorm = 83.8517, GNorm = 0.6750, lr_0 = 5.7436e-04
Loss = 2.9350e-01, PNorm = 83.8804, GNorm = 0.6751, lr_0 = 5.8153e-04
Loss = 2.2071e-01, PNorm = 83.9077, GNorm = 0.5694, lr_0 = 5.8869e-04
Loss = 2.5380e-01, PNorm = 83.9297, GNorm = 0.5825, lr_0 = 5.9586e-04
Loss = 2.9850e-01, PNorm = 83.9563, GNorm = 0.9843, lr_0 = 6.0303e-04
Loss = 2.6999e-01, PNorm = 83.9974, GNorm = 0.3790, lr_0 = 6.1019e-04
Loss = 2.5254e-01, PNorm = 84.0273, GNorm = 0.5174, lr_0 = 6.1736e-04
Loss = 2.5695e-01, PNorm = 84.0695, GNorm = 0.8477, lr_0 = 6.2452e-04
Loss = 3.0561e-01, PNorm = 84.1060, GNorm = 0.5281, lr_0 = 6.3169e-04
Loss = 2.5830e-01, PNorm = 84.1572, GNorm = 0.3894, lr_0 = 6.3885e-04
Loss = 2.6750e-01, PNorm = 84.2190, GNorm = 0.3950, lr_0 = 6.4602e-04
Loss = 2.7286e-01, PNorm = 84.2798, GNorm = 0.4350, lr_0 = 6.5318e-04
Loss = 2.3826e-01, PNorm = 84.3422, GNorm = 0.4219, lr_0 = 6.6035e-04
Loss = 2.5008e-01, PNorm = 84.4114, GNorm = 0.5504, lr_0 = 6.6752e-04
Loss = 2.5094e-01, PNorm = 84.4985, GNorm = 0.5830, lr_0 = 6.7468e-04
Loss = 2.7970e-01, PNorm = 84.5945, GNorm = 0.4068, lr_0 = 6.8185e-04
